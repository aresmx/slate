
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">

    <!-- Always force latest IE rendering engine or request Chrome Frame -->
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">

    <!-- Use title if it's in the page YAML frontmatter -->
    <title>API Reference</title>

    <link href="stylesheets/screen.css" media="screen" rel="stylesheet" type="text/css" />
    <link href="stylesheets/print.css" media="print" rel="stylesheet" type="text/css" />
    <script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>
    <script src="javascripts/all.js" type="text/javascript"></script>
    
    <script>
      $(function() {
        var toc = $("#toc").tocify({
          selectors: "h1,h2",
          extendPage: false,
          theme: "none",
          smoothScroll: false,
          showEffectSpeed: 0,
          hideEffectSpeed: 180,
          ignoreSelector: ".toc-ignore",
          hashGenerator: 'pretty',
          highlightOffset: 60,
          scrollTo: -2,
          scrollHistory: true,
          hashGenerator: function(text, element) {
            return element[0].getAttribute('id');
          }
        }).data("toc-tocify");
        // Hack to make already open sections to start opened,
        // instead of displaying an ugly animation
        setTimeout(function() {
          toc.setOption("showEffectSpeed", 180);
        },50);
        setupLanguages([
          
            
              
                'shell',
              
            
              
                'php',
              
            
              
                'java',
              
            
              
                'csharp',
              
            
              
                'javascript',
              
            
              
                'ruby',
              
            
          
        ]);
      });
    </script>
  </head>

  <body class="index_EN">
    <div class="tocify-wrapper">
      <img src="http://www.openpay.mx/img/logo.png" />
      <div id="toc">
      </div>
      
      <ul class="toc-footer">
        
          <li><a href='#'>Sign Up for a Developer Key</a></li>
        
          <li><a href='http://github.com/tripit/slate'>Documentation Powered by Slate</a></li>
        
      </ul>
      
    </div>
    <div class="page-wrapper">
      <div class="content">
        <h1 id="introduction">Introduction</h1>

<p>The Openpay API is designed on <a href="http://es.wikipedia.org/wiki/Representational_State_Transfer">REST</a>,  therefore you&rsquo;ll find that URLs are oriented to resources and that HTTP response codes are used to indicate errors in the API.</p>

<p>All the API responses are in <a href="http://www.json.org/">JSON</a> format, including the errors.</p>

<h1 id="api-endpoints">API Endpoints</h1>

<blockquote>
<p>Available resourcers</p>
</blockquote>

<p><br/>
<br/></p>

<blockquote>
<p>a) By Merchant</p>
</blockquote>
<pre class="highlight plaintext">/v1/{MERCHANT_ID}/...

/fees
/fees/{FEE_ID}
/charges
/charges/{TRANSACTION_ID}
/payouts
/payouts/{TRANSACTION_ID}
/cards
/cards/{CARD_ID}
/customers
/customers/{CUSTOMER_ID}
/plans
/plans/{PLAN_ID}
â€‹/tokens
/tokens/{TOKEN_ID}
</pre>
<blockquote>
<p>b) By Customer</p>
</blockquote>
<pre class="highlight plaintext">/v1/{MERCHANT_ID}/customers/{CUSTOMER_ID}/...

/cards
/cards/{CARD_ID}
/bankaccounts
/bankaccounts/{BANKACCOUNT_ID}
/charges
/charges/{TRANSACTION_ID}
/payouts
/payouts/{TRANSACTION_ID}
/transfers
/transfers/{TRANSACTION_ID}
/subscriptions
/subscriptions/{SUBSCRIPTION_ID}
</pre>
<p>The Openpay REST API has a test environment (sandbox) and a production environment. For integrating your system with Openpay, use the credentials that were generated when you signed up. Once you are ready to move to production environment and your request is approved, new credentials will be generated for accessing the production environment.</p>

<p>The following URIs are the basis of the endpoints for the supported environments:</p>

<ul>
<li><strong>Test</strong>, URI base: <br/> <code class="prettyprint">https://sandbox-api.openpay.mx</code><br/><br/></li>
<li><strong>Production</strong>, URI base: <br/><code class="prettyprint">https://api.openpay.mx</code><br/></li>
</ul>

<p>A complete endpoint consists of the base URI of the environment, the identifier of the Merchant and the resource.</p>

<p>For example, if we want to create a new customer, the endpoint would be::</p>

<p><code>POST https://sandbox-api.openpay.mx/v1/mzdtln0bmtms6o3kck8f/customers</code></p>

<p>In order to create a complete request is necessary to send the right HTTP headers and the information in JSON format.</p>

<p><aside class="notice">
 All the examples of this documentation are based on the testing environment.
</aside></p>

<h1 id="authentication">Authentication</h1>

<blockquote>
<p>Authentication example</p>
</blockquote>
<pre class="highlight shell">curl https://sandbox-api.openpay.mx/v1/mzdtln0bmtms6o3kck8f/charges <span class="se">\</span>
   -u sk_e568c42a6c384b7ab02cd47d2e407cab:

The -u parameter is responsible <span class="k">for </span>the HTTP basic authentication <span class="o">(</span>adding two points after the private key prevents the use of password<span class="o">)</span>
</pre><pre class="highlight php"><span class="cp">&lt;?</span> 
<span class="c1">//Sandbox is used by default 
</span><span class="nv">$openpay</span> <span class="o">=</span> <span class="nx">Openpay</span><span class="o">::</span><span class="na">getInstance</span><span class="p">(</span><span class="s1">'moiep6umtcnanql3jrxp'</span><span class="p">,</span> <span class="s1">'sk_3433941e467c4875b178ce26348b0fac'</span><span class="p">);</span> 
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="c1">//Sandbox</span>
<span class="kd">final</span> <span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OpenpayAPI</span><span class="o">(</span><span class="s">"https://sandbox-api.openpay.mx"</span><span class="o">,</span> <span class="s">"moiep6umtcnanql3jrxp"</span><span class="o">,</span> <span class="s">"sk_3433941e467c4875b178ce26348b0fac"</span><span class="o">);</span>

<span class="c1">//Production</span>
<span class="kd">final</span> <span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OpenpayAPI</span><span class="o">(</span><span class="s">"https://api.openpay.mx"</span><span class="o">,</span> <span class="s">"moiep6umtcnanql3jrxp"</span><span class="o">,</span> <span class="s">"sk_3433941e467c4875b178ce26348b0fac"</span><span class="o">);</span>
</pre><pre class="highlight javascript"><span class="kd">var</span> <span class="nx">Openpay</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'openpay'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">openpay</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Openpay</span><span class="p">(</span><span class="s1">'moiep6umtcnanql3jrxp'</span><span class="p">,</span><span class="s1">'sk_3433941e467c4875b178ce26348b0fac'</span><span class="p">);</span>
</pre><pre class="highlight csharp"><span class="c1">//Sandbox
</span><span class="n">OpenpayAPI</span> <span class="n">openpayAPI</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">OpenpayAPI</span><span class="p">(</span><span class="s">"sk_3433941e467c4875b178ce26348b0fac"</span><span class="p">,</span> <span class="s">"moiep6umtcnanql3jrxp"</span><span class="p">);</span>
<span class="n">openpayAPI</span><span class="p">.</span><span class="n">Production</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span> <span class="c1">// Default value = false
</span>
<span class="c1">//Produtcion
</span><span class="n">OpenpayAPI</span> <span class="n">openpayAPI</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">OpenpayAPI</span><span class="p">(</span><span class="s">"sk_3433941e467c4875b178ce26348b0fac"</span><span class="p">,</span> <span class="s">"moiep6umtcnanql3jrxp"</span><span class="p">);</span>
<span class="n">openpayAPI</span><span class="p">.</span><span class="n">Production</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
</pre><pre class="highlight ruby"><span class="c1">#Sandbox</span>
<span class="n">openpay</span><span class="o">=</span><span class="no">OpenpayApi</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"moiep6umtcnanql3jrxp"</span><span class="p">,</span><span class="s2">"sk_3433941e467c4875b178ce26348b0fac"</span><span class="p">)</span>

<span class="c1">#Production</span>
<span class="n">openpay</span><span class="o">=</span><span class="no">OpenpayApi</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"moiep6umtcnanql3jrxp"</span><span class="p">,</span><span class="s2">"sk_3433941e467c4875b178ce26348b0fac"</span><span class="p">,</span> <span class="kp">true</span><span class="p">)</span>


<span class="c1">#Define the timeout for the requests</span>
<span class="c1">#This cllient uses a default 90 secs timeout. In order to configure the timeout used to create request to the openpay services, you need to clearly define the kind of environment, followed by the new timeout value for the request:</span>

<span class="c1">#Syntax:</span>
<span class="c1">#   openpay_prod=OpenpayApi.new(merchant_id,private_key,isProduction,timeout)</span>
<span class="c1">#Example:</span>
<span class="c1">#   openpay_prod=OpenpayApi.new(merchant_id,private_key,false,30)</span>
</pre>
<blockquote>
<p>Production </p>
</blockquote>
<pre class="highlight shell">You only need to use the URI base https://api.openpay.mx
</pre><pre class="highlight php"><span class="cp">&lt;?</span> 
<span class="nx">Openpay</span><span class="o">::</span><span class="na">setProductionMode</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span> 
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="c1">//You only need to use the URI base https://api.openpay.mx</span>
</pre><pre class="highlight csharp"><span class="n">openpayAPI</span><span class="p">.</span><span class="n">Production</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
</pre><pre class="highlight javascript"><span class="nx">openpay</span><span class="p">.</span><span class="nx">setProductionReady</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
</pre><pre class="highlight ruby"><span class="c1">#You only need to pass a "true" value as the third argument when creating the OpenpayApi object. </span>
</pre>
<p>To make requests to the Openpay API, is necessary to send the API Key on all your calls to our servers. You can get the key from the <a href="https://sandbox-dashboard.openpay.mx">dashboard</a>.</p>

<p>There are 2 types of API keys:</p>

<ul>
<li><strong>Private.-</strong> 
For calls between servers and full access to all API operations (should never be shared).</li>
</ul>

<p><aside class="warning">
Keep this key safe and never share it to anyone.
</aside></p>

<ul>
<li><strong>Public.-</strong>
should only be used in JavaScript calls. This key is only allowed to create cards or create tokens.</li>
</ul>

<p><aside class="notice">
To make calls with your public key use the [Openpay.js] library(#)
</aside></p>

<p>For API authentication you must use the [basic access authentication]http://es.wikipedia.org/wiki/AutenticaciÃ³n_de_acceso_bÃ¡sica), where the API key is the username. The password is not required and it should be left blank for purposes of simplicity</p>

<p><aside class="notice">
For security reasons, all requests must be through <strong>HTTPS</strong>.
</aside></p>

<h1 id="errors">Errors</h1>

<p>Openpay returns JSON objects in the service responses. </p>

<h2 id="error-object">Error Object</h2>

<blockquote>
<p>Object example </p>
</blockquote>
<pre class="highlight json"><span class="p">{</span><span class="w">
    </span><span class="s2">"category"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"request"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"description"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"The customer with id 'm4hqp35pswl02mmc567' does not exist"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"http_code"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">404</span><span class="p">,</span><span class="w">
    </span><span class="s2">"error_code"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1005</span><span class="p">,</span><span class="w">
    </span><span class="s2">"request_id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"1981cdb8-19cb-4bad-8256-e95d58bc035c"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"fraud_rules"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"Billing &lt;&gt; BIN Country for VISA/MC"</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre><pre class="highlight java"><span class="c1">//For Java every operation will return an instance of the "OpenpayServiceException" class which will have the error information. ```</span>

<span class="err">```</span><span class="n">csharp</span>
<span class="c1">//For C Sharp,  every operation will return an instance of the "OpenpayException" class which will have the error information.</span>
</pre><pre class="highlight ruby"><span class="c1">#For Ruby, every operation can return any of the following exceptions:</span>

<span class="c1"># =&gt; OpenpayException: For generic errors, like invalid resources, etc.</span>
<span class="c1"># =&gt; OpenpayConnectionException: For errors related with server connection problems.</span>
<span class="c1"># =&gt; OpenpayTransactionException: For errors during operations implementation.</span>
</pre>
<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>category</td>
<td><strong><em>string</em></strong> <br/><strong>request:</strong>  Indicates an error caused by data sent by the customer. For example, an invalid request, an attempt at a transaction without funds or a transfer to an account that does not exist. <br/><br/><strong>internal:</strong> Indicates an error on Openpay side, and will occur very rarely. <br/><br/><strong>gateway:</strong> Indicates an error during the transaction of funds from one card to the Openpay account or from the account to a bank or card.</td>
</tr>
<tr>
<td>error_code</td>
<td><strong><em>numeric</em></strong> <br/>Openpay numeric error code indicating a problem happened.</td>
</tr>
<tr>
<td>description</td>
<td><strong><em>string</em></strong> <br/>Error description.</td>
</tr>
<tr>
<td>http_code</td>
<td><strong><em>string</em></strong> <br/>HTTP error code  of the response.</td>
</tr>
<tr>
<td>request_id</td>
<td><strong><em>string</em></strong> <br/> Request identifier.</td>
</tr>
<tr>
<td>fraud_rules</td>
<td><strong><em>array</em></strong> <br/> Array with antifraud rules broken according to fraud detection rules.</td>
</tr>
</tbody></table>

<h2 id="error-codes">Error codes</h2>

<h3 id="general">General</h3>

<table><thead>
<tr>
<th>Code</th>
<th>HTTP Error</th>
<th>Cause</th>
</tr>
</thead><tbody>
<tr>
<td>1000</td>
<td>500 Internal Server Error</td>
<td>An internal error occurred on the Openpay server</td>
</tr>
<tr>
<td>1001</td>
<td>400 Bad Request</td>
<td>The format of the request is not JSON, the fields do not have the correct format, or the request does not have fields that are required.</td>
</tr>
<tr>
<td>1002</td>
<td>401 Unauthorized</td>
<td>The call is not authenticated or the authentication is incorrect.</td>
</tr>
<tr>
<td>1003</td>
<td>422 Unprocessable Entity</td>
<td>The operation could not be completed because the value of one or more of the parameters is incorrect.</td>
</tr>
<tr>
<td>1004</td>
<td>503 Service Unavailable</td>
<td>A necessary for processing the transaction service is unavailable.</td>
</tr>
<tr>
<td>1005</td>
<td>404 Not Found</td>
<td>One of the resources requested does not exist.</td>
</tr>
<tr>
<td>1006</td>
<td>409 Conflict</td>
<td>A transaction with the same order ID already exists.</td>
</tr>
<tr>
<td>1007</td>
<td>402 Payment Required</td>
<td>The transfer of funds from a bank account or card to the Openpay account was not accepted.</td>
</tr>
<tr>
<td>1008</td>
<td>423 Locked</td>
<td>One of the accounts required in the request is deactivated.</td>
</tr>
<tr>
<td>1009</td>
<td>413 Request Entity too large</td>
<td>The request body is too large.</td>
</tr>
<tr>
<td>1010</td>
<td>403 Forbidden</td>
<td>The public key is used to make a call but it requires the private key, or it â€˜s using the private key from JavaScript.</td>
</tr>
</tbody></table>

<h3 id="storage">Storage</h3>

<table><thead>
<tr>
<th>Code</th>
<th>HTTP Error</th>
<th>Cause</th>
</tr>
</thead><tbody>
<tr>
<td>2001</td>
<td>409 Conflict</td>
<td>The bank account with this CLABE is already registered on the customer.</td>
</tr>
<tr>
<td>2002</td>
<td>409 Conflict</td>
<td>The card with this number is already registered on the customer.</td>
</tr>
<tr>
<td>2003</td>
<td>409 Conflict</td>
<td>Customer with this external identifier (External ID) already exists.</td>
</tr>
<tr>
<td>2004</td>
<td>422 Unprocessable Entity</td>
<td>The check digit card number is invalid according to the Luhn algorithm.</td>
</tr>
<tr>
<td>2005</td>
<td>400 Bad Request</td>
<td>The expiration date of the card is prior to the current date.</td>
</tr>
<tr>
<td>2006</td>
<td>400 Bad Request</td>
<td>Security code card (CVV2) was not provided.</td>
</tr>
<tr>
<td>2007</td>
<td>412 Precondition Failed</td>
<td>The card number is a test number and can only be used in Sandbox.</td>
</tr>
</tbody></table>

<h3 id="cards">Cards</h3>

<table><thead>
<tr>
<th>Code</th>
<th>HTTP Error</th>
<th>Cause</th>
</tr>
</thead><tbody>
<tr>
<td>3001</td>
<td>402 percent Required</td>
<td>The card was declined.</td>
</tr>
<tr>
<td>3002</td>
<td>402 Payment Required</td>
<td>The card has expired.</td>
</tr>
<tr>
<td>3003</td>
<td>402 Payment Required</td>
<td>The card has insufficient funds.</td>
</tr>
<tr>
<td>3004</td>
<td>402 Payment Required</td>
<td>The card has been identified as a stolen card.</td>
</tr>
<tr>
<td>3005</td>
<td>402 Payment Required</td>
<td>The card has been identified as a fraudulent card.</td>
</tr>
<tr>
<td>3006</td>
<td>412 Precondition Failed</td>
<td>The operation is not allowed for this customer or this transaction.</td>
</tr>
<tr>
<td>3008</td>
<td>412 Precondition Failed</td>
<td>The card is not supported in online transactions.</td>
</tr>
<tr>
<td>3009</td>
<td>402 Payment Required</td>
<td>The card was reported missing.</td>
</tr>
<tr>
<td>3010</td>
<td>402 Payment Required</td>
<td>The bank has restricted the card.</td>
</tr>
<tr>
<td>3011</td>
<td>402 Payment Required</td>
<td>The bank has requested that the card is retained. Contact the bank.</td>
</tr>
<tr>
<td>3012</td>
<td>412 Precondition Failed</td>
<td>A bank authorization is required to make this payment.</td>
</tr>
</tbody></table>

<h3 id="accounts">Accounts</h3>

<table><thead>
<tr>
<th>Code</th>
<th>HTTP Error</th>
<th>Cause</th>
</tr>
</thead><tbody>
<tr>
<td>4001</td>
<td>412 Preconditon Failed</td>
<td>The Openpay account has not enough funds.</td>
</tr>
</tbody></table>

<h1 id="charges">Charges</h1>

<p>Charges can be made to cards, stores and banks. Each charge is assigned with an unique identifier in the system.</p>

<p>You can do card charges by using a saved card id, using a token or you can send the card information at the time of invocation.</p>

<h2 id="with-a-card-id-or-token">With a card id or token</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell">Merchant
POST https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/charges

Customer
POST https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/customers/<span class="o">{</span>CUSTOMER_ID<span class="o">}</span>/charges
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nx">Merchant</span>
<span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">charges</span><span class="o">-&gt;</span><span class="na">create</span><span class="p">(</span><span class="nx">chargeRequest</span><span class="p">);</span>

<span class="nx">Customer</span>
<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nv">$customerId</span><span class="p">);</span>
<span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">charges</span><span class="o">-&gt;</span><span class="na">create</span><span class="p">(</span><span class="nx">chargeRequest</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="c1">//Customer</span>
<span class="n">openpayAPI</span><span class="o">.</span><span class="na">charges</span><span class="o">().</span><span class="na">create</span><span class="o">(</span><span class="n">String</span> <span class="n">customerId</span><span class="o">,</span> <span class="n">CreateCardChargeParams</span> <span class="n">request</span><span class="o">);</span>

<span class="c1">//Merchant</span>
<span class="n">openpayAPI</span><span class="o">.</span><span class="na">charges</span><span class="o">().</span><span class="na">create</span><span class="o">(</span><span class="n">CreateCardChargeParams</span> <span class="n">request</span><span class="o">);</span>
</pre><pre class="highlight javascript"><span class="c1">// Merchant
</span><span class="nx">openpay</span><span class="p">.</span><span class="nx">charges</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">chargeRequest</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>

<span class="c1">// Customer
</span><span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">charges</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">customerId</span><span class="p">,</span> <span class="nx">chargeRequest</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
</pre><pre class="highlight csharp"><span class="c1">//Customer
</span><span class="n">openpayAPI</span><span class="p">.</span><span class="n">ChargeService</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="kt">string</span> <span class="n">customer_id</span><span class="p">,</span> <span class="n">ChargeRequest</span> <span class="n">request</span><span class="p">);</span>

<span class="c1">//Merchant
</span><span class="n">openpayAPI</span><span class="p">.</span><span class="n">ChargeService</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="n">ChargeRequest</span> <span class="n">request</span><span class="p">);</span>
</pre><pre class="highlight ruby"><span class="c1">#Customer</span>
<span class="vi">@charges</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:charges</span><span class="p">)</span>
<span class="vi">@charges</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="n">request_hash</span><span class="p">,</span> <span class="n">customer_id</span><span class="p">)</span>

<span class="c1">#Merchant</span>
<span class="vi">@charges</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:charges</span><span class="p">)</span>
<span class="vi">@charges</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="n">request_hash</span><span class="p">)</span>
</pre>
<blockquote>
<p>Merchant request example </p>
</blockquote>
<pre class="highlight shell">curl https://sandbox-api.openpay.mx/v1/mzdtln0bmtms6o3kck8f/charges <span class="se">\</span>
   -u sk_e568c42a6c384b7ab02cd47d2e407cab: <span class="se">\</span>
   -H <span class="s2">"Content-type: application/json"</span> <span class="se">\</span>
   -X POST -d <span class="s1">'{
   "source_id" : "kqgykn96i7bcs1wwhvgw",
   "method" : "card",
   "amount" : 100,
   "description" : "Cargo inicial a mi cuenta",
   "order_id" : "oid-00051",
   "device_session_id":"kR1MiQhz2otdIuUlQkbEyitIqVMiI16f",
   "customer" : {
        "name" : "Juan",
        "last_name" : "Vazquez Juarez",
        "phone_number" : "4423456723",
        "email" : "juan.vazquez@empresa.com.mx"
   }
}'</span> 
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$openpay</span> <span class="o">=</span> <span class="nx">Openpay</span><span class="o">::</span><span class="na">getInstance</span><span class="p">(</span><span class="s1">'mzdtln0bmtms6o3kck8f'</span><span class="p">,</span> <span class="s1">'sk_e568c42a6c384b7ab02cd47d2e407cab'</span><span class="p">);</span>
<span class="nv">$customer</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
     <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'Juan'</span><span class="p">,</span>
     <span class="s1">'last_name'</span> <span class="o">=&gt;</span> <span class="s1">'Vazquez Juarez'</span><span class="p">,</span>
     <span class="s1">'phone_number'</span> <span class="o">=&gt;</span> <span class="s1">'4423456723'</span><span class="p">,</span>
     <span class="s1">'email'</span> <span class="o">=&gt;</span> <span class="s1">'juan.vazquez@empresa.com.mx'</span><span class="p">);</span>

<span class="nv">$chargeRequest</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'method'</span> <span class="o">=&gt;</span> <span class="s1">'card'</span><span class="p">,</span>
    <span class="s1">'source_id'</span> <span class="o">=&gt;</span> <span class="s1">'kqgykn96i7bcs1wwhvgw'</span><span class="p">,</span>
    <span class="s1">'amount'</span> <span class="o">=&gt;</span> <span class="mi">100</span><span class="p">,</span>
    <span class="s1">'description'</span> <span class="o">=&gt;</span> <span class="s1">'Cargo inicial a mi merchant'</span><span class="p">,</span>
    <span class="s1">'order_id'</span> <span class="o">=&gt;</span> <span class="s1">'oid-00051'</span>
    <span class="s1">'device_session_id'</span> <span class="o">=&gt;</span> <span class="s1">'kR1MiQhz2otdIuUlQkbEyitIqVMiI16f'</span><span class="p">,</span>
    <span class="s1">'customer'</span> <span class="o">=&gt;</span> <span class="nv">$customer</span><span class="p">);</span>

<span class="nv">$charge</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">charges</span><span class="o">-&gt;</span><span class="na">create</span><span class="p">(</span><span class="nv">$chargeRequest</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OpenpayAPI</span><span class="o">(</span><span class="s">"https://sandbox-api.openpay.mx"</span><span class="o">,</span> <span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="o">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="o">);</span>
<span class="n">CreateCardChargeParams</span> <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CreateCardChargeParams</span><span class="o">();</span>
<span class="n">Customer</span> <span class="n">customer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Customer</span><span class="o">();</span>
<span class="n">customer</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="s">"Juan"</span><span class="o">);</span>
<span class="n">customer</span><span class="o">.</span><span class="na">setLastName</span><span class="o">(</span><span class="s">"Vazquez Juarez"</span><span class="o">);</span>
<span class="n">customer</span><span class="o">.</span><span class="na">setPhoneNumber</span><span class="o">(</span><span class="s">"4423456723"</span><span class="o">);</span>
<span class="n">customer</span><span class="o">.</span><span class="na">setEmail</span><span class="o">(</span><span class="s">"juan.vazquez@empresa.com.mx"</span><span class="o">);</span>

<span class="n">request</span><span class="o">.</span><span class="na">cardId</span><span class="o">(</span><span class="s">"kqgykn96i7bcs1wwhvgw"</span><span class="o">);</span> <span class="c1">// =source_id</span>
<span class="n">request</span><span class="o">.</span><span class="na">amount</span><span class="o">(</span><span class="k">new</span> <span class="n">BigDecimal</span><span class="o">(</span><span class="s">"100.00"</span><span class="o">));</span>
<span class="n">request</span><span class="o">.</span><span class="na">description</span><span class="o">(</span><span class="s">"Cargo inicial a mi merchant"</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">orderId</span><span class="o">(</span><span class="s">"oid-00051"</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">deviceSessionId</span><span class="o">(</span><span class="s">"kR1MiQhz2otdIuUlQkbEyitIqVMiI16f"</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">setCustomer</span><span class="o">(</span><span class="n">customer</span><span class="o">);</span>

<span class="n">Charge</span> <span class="kt">char</span><span class="n">ge</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="na">charges</span><span class="o">().</span><span class="na">create</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">OpenpayAPI</span><span class="p">(</span><span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="p">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="p">);</span>
<span class="n">Customer</span> <span class="n">customer</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Customer</span><span class="p">();</span>
<span class="n">customer</span><span class="p">.</span><span class="n">Name</span> <span class="p">=</span> <span class="s">"Juan"</span><span class="p">;</span>
<span class="n">customer</span><span class="p">.</span><span class="n">LastName</span> <span class="p">=</span> <span class="s">"Vazquez Juarez"</span><span class="p">;</span>
<span class="n">customer</span><span class="p">.</span><span class="n">PhoneNumber</span> <span class="p">=</span> <span class="s">"4423456723"</span><span class="p">;</span>
<span class="n">customer</span><span class="p">.</span><span class="n">Email</span> <span class="p">=</span> <span class="s">"juan.vazquez@empresa.com.mx"</span><span class="p">;</span>

<span class="n">ChargeRequest</span> <span class="n">request</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">ChargeRequest</span><span class="p">();</span>
<span class="n">request</span><span class="p">.</span><span class="n">Method</span> <span class="p">=</span> <span class="s">"card"</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">SourceId</span> <span class="p">=</span> <span class="s">"kwkoqpg6fcvfse8k8mg2"</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">Amount</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Decimal</span><span class="p">(</span><span class="m">100.00</span><span class="p">);</span>
<span class="n">request</span><span class="p">.</span><span class="n">Description</span> <span class="p">=</span> <span class="s">"Cargo inicial a mi merchant"</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">OrderId</span> <span class="p">=</span> <span class="s">"oid-00051"</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">DeviceSessionId</span> <span class="p">=</span> <span class="s">"kR1MiQhz2otdIuUlQkbEyitIqVMiI16f"</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">Customer</span> <span class="p">=</span> <span class="n">customer</span><span class="p">;</span>

<span class="n">Charge</span> <span class="n">charge</span> <span class="p">=</span> <span class="n">api</span><span class="p">.</span><span class="n">ChargeService</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="n">request</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="kd">var</span> <span class="nx">chargeRequest</span> <span class="o">=</span> <span class="p">{</span>
   <span class="s1">'source_id'</span> <span class="err">:</span> <span class="s1">'kqgykn96i7bcs1wwhvgw'</span><span class="p">,</span>
   <span class="s1">'method'</span> <span class="err">:</span> <span class="s1">'card'</span><span class="p">,</span>
   <span class="s1">'amount'</span> <span class="err">:</span> <span class="mi">100</span><span class="p">,</span>
   <span class="s1">'description'</span> <span class="err">:</span> <span class="s1">'Cargo inicial a mi cuenta'</span><span class="p">,</span>
   <span class="s1">'order_id'</span> <span class="err">:</span> <span class="s1">'oid-00051'</span><span class="p">,</span>
   <span class="s1">'device_session_id'</span> <span class="err">:</span> <span class="s1">'kR1MiQhz2otdIuUlQkbEyitIqVMiI16f'</span><span class="p">,</span>
   <span class="s1">'customer'</span> <span class="err">:</span> <span class="p">{</span>
        <span class="s1">'name'</span> <span class="err">:</span> <span class="s1">'Juan'</span><span class="p">,</span>
        <span class="s1">'last_name'</span> <span class="err">:</span> <span class="s1">'Vazquez Juarez'</span><span class="p">,</span>
        <span class="s1">'phone_number'</span> <span class="err">:</span> <span class="s1">'4423456723'</span><span class="p">,</span>
        <span class="s1">'email'</span> <span class="err">:</span> <span class="s1">'juan.vazquez@empresa.com.mx'</span>
   <span class="p">}</span>
<span class="p">}</span>

<span class="nx">openpay</span><span class="p">.</span><span class="nx">charges</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">chargeRequest</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">charge</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// ...
</span><span class="p">});</span>
</pre><pre class="highlight ruby"><span class="vi">@openpay</span><span class="o">=</span><span class="no">OpenpayApi</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"moiep6umtcnanql3jrxp"</span><span class="p">,</span><span class="s2">"sk_3433941e467c4875b178ce26348b0fac"</span><span class="p">)</span>
<span class="vi">@charges</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:charges</span><span class="p">)</span>
<span class="n">customer_hash</span><span class="o">=</span><span class="p">{</span>
    <span class="s2">"name"</span> <span class="o">=&gt;</span> <span class="s2">"Juan"</span><span class="p">,</span>
    <span class="s2">"last_name"</span> <span class="o">=&gt;</span> <span class="s2">"Vazquez Juarez"</span><span class="p">,</span>
    <span class="s2">"phone_number"</span> <span class="o">=&gt;</span> <span class="s2">"4423456723"</span><span class="p">,</span>
    <span class="s2">"email"</span> <span class="o">=&gt;</span> <span class="s2">"juan.vazquez@empresa.com.mx"</span>
<span class="p">}</span>
<span class="n">request_hash</span><span class="o">=</span><span class="p">{</span>
    <span class="s2">"method"</span> <span class="o">=&gt;</span> <span class="s2">"card"</span><span class="p">,</span>
    <span class="s2">"source_id"</span> <span class="o">=&gt;</span> <span class="s2">"kqgykn96i7bcs1wwhvgw"</span><span class="p">,</span>
    <span class="s2">"amount"</span> <span class="o">=&gt;</span> <span class="mi">100</span><span class="o">.</span><span class="mo">00</span><span class="p">,</span>
    <span class="s2">"description"</span> <span class="o">=&gt;</span> <span class="s2">"Cargo inicial a mi merchant"</span><span class="p">,</span>
    <span class="s2">"order_id"</span> <span class="o">=&gt;</span> <span class="s2">"oid-00051"</span><span class="p">,</span>
    <span class="s2">"device_session_id"</span> <span class="o">=&gt;</span> <span class="s2">"kR1MiQhz2otdIuUlQkbEyitIqVMiI16f"</span><span class="p">,</span>
    <span class="s2">"customer"</span> <span class="o">=&gt;</span> <span class="n">customer_hash</span>
<span class="p">}</span>

<span class="n">response_hash</span><span class="o">=</span><span class="vi">@charges</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="n">request_hash</span><span class="p">.</span><span class="nf">to_hash</span><span class="p">)</span>
</pre>
<blockquote>
<p>Response example</p>
</blockquote>
<pre class="highlight json"><span class="p">{</span><span class="w">
   </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"trzjaozcik8msyqshka4"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"amount"</span><span class="p">:</span><span class="mf">100.00</span><span class="p">,</span><span class="w">
   </span><span class="s2">"authorization"</span><span class="p">:</span><span class="s2">"801585"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"method"</span><span class="p">:</span><span class="s2">"card"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"operation_type"</span><span class="p">:</span><span class="s2">"in"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"transaction_type"</span><span class="p">:</span><span class="s2">"charge"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"card"</span><span class="p">:{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"kqgykn96i7bcs1wwhvgw"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"debit"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"brand"</span><span class="p">:</span><span class="s2">"visa"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"address"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"card_number"</span><span class="p">:</span><span class="s2">"411111XXXXXX1111"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"holder_name"</span><span class="p">:</span><span class="s2">"Juan Perez Ramirez"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"expiration_year"</span><span class="p">:</span><span class="s2">"20"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"expiration_month"</span><span class="p">:</span><span class="s2">"12"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"allows_charges"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="s2">"allows_payouts"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="s2">"2014-05-26T11:02:16-05:00"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"bank_name"</span><span class="p">:</span><span class="s2">"Banamex"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"bank_code"</span><span class="p">:</span><span class="s2">"002"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"customer_id"</span><span class="p">:</span><span class="s2">"ag4nktpdzebjiye1tlze"</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="s2">"status"</span><span class="p">:</span><span class="s2">"completed"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"currency"</span><span class="p">:</span><span class="s2">"MXN"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="s2">"2014-05-26T11:02:45-05:00"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"operation_date"</span><span class="p">:</span><span class="s2">"2014-05-26T11:02:45-05:00"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"description"</span><span class="p">:</span><span class="s2">"Cargo inicial a mi cuenta"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"error_message"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
   </span><span class="s2">"order_id"</span><span class="p">:</span><span class="s2">"oid-00051"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<p>This type of charge requires a saved card or a previously generated token. To save cards read <a href="#create-a-card">Create a card</a> and to use tokens visit the <a href="#create-a-new-token">Creation of tokens</a> section.</p>

<p>Once you have a saved card or token use the <code>source_id</code> property to send the identifier.</p>

<p>The <code>device_session_id</code> property must be generated using JavaScript API, see <a href="https://github.com/open-pay/openpay-js#fraud-detection-using-device-data">Fraud detection using device data</a>.</p>

<p><aside class="notice">
You can charge the merchant account or the customer account.
</aside></p>

<p><strong><em>Customized antifraud system</em></strong></br>
You can send extra data to Openpay in order to increase number of variables and get better results in antifraud detection for your transactions.</p>

<p><aside class="notice">
If you want to use this feature you need to send <code>metadata</code> property with all fields you think can help to decide when a transaction is a fraud trying. Call support line to enable this feature</br>
</aside></p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>method</td>
<td><strong><em>string</em></strong> (required) <br/>It must contain the <strong>card</strong> value in order to specify the charge will be made from card.</td>
</tr>
<tr>
<td>source_id</td>
<td><strong><em>string</em></strong> (required, length = 45) <br/>Saved ID card or token id created from where the funds are withdrawn.</td>
</tr>
<tr>
<td>amount</td>
<td><strong><em>numeric</em></strong> (required) <br/>Amount to charge. Must be an amount greater than zero, with up to two decimal digits.</td>
</tr>
<tr>
<td>description</td>
<td><strong><em>string</em></strong> (required, length = 250) <br/>A description associated to the charge.</td>
</tr>
<tr>
<td>order_id</td>
<td><strong><em>string</em></strong> (optional, length = 100) <br/>Unique identifier of charge. Must be unique among all transactions.</td>
</tr>
<tr>
<td>device_session_id</td>
<td><strong><em>string</em></strong> (required, length = 255) <br/>Identifier of the device generated by the antifraud tool.</td>
</tr>
<tr>
<td>capture</td>
<td><strong><em>boolean</em></strong> (optional, default = true) <br/>Indicates whether the charge is made immediately or not , when the value is false the charge is handled as authorized (or pre-authorization) and the amount is only to be confirmed or canceled in a second call.</td>
</tr>
<tr>
<td><a href="#create-a-new-customer">customer</a></td>
<td><strong><em>object</em></strong> (optional) <br/>Customer information who is charged. You can use the same parameters used in the creation of a customer but an account for the customer will not be created. <br/><br/> <strong>Note:</strong> This parameter can be used only by creating the charge at the merchant level<br/><br/> To create a customer and keep a record of their charges history refer to <a href="#create-a-new-customer">create a customer</a> and do the charge at the customer level.</td>
</tr>
<tr>
<td>metadata</td>
<td><strong><em>list(key, value)</em></strong> (optional) <br/>Field list to send antifraud system, It must be according to <a href="#custom-to-send-antifraud-fields">Rules to send custom antifraud fields</a>.</td>
</tr>
<tr>
<td>use_card_points</td>
<td><strong><em>boolean</em></strong> (optional, default = false) <br/>Indicates whether the charge should try to use reward points or not. This should only be used when the points_card property of a card or token is true, otherwise an error will be returned.</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<p>Returns a <a href="#transaction-object">transaction object</a> with the charge information or with an <a href="#error-object">error response</a>.</p>

<h2 id="charge-a-new-card">Charge a new card</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell">Merchant
POST https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/charges

Customer
POST https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/customers/<span class="o">{</span>CUSTOMER_ID<span class="o">}</span>/charges
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="c1">//Merchant
</span><span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">charges</span><span class="o">-&gt;</span><span class="na">create</span><span class="p">(</span><span class="nx">chargeRequest</span><span class="p">);</span>

<span class="c1">//Customer
</span><span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">customerId</span><span class="p">);</span>
<span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">charges</span><span class="o">-&gt;</span><span class="na">create</span><span class="p">(</span><span class="nx">chargeRequest</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="c1">//Customer</span>
<span class="n">openpayAPI</span><span class="o">.</span><span class="na">charges</span><span class="o">().</span><span class="na">create</span><span class="o">(</span><span class="n">String</span> <span class="n">customerId</span><span class="o">,</span> <span class="n">CreateCardChargeParams</span> <span class="n">request</span><span class="o">);</span>

<span class="c1">//Merchant</span>
<span class="n">openpayAPI</span><span class="o">.</span><span class="na">charges</span><span class="o">().</span><span class="na">create</span><span class="o">(</span><span class="n">CreateCardChargeParams</span> <span class="n">request</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="c1">//Customer
</span><span class="n">openpayAPI</span><span class="p">.</span><span class="n">ChargeService</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="kt">string</span> <span class="n">customer_id</span><span class="p">,</span> <span class="n">ChargeRequest</span> <span class="n">request</span><span class="p">);</span>

<span class="c1">//Merchant
</span><span class="n">openpayAPI</span><span class="p">.</span><span class="n">ChargeService</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="n">ChargeRequest</span> <span class="n">request</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="c1">//Merchant
</span><span class="nx">openpay</span><span class="p">.</span><span class="nx">charges</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">chargeRequest</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>

<span class="c1">//Customer
</span><span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">charges</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">customerId</span><span class="p">,</span> <span class="nx">chargeRequest</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
</pre><pre class="highlight ruby"><span class="c1">#Customer</span>
<span class="vi">@charges</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:charges</span><span class="p">)</span>
<span class="vi">@charges</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="n">request_hash</span><span class="p">,</span> <span class="n">customer_id</span><span class="p">)</span>

<span class="c1">#Merchant</span>
<span class="vi">@charges</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:charges</span><span class="p">)</span>
<span class="vi">@charges</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="n">request_hash</span><span class="p">)</span>
</pre>
<blockquote>
<p>Merchant request example</p>
</blockquote>
<pre class="highlight shell">curl https://sandbox-api.openpay.mx/v1/mzdtln0bmtms6o3kck8f/charges <span class="se">\</span>
   -u sk_e568c42a6c384b7ab02cd47d2e407cab: <span class="se">\</span>
   -H <span class="s2">"Content-type: application/json"</span> <span class="se">\</span>
   -X POST -d <span class="s1">'{
   "card": {
      "card_number": "4111111111111111",
      "holder_name": "Juan Perez Ramirez",
      "expiration_year": "20",
      "expiration_month": "12",
      "cvv2": "110"
   },
   "method" : "card",
   "amount" : 100,
   "description" : "Cargo inicial a mi cuenta",
   "order_id" : "oid-00052",
   "device_session_id" : "kR1MiQhz2otdIuUlQkbEyitIqVMiI16f",
   "customer" : {
        "name" : "Juan",
        "last_name" : "Vazquez Juarez",
        "phone_number" : "4423456723",
        "email" : "juan.vazquez@empresa.com.mx"
   },
   "metadata" : {
      "destination" : "Mexico-Queretaro Corrida 1", 
      "bus_number" : "42123", 
      "seat_no" : "25",
      "sale_date" : "2014-11-26 19:11:12", 
      "fees" : "13.32"
   }
} '</span> 
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$openpay</span> <span class="o">=</span> <span class="nx">Openpay</span><span class="o">::</span><span class="na">getInstance</span><span class="p">(</span><span class="s1">'mzdtln0bmtms6o3kck8f'</span><span class="p">,</span> <span class="s1">'sk_e568c42a6c384b7ab02cd47d2e407cab'</span><span class="p">);</span>

<span class="nv">$card</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'card_number'</span> <span class="o">=&gt;</span> <span class="s1">'4111111111111111'</span><span class="p">,</span>
    <span class="s1">'holder_name'</span> <span class="o">=&gt;</span> <span class="s1">'Juan Perez Ramirez'</span><span class="p">,</span>
    <span class="s1">'expiration_year'</span> <span class="o">=&gt;</span> <span class="s1">'20'</span><span class="p">,</span>
    <span class="s1">'expiration_month'</span> <span class="o">=&gt;</span> <span class="s1">'12'</span><span class="p">,</span>
    <span class="s1">'cvv2'</span> <span class="o">=&gt;</span> <span class="s1">'110'</span><span class="p">);</span>
<span class="nv">$metadata</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'destination'</span> <span class="o">=&gt;</span> <span class="s1">'Mexico-Queretaro Corrida 1'</span><span class="p">,</span> 
    <span class="s1">'bus_number'</span> <span class="o">=&gt;</span> <span class="s1">'42123", 
    '</span><span class="nx">seat_no</span><span class="s1">' =&gt; '</span><span class="mi">25</span><span class="s1">',
    '</span><span class="nx">travel_date</span><span class="s1">' =&gt; '</span><span class="mi">2014</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">26</span> <span class="mi">19</span><span class="o">:</span><span class="mi">11</span><span class="o">:</span><span class="mi">12</span><span class="s1">', 
    '</span><span class="nx">fees</span><span class="s1">' =&gt; '</span><span class="mf">13.32</span><span class="s1">');
$customer =&gt; array(
     '</span><span class="nx">name</span><span class="s1">' =&gt; '</span><span class="nx">Juan</span><span class="s1">',
     '</span><span class="nx">last_name</span><span class="s1">' =&gt; '</span><span class="nx">Vazquez</span> <span class="nx">Juarez</span><span class="s1">',
     '</span><span class="nx">phone_number</span><span class="s1">' =&gt; '</span><span class="mi">4423456723</span><span class="s1">',
     '</span><span class="nx">email</span><span class="s1">' =&gt; '</span><span class="nx">juan</span><span class="o">.</span><span class="nx">vazquez</span><span class="o">@</span><span class="nx">empresa</span><span class="o">.</span><span class="nx">com</span><span class="o">.</span><span class="nx">mx</span><span class="s1">');

$chargeRequest = array(
    '</span><span class="nx">method</span><span class="s1">' =&gt; '</span><span class="nx">card</span><span class="s1">',
    '</span><span class="nx">card</span><span class="s1">' =&gt; $card,
    '</span><span class="nx">amount</span><span class="s1">' =&gt; 100,
    '</span><span class="nx">description</span><span class="s1">' =&gt; '</span><span class="nx">Cargo</span> <span class="nx">inicial</span> <span class="nx">a</span> <span class="nx">mi</span> <span class="nx">cuenta</span><span class="s1">',
    '</span><span class="nx">order_id</span><span class="s1">' =&gt; '</span><span class="nx">oid</span><span class="o">-</span><span class="mo">00052</span><span class="s1">',
    '</span><span class="nx">device_session_id</span><span class="s1">' =&gt; '</span><span class="nx">kR1MiQhz2otdIuUlQkbEyitIqVMiI16f</span><span class="s1">',
    '</span><span class="nx">customer</span><span class="s1">' =&gt; $customer,
    '</span><span class="nx">metadata</span><span class="err">'</span> <span class="o">=&gt;</span> <span class="nv">$metadata</span><span class="p">);</span>

<span class="nv">$charge</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">charges</span><span class="o">-&gt;</span><span class="na">create</span><span class="p">(</span><span class="nv">$chargeRequest</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OpenpayAPI</span><span class="o">(</span><span class="s">"https://sandbox-api.openpay.mx"</span><span class="o">,</span> <span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="o">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="o">);</span>
<span class="n">CreateCardChargeParams</span> <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CreateCardChargeParams</span><span class="o">();</span>
<span class="n">Card</span> <span class="n">card</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Card</span><span class="o">();</span>
<span class="n">card</span><span class="o">.</span><span class="na">holderName</span><span class="o">(</span><span class="s">"Juan Perez Ramirez"</span><span class="o">);</span>
<span class="n">card</span><span class="o">.</span><span class="na">cardNumber</span><span class="o">(</span><span class="s">"4111111111111111"</span><span class="o">);</span>
<span class="n">card</span><span class="o">.</span><span class="na">cvv2</span><span class="o">(</span><span class="s">"110"</span><span class="o">);</span>
<span class="n">card</span><span class="o">.</span><span class="na">expirationMonth</span><span class="o">(</span><span class="mi">12</span><span class="o">);</span>
<span class="n">card</span><span class="o">.</span><span class="na">expirationYear</span><span class="o">(</span><span class="mi">20</span><span class="o">);</span>

<span class="n">Customer</span> <span class="n">customer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Customer</span><span class="o">();</span>
<span class="n">customer</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="s">"Juan"</span><span class="o">);</span>
<span class="n">customer</span><span class="o">.</span><span class="na">setLastName</span><span class="o">(</span><span class="s">"Vazquez Juarez"</span><span class="o">);</span>
<span class="n">customer</span><span class="o">.</span><span class="na">setPhoneNumber</span><span class="o">(</span><span class="s">"4423456723"</span><span class="o">);</span>
<span class="n">customer</span><span class="o">.</span><span class="na">setEmail</span><span class="o">(</span><span class="s">"juan.vazquez@empresa.com.mx"</span><span class="o">);</span>

<span class="n">request</span><span class="o">.</span><span class="na">amount</span><span class="o">(</span><span class="k">new</span> <span class="n">BigDecimal</span><span class="o">(</span><span class="s">"100.00"</span><span class="o">));</span>
<span class="n">request</span><span class="o">.</span><span class="na">description</span><span class="o">(</span><span class="s">"Cargo inicial a mi cuenta"</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">card</span><span class="o">(</span><span class="n">card</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">orderId</span><span class="o">(</span><span class="s">"oid-00052"</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">deviceSessionId</span><span class="o">(</span><span class="s">"kR1MiQhz2otdIuUlQkbEyitIqVMiI16f"</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">setCustomer</span><span class="o">(</span><span class="n">customer</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">addUserField</span><span class="o">(</span><span class="s">"desctination"</span><span class="o">,</span> <span class="s">"Mexico-Queretaro Corrida 1"</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">addUserField</span><span class="o">(</span><span class="s">"bus_no"</span><span class="o">,</span> <span class="s">"42123"</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">addUserField</span><span class="o">(</span><span class="s">"seat_no"</span><span class="o">,</span> <span class="s">"25"</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">addUserField</span><span class="o">(</span><span class="s">"travel_date"</span><span class="o">,</span> <span class="s">"2014-11-26 19:11:12"</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">addUserField</span><span class="o">(</span><span class="s">"fees"</span><span class="o">,</span> <span class="s">"123.32"</span><span class="o">);</span>

<span class="n">Charge</span> <span class="kt">char</span><span class="n">ge</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="na">charges</span><span class="o">().</span><span class="na">create</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">OpenpayAPI</span><span class="p">(</span><span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="p">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="p">);</span>
<span class="n">ChargeRequest</span> <span class="n">request</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">ChargeRequest</span><span class="p">();</span>
<span class="n">request</span><span class="p">.</span><span class="n">Method</span> <span class="p">=</span> <span class="s">"card"</span><span class="p">;</span>
<span class="n">Card</span> <span class="n">card</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Card</span><span class="p">();</span>
<span class="n">card</span><span class="p">.</span><span class="n">HolderName</span> <span class="p">=</span> <span class="s">"Juan Perez Ramirez"</span><span class="p">;</span>
<span class="n">card</span><span class="p">.</span><span class="n">CardNumber</span> <span class="p">=</span> <span class="s">"4111111111111111"</span><span class="p">;</span>
<span class="n">card</span><span class="p">.</span><span class="n">Cvv2</span> <span class="p">=</span> <span class="s">"110"</span><span class="p">;</span>
<span class="n">card</span><span class="p">.</span><span class="n">ExpirationMonth</span> <span class="p">=</span> <span class="s">"12"</span><span class="p">;</span>
<span class="n">card</span><span class="p">.</span><span class="n">ExpirationYear</span> <span class="p">=</span> <span class="s">"20"</span><span class="p">;</span>

<span class="n">Customer</span> <span class="n">customer</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Customer</span><span class="p">();</span>
<span class="n">customer</span><span class="p">.</span><span class="n">Name</span> <span class="p">=</span> <span class="s">"Juan"</span><span class="p">;</span>
<span class="n">customer</span><span class="p">.</span><span class="n">LastName</span> <span class="p">=</span> <span class="s">"Vazquez Juarez"</span><span class="p">;</span>
<span class="n">customer</span><span class="p">.</span><span class="n">PhoneNumber</span> <span class="p">=</span> <span class="s">"4423456723"</span><span class="p">;</span>
<span class="n">customer</span><span class="p">.</span><span class="n">Email</span> <span class="p">=</span> <span class="s">"juan.vazquez@empresa.com.mx"</span><span class="p">;</span>

<span class="n">request</span><span class="p">.</span><span class="n">Card</span> <span class="p">=</span> <span class="n">card</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">Amount</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Decimal</span><span class="p">(</span><span class="m">9.99</span><span class="p">);</span>
<span class="n">request</span><span class="p">.</span><span class="n">Description</span> <span class="p">=</span> <span class="s">"Cargo inicial a mi cuenta"</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">OrderId</span> <span class="p">=</span> <span class="s">"oid-00052"</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">DeviceSessionId</span> <span class="p">=</span> <span class="s">"kR1MiQhz2otdIuUlQkbEyitIqVMiI16f"</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">Customer</span> <span class="p">=</span> <span class="n">customer</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="nf">addUserField</span><span class="p">(</span><span class="s">"destination"</span><span class="p">,</span> <span class="s">"Mexico-Queretaro Corrida 1"</span><span class="p">);</span>
<span class="n">request</span><span class="p">.</span><span class="nf">addUserField</span><span class="p">(</span><span class="s">"bus_no"</span><span class="p">,</span> <span class="s">"42123"</span><span class="p">);</span>
<span class="n">request</span><span class="p">.</span><span class="nf">addUserField</span><span class="p">(</span><span class="s">"seat_no"</span><span class="p">,</span> <span class="s">"25"</span><span class="p">);</span>
<span class="n">request</span><span class="p">.</span><span class="nf">addUserField</span><span class="p">(</span><span class="s">"travel_date"</span><span class="p">,</span> <span class="s">"2014-11-26 19:11:12"</span><span class="p">);</span>
<span class="n">request</span><span class="p">.</span><span class="nf">addUserField</span><span class="p">(</span><span class="s">"fees"</span><span class="p">,</span> <span class="s">"123.32"</span><span class="p">);</span>

<span class="n">Charge</span> <span class="n">charge</span> <span class="p">=</span> <span class="n">api</span><span class="p">.</span><span class="n">ChargeService</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="n">request</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="kd">var</span> <span class="nx">chargeRequest</span> <span class="o">=</span> <span class="p">{</span>
   <span class="s1">'card'</span><span class="err">:</span> <span class="p">{</span>
      <span class="s1">'card_number'</span><span class="err">:</span> <span class="s1">'4111111111111111'</span><span class="p">,</span>
      <span class="s1">'holder_name'</span><span class="err">:</span> <span class="s1">'Juan Perez Ramirez'</span><span class="p">,</span>
      <span class="s1">'expiration_year'</span><span class="err">:</span> <span class="s1">'20'</span><span class="p">,</span>
      <span class="s1">'expiration_month'</span><span class="err">:</span> <span class="s1">'12'</span><span class="p">,</span>
      <span class="s1">'cvv2'</span><span class="err">:</span> <span class="s1">'110'</span>
   <span class="p">},</span>
   <span class="s1">'method'</span> <span class="err">:</span> <span class="s1">'card'</span><span class="p">,</span>
   <span class="s1">'amount'</span> <span class="err">:</span> <span class="mi">100</span><span class="p">,</span>
   <span class="s1">'description'</span> <span class="err">:</span> <span class="s1">'Cargo inicial a mi cuenta'</span><span class="p">,</span>
   <span class="s1">'order_id'</span> <span class="err">:</span> <span class="s1">'oid-00052'</span><span class="p">,</span>
   <span class="s1">'device_session_id'</span> <span class="err">:</span> <span class="s1">'kR1MiQhz2otdIuUlQkbEyitIqVMiI16f'</span><span class="p">,</span>
   <span class="s1">'customer'</span> <span class="err">:</span> <span class="p">{</span>
        <span class="s1">'name'</span> <span class="err">:</span> <span class="s1">'Juan'</span><span class="p">,</span>
        <span class="s1">'last_name'</span> <span class="err">:</span> <span class="s1">'Vazquez Juarez'</span><span class="p">,</span>
        <span class="s1">'phone_number'</span> <span class="err">:</span> <span class="s1">'4423456723'</span><span class="p">,</span>
        <span class="s1">'email'</span> <span class="err">:</span> <span class="s1">'juan.vazquez@empresa.com.mx'</span>
   <span class="p">},</span>
   <span class="s1">'metadata'</span> <span class="err">:</span> <span class="p">{</span>
      <span class="s1">'destination'</span> <span class="err">:</span> <span class="s1">'Mexico-Queretaro Corrida 1'</span><span class="p">,</span> 
      <span class="s1">'bus_number'</span> <span class="err">:</span> <span class="s1">'42123'</span><span class="p">,</span> 
      <span class="s1">'seat_no'</span> <span class="err">:</span> <span class="s1">'25'</span><span class="p">,</span>
      <span class="s1">'travel_date'</span> <span class="err">:</span> <span class="s1">'2014-11-26 19:11:12'</span><span class="p">,</span> 
      <span class="s1">'fee'</span> <span class="err">:</span> <span class="s1">'13.32'</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="nx">openpay</span><span class="p">.</span><span class="nx">charges</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">chargeRequest</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">charge</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// ...
</span><span class="p">});</span>
</pre><pre class="highlight ruby"><span class="vi">@openpay</span><span class="o">=</span><span class="no">OpenpayApi</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"moiep6umtcnanql3jrxp"</span><span class="p">,</span><span class="s2">"sk_3433941e467c4875b178ce26348b0fac"</span><span class="p">)</span>
<span class="vi">@charges</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:charges</span><span class="p">)</span>
<span class="n">card_hash</span><span class="o">=</span><span class="p">{</span>
     <span class="s2">"holder_name"</span> <span class="o">=&gt;</span> <span class="s2">"Juan Perez Ramirez"</span><span class="p">,</span>
     <span class="s2">"card_number"</span> <span class="o">=&gt;</span> <span class="s2">"4111111111111111"</span><span class="p">,</span>
     <span class="s2">"cvv2"</span> <span class="o">=&gt;</span> <span class="s2">"110"</span><span class="p">,</span>
     <span class="s2">"expiration_month"</span> <span class="o">=&gt;</span> <span class="s2">"12"</span><span class="p">,</span>
     <span class="s2">"expiration_year"</span> <span class="o">=&gt;</span> <span class="s2">"20"</span>
   <span class="p">}</span>
<span class="n">customer_hash</span><span class="o">=</span><span class="p">{</span>
    <span class="s2">"name"</span> <span class="o">=&gt;</span> <span class="s2">"Juan"</span><span class="p">,</span>
    <span class="s2">"last_name"</span> <span class="o">=&gt;</span> <span class="s2">"Vazquez Juarez"</span><span class="p">,</span>
    <span class="s2">"phone_number"</span> <span class="o">=&gt;</span> <span class="s2">"4423456723"</span><span class="p">,</span>
    <span class="s2">"email"</span> <span class="o">=&gt;</span> <span class="s2">"juan.vazquez@empresa.com.mx"</span>
   <span class="p">}</span>
<span class="n">metadata_hash</span><span class="o">=</span><span class="p">{</span>
      <span class="s2">"destination"</span> <span class="o">=&gt;</span> <span class="s2">"Mexico-Queretaro Corrida 1"</span><span class="p">,</span> 
      <span class="s2">"bus_number"</span> <span class="o">=&gt;</span> <span class="s2">"42123"</span><span class="p">,</span> 
      <span class="s2">"seat_no"</span> <span class="o">=&gt;</span> <span class="s2">"25"</span><span class="p">,</span>
      <span class="s2">"sale_date"</span> <span class="o">=&gt;</span> <span class="s2">"2014-11-26 19:11:12"</span><span class="p">,</span> 
      <span class="s2">"fee"</span> <span class="o">=&gt;</span> <span class="s2">"13.32"</span>
   <span class="p">}</span>
<span class="n">request_hash</span><span class="o">=</span><span class="p">{</span>
     <span class="s2">"method"</span> <span class="o">=&gt;</span> <span class="s2">"card"</span><span class="p">,</span>
     <span class="s2">"card"</span> <span class="o">=&gt;</span> <span class="n">card_hash</span><span class="p">,</span>   
     <span class="s2">"amount"</span> <span class="o">=&gt;</span> <span class="mi">100</span><span class="o">.</span><span class="mo">00</span><span class="p">,</span>
     <span class="s2">"description"</span> <span class="o">=&gt;</span> <span class="s2">"Cargo inicial a mi cuenta"</span><span class="p">,</span>
     <span class="s2">"order_id"</span> <span class="o">=&gt;</span> <span class="s2">"oid-00052"</span><span class="p">,</span>
     <span class="s2">"device_session_id"</span> <span class="o">=&gt;</span> <span class="s2">"kR1MiQhz2otdIuUlQkbEyitIqVMiI16f"</span><span class="p">,</span>
     <span class="s2">"customer"</span> <span class="o">=&gt;</span> <span class="n">customer_hash</span><span class="p">,</span>
     <span class="s2">"metadata"</span> <span class="o">=&gt;</span> <span class="n">metadata_hash</span>
   <span class="p">}</span>

<span class="n">response_hash</span><span class="o">=</span><span class="vi">@charges</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="n">request_hash</span><span class="p">.</span><span class="nf">to_hash</span><span class="p">)</span>
</pre>
<blockquote>
<p>Response example</p>
</blockquote>
<pre class="highlight json"><span class="p">{</span><span class="w">
   </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"tr6cxbcefzatd10guvvw"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"amount"</span><span class="p">:</span><span class="mf">100.00</span><span class="p">,</span><span class="w">
   </span><span class="s2">"authorization"</span><span class="p">:</span><span class="s2">"801585"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"method"</span><span class="p">:</span><span class="s2">"card"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"operation_type"</span><span class="p">:</span><span class="s2">"in"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"transaction_type"</span><span class="p">:</span><span class="s2">"charge"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"card"</span><span class="p">:{</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"debit"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"brand"</span><span class="p">:</span><span class="s2">"visa"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"address"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"card_number"</span><span class="p">:</span><span class="s2">"411111XXXXXX1111"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"holder_name"</span><span class="p">:</span><span class="s2">"Juan Perez Ramirez"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"expiration_year"</span><span class="p">:</span><span class="s2">"20"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"expiration_month"</span><span class="p">:</span><span class="s2">"12"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"allows_charges"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="s2">"allows_payouts"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="s2">"bank_name"</span><span class="p">:</span><span class="s2">"Banamex"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"bank_code"</span><span class="p">:</span><span class="s2">"002"</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="s2">"status"</span><span class="p">:</span><span class="s2">"completed"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"currency"</span><span class="p">:</span><span class="s2">"MXN"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="s2">"2014-05-26T11:56:25-05:00"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"operation_date"</span><span class="p">:</span><span class="s2">"2014-05-26T11:56:25-05:00"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"description"</span><span class="p">:</span><span class="s2">"Cargo inicial a mi cuenta"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"error_message"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
   </span><span class="s2">"order_id"</span><span class="p">:</span><span class="s2">"oid-00052"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"metadata"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"destination"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Mexico-Queretaro Corrida 1"</span><span class="p">,</span><span class="w"> 
      </span><span class="s2">"bus_number"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"42123"</span><span class="p">,</span><span class="w"> 
      </span><span class="s2">"seat_no"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"25"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"sale_date"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-11-26 19:11:12"</span><span class="p">,</span><span class="w"> 
      </span><span class="s2">"fee"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"13.32"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<p>In this type of invocation it is necessary to send all the card information, which will only be used for this transaction and will not be stored in the system. This can be used for direct sales which do not require the card for future use.</p>

<p>The <code>device_Session_Id</code> property must be generated using the JavaScript API, see <a href="https://github.com/open-pay/openpay-js#fraud-detection-using-device-data">Fraud detection using device data</a>.</p>

<p><strong><em>Customized antifraud system</em></strong></br>
You can send extra data to Openpay in order to increase variable number and get better results in antifraud detection for your transactions.</p>

<p><aside class="notice">
If you want to use this fact you need to send <code>metadata</code> property with all fields you think can help to decide when a transaction is a fraud trying. Call support line to enable this feature. </br>
</aside></p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Property</th>
<th>Descripction</th>
</tr>
</thead><tbody>
<tr>
<td>method</td>
<td><strong><em>string</em></strong> (required) <br/>It must contain the <strong>card</strong> value it means the charge will be made from card.</td>
</tr>
<tr>
<td>card</td>
<td><strong><em>object</em></strong> (required) <br/> Data of the card which the funds will be withdrawn. See <a href="#create-a-card">Card Object</a></td>
</tr>
<tr>
<td>amount</td>
<td><strong><em>numeric</em></strong> (required) <br/>Amount of charge. Must be an amount greater than zero, with up to two decimal digits.</td>
</tr>
<tr>
<td>description</td>
<td><strong><em>string</em></strong> (required, length = 250) <br/>A description associated to the charge.</td>
</tr>
<tr>
<td>order_id</td>
<td><strong><em>string</em></strong> (optional, length = 100) <br/>Unique identifier of the charge. Must be unique among all transactions.</td>
</tr>
<tr>
<td>device_session_id</td>
<td><strong><em>string</em></strong> (required, length = 255) <br/>Identifier of the device generated by the anti-fraud tool.</td>
</tr>
<tr>
<td>capture</td>
<td><strong><em>boolean</em></strong> (optional, default = true) <br/>Indicates whether the charge is made immediately or not , when the value is false the charge is handled as authorized (or pre-authorization) and the amount is only to be confirmed or canceled in a second call.</td>
</tr>
<tr>
<td><a href="#create-a-new-customer">customer</a></td>
<td><strong><em>string</em></strong> (optional) <br/>Customer information who is charged. You can use the same parameters used in the creation of a customer but an account for the customer will not be created. <br/><br/> <strong>Note:</strong> This parameter can be used only by creating the charge at the Merchant level<br/><br/> To create a customer and keep a record of their charges history refer to <a href="#create-a-new-customer">create a customer</a> and do the charge at the customer level.</td>
</tr>
<tr>
<td>metadata</td>
<td><strong><em>list(key, value)</em></strong> (optional) <br/>Field list to send antifraud system, It must be according to <a href="#rules-to-send-custom-antifraud-fields">Rules to send custom antifraud fields</a>.</td>
</tr>
<tr>
<td>use_card_points</td>
<td><strong><em>boolean</em></strong> (optional, default = false) <br/>Indicates whether the charge should try to use reward points or not. This should only be used when the points_card property of a card or token is true, otherwise an error will be returned.</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<p>Returns a <a href="#transaction-object">transaction object</a> with the charge information or with an <a href="#error-object">error response</a>.</p>

<h3 id="rules-to-send-custom-antifraud-fields">Rules to send custom antifraud fields</h3>

<p><strong><em>Characteristics for List</em></strong><br>
    * It is only valid for card charges<br>
    * You can send up to 10 fields<br></p>

<p><strong><em>Characteristics for keys</em></strong><br>
* They must be lower case alphanumÃ©ric characters or underscore.<br>
* They must not be empty nor null.<br>
* String length up to 32 characters.<br></p>

<p><strong><em>Characteristics for values</em></strong><br>
* String length up to 32 characters.<br>
* They must fit to <a href="#allowed-antifraud-fields">allowed antifraud field</a><br></p>

<h3 id="allowed-antifraud-fields">Allowed antifraud fields</h3>

<p>Openpay will save all fields you send, If you need this fields to be considered in antifraud system please call our technical support department. Allowed types are:</p>

<table><thead>
<tr>
<th>Data type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Numeric</td>
<td>Signed or unsigned numbers and decimal point are allowed.</td>
</tr>
<tr>
<td>Date</td>
<td>Dates in format: YYYY-MM-DD oo YYYY-MM-DD HH-MI:SS.</td>
</tr>
<tr>
<td>Amount</td>
<td>Unsigned numbers widhout decimal point.</td>
</tr>
<tr>
<td>Alfanumeric</td>
<td>Strings and numbers are allowed.</td>
</tr>
</tbody></table>

<h2 id="charge-via-store">Charge via store</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell">Merchant
POST https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/charges

Customer
POST https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/customers/<span class="o">{</span>CUSTOMER_ID<span class="o">}</span>/charges
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nx">Merchant</span>
<span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">charges</span><span class="o">-&gt;</span><span class="na">create</span><span class="p">(</span><span class="nx">chargeRequest</span><span class="p">);</span>

<span class="nx">Customer</span>
<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">customerId</span><span class="p">);</span>
<span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">charges</span><span class="o">-&gt;</span><span class="na">create</span><span class="p">(</span><span class="nx">chargeRequest</span><span class="p">;</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="c1">//Customer</span>
<span class="n">openpayAPI</span><span class="o">.</span><span class="na">charges</span><span class="o">().</span><span class="na">create</span><span class="o">(</span><span class="n">String</span> <span class="n">customerId</span><span class="o">,</span> <span class="n">CreateStoreChargeParams</span> <span class="n">request</span><span class="o">);</span>

<span class="c1">//Merchant</span>
<span class="n">openpayAPI</span><span class="o">.</span><span class="na">charges</span><span class="o">().</span><span class="na">create</span><span class="o">(</span><span class="n">CreateStoreChargeParams</span> <span class="n">request</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="c1">//Customer
</span><span class="n">openpayAPI</span><span class="p">.</span><span class="n">ChargeService</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="kt">string</span> <span class="n">customer_id</span><span class="p">,</span> <span class="n">ChargeRequest</span> <span class="n">request</span><span class="p">);</span>

<span class="c1">//Merchant
</span><span class="n">openpayAPI</span><span class="p">.</span><span class="n">ChargeService</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="n">ChargeRequest</span> <span class="n">request</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="c1">//Merchant
</span><span class="nx">openpay</span><span class="p">.</span><span class="nx">charges</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">chargeRequest</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>

<span class="c1">//Customer
</span><span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">charges</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">customerId</span><span class="p">,</span> <span class="nx">chargeRequest</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
</pre><pre class="highlight ruby"><span class="c1">#Customer</span>
<span class="vi">@charges</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:charges</span><span class="p">)</span>
<span class="vi">@charges</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="n">request_hash</span><span class="p">,</span> <span class="n">customer_id</span><span class="p">)</span>

<span class="c1">#Merchant</span>
<span class="vi">@charges</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:charges</span><span class="p">)</span>
<span class="vi">@charges</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="n">request_hash</span><span class="p">)</span>
</pre>
<blockquote>
<p>Customer request example</p>
</blockquote>
<pre class="highlight shell">curl https://sandbox-api.openpay.mx/v1/mzdtln0bmtms6o3kck8f/customers/ag4nktpdzebjiye1tlze/charges <span class="se">\</span>
   -u sk_e568c42a6c384b7ab02cd47d2e407cab: <span class="se">\</span>
   -H <span class="s2">"Content-type: application/json"</span> <span class="se">\</span>
   -X POST -d <span class="s1">'{
   "method" : "store",
   "amount" : 100,
   "description" : "Cargo con tienda",
   "order_id" : "oid-00053",
   "due_date" : "2014-05-28T13:45:00"
}'</span> 
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$openpay</span> <span class="o">=</span> <span class="nx">Openpay</span><span class="o">::</span><span class="na">getInstance</span><span class="p">(</span><span class="s1">'mzdtln0bmtms6o3kck8f'</span><span class="p">,</span> <span class="s1">'sk_e568c42a6c384b7ab02cd47d2e407cab'</span><span class="p">);</span>

<span class="nv">$chargeRequest</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'method'</span> <span class="o">=&gt;</span> <span class="s1">'store'</span><span class="p">,</span>
    <span class="s1">'amount'</span> <span class="o">=&gt;</span> <span class="mi">100</span><span class="p">,</span>
    <span class="s1">'description'</span> <span class="o">=&gt;</span> <span class="s1">'Cargo con tienda'</span><span class="p">,</span>
    <span class="s1">'order_id'</span> <span class="o">=&gt;</span> <span class="s1">'oid-00053'</span><span class="p">,</span>
    <span class="s1">'due_date'</span> <span class="o">=&gt;</span> <span class="s1">'2014-05-28T13:45:00'</span><span class="p">);</span>

<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'ag4nktpdzebjiye1tlze'</span><span class="p">);</span>
<span class="nv">$charge</span> <span class="o">=</span> <span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">charges</span><span class="o">-&gt;</span><span class="na">create</span><span class="p">(</span><span class="nv">$chargeRequest</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OpenpayAPI</span><span class="o">(</span><span class="s">"https://sandbox-api.openpay.mx"</span><span class="o">,</span> <span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="o">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="o">);</span>
<span class="n">Calendar</span> <span class="n">dueDate</span> <span class="o">=</span> <span class="n">Calendar</span><span class="o">.</span><span class="na">getInstance</span><span class="o">();</span>
<span class="n">dueDate</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="mi">2014</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">28</span><span class="o">,</span> <span class="mi">13</span><span class="o">,</span> <span class="mi">45</span><span class="o">,</span> <span class="mi">0</span><span class="o">);</span>
<span class="n">CreateStoreChargeParams</span> <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CreateStoreChargeParams</span><span class="o">();</span>
<span class="n">request</span><span class="o">.</span><span class="na">amount</span><span class="o">(</span><span class="k">new</span> <span class="n">BigDecimal</span><span class="o">(</span><span class="s">"100.00"</span><span class="o">));</span>
<span class="n">request</span><span class="o">.</span><span class="na">description</span><span class="o">(</span><span class="s">"Cargo con tienda"</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">orderId</span><span class="o">(</span><span class="s">"oid-00053"</span>
<span class="n">request</span><span class="o">.</span><span class="na">dueDate</span><span class="o">(</span><span class="n">dueDate</span><span class="o">.</span><span class="na">getTime</span><span class="o">());</span>

<span class="n">Charge</span> <span class="kt">char</span><span class="n">ge</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="na">charges</span><span class="o">().</span><span class="na">create</span><span class="o">(</span><span class="s">"ag4nktpdzebjiye1tlze"</span><span class="o">,</span> <span class="n">request</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">OpenpayAPI</span><span class="p">(</span><span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="p">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="p">);</span>
<span class="n">ChargeRequest</span> <span class="n">request</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">ChargeRequest</span><span class="p">();</span>
<span class="n">request</span><span class="p">.</span><span class="n">Method</span> <span class="p">=</span> <span class="s">"store"</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">Amount</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Decimal</span><span class="p">(</span><span class="m">100.00</span><span class="p">);</span>
<span class="n">request</span><span class="p">.</span><span class="n">Description</span> <span class="p">=</span> <span class="s">"Cargo con tienda"</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">OrderId</span> <span class="p">=</span> <span class="s">"oid-00053"</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">DueDate</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">2014</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">28</span><span class="p">,</span> <span class="m">13</span><span class="p">,</span> <span class="m">45</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>

<span class="n">Charge</span> <span class="n">charge</span> <span class="p">=</span> <span class="n">api</span><span class="p">.</span><span class="n">ChargeService</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="s">"ag4nktpdzebjiye1tlze"</span><span class="p">,</span> <span class="n">request</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="kd">var</span> <span class="nx">storeChargeRequest</span> <span class="o">=</span> <span class="p">{</span>
   <span class="s1">'method'</span> <span class="err">:</span> <span class="s1">'store'</span><span class="p">,</span>
   <span class="s1">'amount'</span> <span class="err">:</span> <span class="mi">100</span><span class="p">,</span>
   <span class="s1">'description'</span> <span class="err">:</span> <span class="s1">'Cargo con tienda'</span><span class="p">,</span>
   <span class="s1">'order_id'</span> <span class="err">:</span> <span class="s1">'oid-00053'</span><span class="p">,</span>
   <span class="s1">'due_date'</span> <span class="err">:</span> <span class="s1">'2014-05-28T13:45:00'</span>
<span class="p">};</span>

<span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">charges</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="s1">'ag4nktpdzebjiye1tlze'</span><span class="p">,</span> <span class="nx">storeChargeRequest</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">charge</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// ...
</span><span class="p">});</span>
</pre><pre class="highlight ruby"><span class="vi">@openpay</span><span class="o">=</span><span class="no">OpenpayApi</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"moiep6umtcnanql3jrxp"</span><span class="p">,</span><span class="s2">"sk_3433941e467c4875b178ce26348b0fac"</span><span class="p">)</span>
<span class="vi">@charges</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:charges</span><span class="p">)</span>
<span class="n">request_hash</span><span class="o">=</span><span class="p">{</span>
     <span class="s2">"method"</span> <span class="o">=&gt;</span> <span class="s2">"store"</span><span class="p">,</span>
     <span class="s2">"amount"</span> <span class="o">=&gt;</span> <span class="mi">100</span><span class="o">.</span><span class="mo">00</span><span class="p">,</span>
     <span class="s2">"description"</span> <span class="o">=&gt;</span> <span class="s2">"Cargo con tienda"</span><span class="p">,</span>
     <span class="s2">"order_id"</span> <span class="o">=&gt;</span> <span class="s2">"oid-00053"</span><span class="p">,</span>
     <span class="s2">"due_date"</span> <span class="o">=&gt;</span> <span class="s2">"2014-05-28T13:45:00"</span>
   <span class="p">}</span>

<span class="n">response_hash</span><span class="o">=</span><span class="vi">@charges</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="n">request_hash</span><span class="p">.</span><span class="nf">to_hash</span><span class="p">,</span> <span class="s2">"ag4nktpdzebjiye1tlze"</span><span class="p">)</span>
</pre>
<blockquote>
<p>Response example</p>
</blockquote>
<pre class="highlight json"><span class="p">{</span><span class="w">
   </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"trnirkiyobo5qfex55ef"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"amount"</span><span class="p">:</span><span class="mf">100.00</span><span class="p">,</span><span class="w">
   </span><span class="s2">"authorization"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
   </span><span class="s2">"method"</span><span class="p">:</span><span class="s2">"store"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"operation_type"</span><span class="p">:</span><span class="s2">"in"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"transaction_type"</span><span class="p">:</span><span class="s2">"charge"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"status"</span><span class="p">:</span><span class="s2">"in_progress"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"currency"</span><span class="p">:</span><span class="s2">"MXN"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="s2">"2014-05-26T13:48:25-05:00"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"operation_date"</span><span class="p">:</span><span class="s2">"2014-05-26T13:48:25-05:00"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"due_date"</span><span class="p">:</span><span class="s2">"2014-05-28T13:45:00-05:00"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"description"</span><span class="p">:</span><span class="s2">"Cargo con tienda"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"error_message"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
   </span><span class="s2">"order_id"</span><span class="p">:</span><span class="s2">"oid-00053"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"customer_id"</span><span class="p">:</span><span class="s2">"ag4nktpdzebjiye1tlze"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"payment_method"</span><span class="p">:{</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"store"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"reference"</span><span class="p">:</span><span class="s2">"000020TRNIRKIYOBO5QFEX55EF0100009"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"barcode_url"</span><span class="p">:</span><span class="s2">"https://sandbox-api.openpay.mx/barcode/000020TRNIRKIYOBO5QFEX55EF0100009?width=1&amp;height=45&amp;text=false"</span><span class="w">
   </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<p>For payments at a convenience store you should create a charge type request by indicating <strong>store</strong> as method. This will generate a response with a reference number and a URL with a barcode, which you must use to create a receipt so your customer can make the payment in one of the convenience stores. The barcode is Code 128 type.</p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>method</td>
<td><strong><em>string</em></strong> (required) <br/>It must constains the <strong>store</strong> value in order to specify you want to pay at store.</td>
</tr>
<tr>
<td>amount</td>
<td><strong><em>numeric</em></strong> (required) <br/>Amount of charge. Must be an amount greater than zero, with up to two decimal digits.</td>
</tr>
<tr>
<td>description</td>
<td><strong><em>string</em></strong> (required, length = 250) <br/>A description associated to the charge.</td>
</tr>
<tr>
<td>order_id</td>
<td><strong><em>string</em></strong> (optional, length = 100) <br/>Unique identifier of charge. Must be unique among all transactions.</td>
</tr>
<tr>
<td>due_date</td>
<td><strong><em>datetime</em></strong> (optional) <br/>Due date for making the payment in the store in  ISO 8601 format. <br/><br/>Example (UTC): 2014-08-01T00:50:00Z <br/><strong><em>Note:</em></strong> On the server side the date will be changeg to central time<br/><br/>Example (Central Time): 2014-08-01T11:51:23-05:00</td>
</tr>
<tr>
<td><a href="#create-a-new-customer">customer</a></td>
<td><strong><em>string</em></strong> (optional) <br/>Customer information who is charged. You can use the same parameters used in the creation of a customer but an account for the customer will not be created. <br/><br/> <strong>Note:</strong> This parameter can be used only by creating the charge at the Merchant level establishing a level trade <br/><br/> To create a customer and keep a record of their charges history refer to <a href="#create-a-new-customer">create a customer</a> and do the charge at the customer leve.</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<p>Returns a <a href="#transaction-object">transaction object</a> with the charge information or with an <a href="#error-object">error response</a>.</p>

<h2 id="charge-via-bank">Charge via bank</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell">Merchant
POST https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/charges

Customer
POST https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/customers/<span class="o">{</span>CUSTOMER_ID<span class="o">}</span>/charges
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nx">Merchant</span>
<span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">charges</span><span class="o">-&gt;</span><span class="na">create</span><span class="p">(</span><span class="nx">chargeRequest</span><span class="p">);</span>

<span class="nx">Customer</span>
<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">customerId</span><span class="p">);</span>
<span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">charges</span><span class="o">-&gt;</span><span class="na">create</span><span class="p">(</span><span class="nx">chargeRequest</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="c1">//Customer</span>
<span class="n">openpayAPI</span><span class="o">.</span><span class="na">charges</span><span class="o">().</span><span class="na">create</span><span class="o">(</span><span class="n">String</span> <span class="n">customerId</span><span class="o">,</span> <span class="n">CreateBankChargeParams</span> <span class="n">request</span><span class="o">);</span>

<span class="c1">//Merchant</span>
<span class="n">openpayAPI</span><span class="o">.</span><span class="na">charges</span><span class="o">().</span><span class="na">create</span><span class="o">(</span><span class="n">CreateBankChargeParams</span> <span class="n">request</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="c1">//Customer
</span><span class="n">openpayAPI</span><span class="p">.</span><span class="n">ChargeService</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="kt">string</span> <span class="n">customer_id</span><span class="p">,</span> <span class="n">ChargeRequest</span> <span class="n">request</span><span class="p">);</span>

<span class="c1">//Merchant
</span><span class="n">openpayAPI</span><span class="p">.</span><span class="n">ChargeService</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="n">ChargeRequest</span> <span class="n">request</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="c1">// Merchant
</span><span class="nx">openpay</span><span class="p">.</span><span class="nx">charges</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">chargeRequest</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>

<span class="c1">// Customer
</span><span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">charges</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">customerId</span><span class="p">,</span> <span class="nx">chargeRequest</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
</pre><pre class="highlight ruby"><span class="c1">#Customer</span>
<span class="vi">@charges</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:charges</span><span class="p">)</span>
<span class="vi">@charges</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="n">request_hash</span><span class="p">,</span> <span class="n">customer_id</span><span class="p">)</span>

<span class="c1">#Merchant</span>
<span class="vi">@charges</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:charges</span><span class="p">)</span>
<span class="vi">@charges</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="n">request_hash</span><span class="p">)</span>
</pre>
<blockquote>
<p>customer request example</p>
</blockquote>
<pre class="highlight shell">curl https://sandbox-api.openpay.mx/v1/mzdtln0bmtms6o3kck8f/customers/ag4nktpdzebjiye1tlze/charges <span class="se">\</span>
   -u sk_e568c42a6c384b7ab02cd47d2e407cab: <span class="se">\</span>
   -H <span class="s2">"Content-type: application/json"</span> <span class="se">\</span>
   -X POST -d <span class="s1">'{
   "method" : "bank_account",
   "amount" : 100,
   "description" : "Cargo con banco",
   "order_id" : "oid-00055"
} '</span> 
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$openpay</span> <span class="o">=</span> <span class="nx">Openpay</span><span class="o">::</span><span class="na">getInstance</span><span class="p">(</span><span class="s1">'mzdtln0bmtms6o3kck8f'</span><span class="p">,</span> <span class="s1">'sk_e568c42a6c384b7ab02cd47d2e407cab'</span><span class="p">);</span>

<span class="nv">$chargeRequest</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'method'</span> <span class="o">=&gt;</span> <span class="s1">'bank_account'</span><span class="p">,</span>
    <span class="s1">'amount'</span> <span class="o">=&gt;</span> <span class="mi">100</span><span class="p">,</span>
    <span class="s1">'description'</span> <span class="o">=&gt;</span> <span class="s1">'Cargo con banco'</span><span class="p">,</span>
    <span class="s1">'order_id'</span> <span class="o">=&gt;</span> <span class="s1">'oid-00055'</span><span class="p">);</span>

<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'ag4nktpdzebjiye1tlze'</span><span class="p">);</span>
<span class="nv">$charge</span> <span class="o">=</span> <span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">charges</span><span class="o">-&gt;</span><span class="na">create</span><span class="p">(</span><span class="nv">$chargeRequest</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OpenpayAPI</span><span class="o">(</span><span class="s">"https://sandbox-api.openpay.mx"</span><span class="o">,</span> <span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="o">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="o">);</span>
<span class="n">CreateBankChargeParams</span> <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CreateBankChargeParams</span><span class="o">();</span>
<span class="n">request</span><span class="o">.</span><span class="na">amount</span><span class="o">(</span><span class="k">new</span> <span class="n">BigDecimal</span><span class="o">(</span><span class="s">"100.00"</span><span class="o">));</span>
<span class="n">request</span><span class="o">.</span><span class="na">description</span><span class="o">(</span><span class="s">"Cargo con banco"</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">orderId</span><span class="o">(</span><span class="s">"oid-00053"</span><span class="o">);</span>

<span class="n">Charge</span> <span class="kt">char</span><span class="n">ge</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="na">charges</span><span class="o">().</span><span class="na">create</span><span class="o">(</span><span class="s">"ag4nktpdzebjiye1tlze"</span><span class="o">,</span> <span class="n">request</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">OpenpayAPI</span><span class="p">(</span><span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="p">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="p">);</span>
<span class="n">ChargeRequest</span> <span class="n">request</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">ChargeRequest</span><span class="p">();</span>
<span class="n">request</span><span class="p">.</span><span class="n">Method</span> <span class="p">=</span> <span class="s">"bank_account"</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">Amount</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Decimal</span><span class="p">(</span><span class="m">100.00</span><span class="p">);</span>
<span class="n">request</span><span class="p">.</span><span class="n">Description</span> <span class="p">=</span> <span class="s">"Cargo con banco"</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">OrderId</span> <span class="p">=</span> <span class="s">"oid-00053"</span><span class="p">;</span>

<span class="n">Charge</span> <span class="n">charge</span> <span class="p">=</span> <span class="n">api</span><span class="p">.</span><span class="n">ChargeService</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="s">"ag4nktpdzebjiye1tlze"</span><span class="p">,</span> <span class="n">request</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="kd">var</span> <span class="nx">bankChargeRequest</span> <span class="o">=</span> <span class="p">{</span>
   <span class="s1">'method'</span> <span class="err">:</span> <span class="s1">'bank_account'</span><span class="p">,</span>
   <span class="s1">'amount'</span> <span class="err">:</span> <span class="mi">100</span><span class="p">,</span>
   <span class="s1">'description'</span> <span class="err">:</span> <span class="s1">'Cargo con banco'</span><span class="p">,</span>
   <span class="s1">'order_id'</span> <span class="err">:</span> <span class="s1">'oid-00055'</span>
<span class="p">};</span>

<span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">charges</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="s1">'ag4nktpdzebjiye1tlze'</span><span class="p">,</span> <span class="nx">bankChargeRequest</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">charge</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// ...
</span><span class="p">});</span>

</pre><pre class="highlight ruby"><span class="vi">@openpay</span><span class="o">=</span><span class="no">OpenpayApi</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"moiep6umtcnanql3jrxp"</span><span class="p">,</span><span class="s2">"sk_3433941e467c4875b178ce26348b0fac"</span><span class="p">)</span>
<span class="vi">@charges</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:charges</span><span class="p">)</span>
<span class="n">request_hash</span><span class="o">=</span><span class="p">{</span>
     <span class="s2">"method"</span> <span class="o">=&gt;</span> <span class="s2">"bank_account"</span><span class="p">,</span>
     <span class="s2">"amount"</span> <span class="o">=&gt;</span> <span class="mi">100</span><span class="o">.</span><span class="mo">00</span><span class="p">,</span>
     <span class="s2">"description"</span> <span class="o">=&gt;</span> <span class="s2">"Cargo con banco"</span><span class="p">,</span>
     <span class="s2">"order_id"</span> <span class="o">=&gt;</span> <span class="s2">"oid-00053"</span>
   <span class="p">}</span>

<span class="n">response_hash</span><span class="o">=</span><span class="vi">@charges</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="n">request_hash</span><span class="p">.</span><span class="nf">to_hash</span><span class="p">,</span> <span class="s2">"ag4nktpdzebjiye1tlze"</span><span class="p">)</span>
</pre>
<blockquote>
<p>Response example</p>
</blockquote>
<pre class="highlight json"><span class="p">{</span><span class="w">
   </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"trnzf2xjwpupjfryyj23"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"amount"</span><span class="p">:</span><span class="mf">100.00</span><span class="p">,</span><span class="w">
   </span><span class="s2">"authorization"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
   </span><span class="s2">"method"</span><span class="p">:</span><span class="s2">"bank_account"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"operation_type"</span><span class="p">:</span><span class="s2">"in"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"transaction_type"</span><span class="p">:</span><span class="s2">"charge"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"status"</span><span class="p">:</span><span class="s2">"in_progress"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"currency"</span><span class="p">:</span><span class="s2">"MXN"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="s2">"2014-05-26T13:51:25-05:00"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"operation_date"</span><span class="p">:</span><span class="s2">"2014-05-26T13:51:25-05:00"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"description"</span><span class="p">:</span><span class="s2">"Cargo con banco"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"error_message"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
   </span><span class="s2">"order_id"</span><span class="p">:</span><span class="s2">"oid-00055"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"customer_id"</span><span class="p">:</span><span class="s2">"ag4nktpdzebjiye1tlze"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"payment_method"</span><span class="p">:{</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"bank_transfer"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"bank"</span><span class="p">:</span><span class="s2">"STP"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"clabe"</span><span class="p">:</span><span class="s2">"646180109400135624"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="s2">"0021589"</span><span class="w">
   </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<p>For a charge via bank you must create a charge type request  by indicating ** bank_account** as method. This will generate a response with a CLABE account number and a description, you have to indicate these data in a receipt so your customer can do the wire transfer via SPEI.</p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>method</td>
<td><strong><em>string</em></strong> (required) <br/>It must contain the <strong>bank_account</strong> value to specify the pay will be made with bank transfer.</td>
</tr>
<tr>
<td>amount</td>
<td><strong><em>numeric</em></strong> (required) <br/>Amount of charge. Must be an amount greater than zero, with up to two decimal digits.</td>
</tr>
<tr>
<td>description</td>
<td><strong><em>string</em></strong> (required, length = 250) <br/>A description associated to the charge.</td>
</tr>
<tr>
<td>order_id</td>
<td><strong><em>string</em></strong> (optional, length = 100) <br/>Unique identifier of charge. Must be unique among all transactions.</td>
</tr>
<tr>
<td>due_date</td>
<td><strong><em>datetime</em></strong> (optional) <br/>&gt;Due date for making the bank charge in the ISO 8601 format. <br/><br/>Example (UTC): 2014-08-01T00:50:00Z <br/><strong><em>Note:</em></strong> On the server side the date will be changed to central time<br/><br/>Example (Central Time): 2014-08-01T11:51:23-05:00</td>
</tr>
<tr>
<td><a href="#create-a-new-customer">customer</a></td>
<td><strong><em>string</em></strong> (optional) <br/>Customer information who is charged. You can use the same parameters used in the creation of a customer but an account for the customer will not be created. <br/><br/> <strong>Note:</strong> This parameter can be used only by creating the charge at the Merchant level establishing a level trade <br/><br/> To create a customer and keep a record of their charges history refer to <a href="#create-a-new-customer">create a customer</a> and do the charge at the customer level.</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<p>Returns a <a href="#transaction-object">transaction object</a> with the charge information or with an <a href="#error-object">error response</a>.</p>

<h2 id="confirming-a-charge">Confirming a charge</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell">Merchant
POST https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/charges/<span class="o">{</span>TRANSACTION_ID<span class="o">}</span>/capture

Customer
POST https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/customers/<span class="o">{</span>CUSTOMER_ID<span class="o">}</span>/charges/<span class="o">{</span>TRANSACTION_ID<span class="o">}</span>/capture
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nx">Merchant</span>
<span class="nv">$charge</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">charges</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">transactionId</span><span class="p">);</span>
<span class="nv">$charge</span><span class="o">-&gt;</span><span class="na">capture</span><span class="p">(</span><span class="nx">captureData</span><span class="p">);</span>

<span class="nx">Customer</span>
<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">customerId</span><span class="p">);</span>
<span class="nv">$charge</span> <span class="o">=</span> <span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">charges</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">transactionId</span><span class="p">);</span>
<span class="nv">$charge</span><span class="o">-&gt;</span><span class="na">capture</span><span class="p">(</span><span class="nx">captureData</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="c1">//Customer</span>
<span class="n">openpayAPI</span><span class="o">.</span><span class="na">charges</span><span class="o">().</span><span class="na">confirmCapture</span><span class="o">(</span><span class="n">String</span> <span class="n">customerId</span><span class="o">,</span> <span class="n">ConfirmCaptureParams</span> <span class="n">request</span><span class="o">);</span>

<span class="c1">//Merchant</span>
<span class="n">openpayAPI</span><span class="o">.</span><span class="na">charges</span><span class="o">().</span><span class="na">confirmCapture</span><span class="o">(</span><span class="n">ConfirmCaptureParams</span> <span class="n">request</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="c1">//Customer
</span><span class="n">openpayAPI</span><span class="p">.</span><span class="n">ChargeService</span><span class="p">.</span><span class="nf">Capture</span><span class="p">(</span><span class="kt">string</span> <span class="n">customer_id</span><span class="p">,</span> <span class="kt">string</span> <span class="n">transaction_id</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">?</span> <span class="n">amount</span><span class="p">);</span>

<span class="c1">//Merchant
</span><span class="n">openpayAPI</span><span class="p">.</span><span class="n">ChargeService</span><span class="p">.</span><span class="nf">Capture</span><span class="p">(</span><span class="kt">string</span> <span class="n">transaction_id</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">?</span> <span class="n">amount</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="c1">// Merchant
</span><span class="nx">openpay</span><span class="p">.</span><span class="nx">charges</span><span class="p">.</span><span class="nx">capture</span><span class="p">(</span><span class="nx">transactionId</span><span class="p">,</span> <span class="nx">captureRequest</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>

<span class="c1">// Customer
</span><span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">charges</span><span class="p">.</span><span class="nx">capture</span><span class="p">(</span><span class="nx">customerId</span><span class="p">,</span> <span class="nx">transactionId</span><span class="p">,</span> <span class="nx">captureRequest</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
</pre><pre class="highlight ruby"><span class="c1">#Customer</span>
<span class="vi">@charges</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:charges</span><span class="p">)</span>
<span class="vi">@charges</span><span class="p">.</span><span class="nf">capture</span><span class="p">(</span><span class="n">transaction_id</span><span class="p">,</span> <span class="n">customer_id</span><span class="p">)</span>

<span class="c1">#Merchant</span>
<span class="vi">@charges</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:charges</span><span class="p">)</span>
<span class="vi">@charges</span><span class="p">.</span><span class="nf">capture</span><span class="p">(</span><span class="n">transaction_id</span><span class="p">)</span>
</pre>
<blockquote>
<p>Customer request example</p>
</blockquote>
<pre class="highlight shell">curl https://sandbox-api.openpay.mx/v1/mzdtln0bmtms6o3kck8f/customers/ag4nktpdzebjiye1tlze/charges/tryqihxac3msedn4yxed/capture <span class="se">\</span>
   -u sk_e568c42a6c384b7ab02cd47d2e407cab: <span class="se">\</span>
   -H <span class="s2">"Content-type: application/json"</span> <span class="se">\</span>
   -X POST -d <span class="s1">'{
    "amount" : 100.00
} '</span> 
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$openpay</span> <span class="o">=</span> <span class="nx">Openpay</span><span class="o">::</span><span class="na">getInstance</span><span class="p">(</span><span class="s1">'mzdtln0bmtms6o3kck8f'</span><span class="p">,</span> <span class="s1">'sk_e568c42a6c384b7ab02cd47d2e407cab'</span><span class="p">);</span>

<span class="nv">$captureData</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">'amount'</span> <span class="o">=&gt;</span> <span class="mf">100.00</span><span class="p">);</span>

<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'ag4nktpdzebjiye1tlze'</span><span class="p">);</span>
<span class="nv">$charge</span> <span class="o">=</span> <span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">charges</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'tryqihxac3msedn4yxed'</span><span class="p">);</span>
<span class="nv">$charge</span><span class="o">-&gt;</span><span class="na">capture</span><span class="p">(</span><span class="nv">$captureData</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OpenpayAPI</span><span class="o">(</span><span class="s">"https://sandbox-api.openpay.mx"</span><span class="o">,</span> <span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="o">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="o">);</span>
<span class="n">ConfirmCaptureParams</span> <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ConfirmCaptureParams</span><span class="o">();</span>
<span class="n">request</span><span class="o">.</span><span class="na">chargeId</span><span class="o">(</span><span class="s">"tryqihxac3msedn4yxed"</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">amount</span><span class="o">(</span><span class="k">new</span> <span class="n">BigDecimal</span><span class="o">(</span><span class="s">"100.00"</span><span class="o">));</span>

<span class="n">Charge</span> <span class="kt">char</span><span class="n">ge</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="na">charges</span><span class="o">().</span><span class="na">confirmCapture</span><span class="o">(</span><span class="s">"ag4nktpdzebjiye1tlze"</span><span class="o">,</span> <span class="n">request</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">OpenpayAPI</span><span class="p">(</span><span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="p">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="p">);</span>
<span class="n">Charge</span> <span class="n">charge</span> <span class="p">=</span> <span class="n">api</span><span class="p">.</span><span class="n">ChargeService</span><span class="p">.</span><span class="nf">Capture</span><span class="p">(</span><span class="s">"ag4nktpdzebjiye1tlze"</span><span class="p">,</span> <span class="s">"tryqihxac3msedn4yxed"</span><span class="p">,</span> <span class="k">new</span> <span class="nf">Decimal</span><span class="p">(</span><span class="m">100.00</span><span class="p">));</span>
</pre><pre class="highlight javascript"><span class="kd">var</span> <span class="nx">captureRequest</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">'amount'</span> <span class="err">:</span> <span class="mf">100.00</span>
<span class="p">};</span>

<span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">charges</span><span class="p">.</span><span class="nx">capture</span><span class="p">(</span><span class="s1">'ag4nktpdzebjiye1tlze'</span><span class="p">,</span> <span class="s1">'tryqihxac3msedn4yxed'</span><span class="p">,</span> <span class="nx">captureRequest</span><span class="p">,</span> 
    <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">charge</span><span class="p">){</span>
  <span class="c1">// ...
</span><span class="p">});</span>
</pre><pre class="highlight ruby"><span class="vi">@openpay</span><span class="o">=</span><span class="no">OpenpayApi</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"moiep6umtcnanql3jrxp"</span><span class="p">,</span><span class="s2">"sk_3433941e467c4875b178ce26348b0fac"</span><span class="p">)</span>
<span class="vi">@charges</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:charges</span><span class="p">)</span>

<span class="n">response_hash</span><span class="o">=</span><span class="vi">@charges</span><span class="p">.</span><span class="nf">capture</span><span class="p">(</span><span class="s2">"tryqihxac3msedn4yxed"</span><span class="p">,</span> <span class="s2">"ag4nktpdzebjiye1tlze"</span><span class="p">)</span>
</pre>
<blockquote>
<p>Response example</p>
</blockquote>
<pre class="highlight json"><span class="p">{</span><span class="w">
   </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"tryqihxac3msedn4yxed"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"amount"</span><span class="p">:</span><span class="mf">100.00</span><span class="p">,</span><span class="w">
   </span><span class="s2">"authorization"</span><span class="p">:</span><span class="s2">"801585"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"method"</span><span class="p">:</span><span class="s2">"card"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"operation_type"</span><span class="p">:</span><span class="s2">"in"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"transaction_type"</span><span class="p">:</span><span class="s2">"charge"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"card"</span><span class="p">:{</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"debit"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"brand"</span><span class="p">:</span><span class="s2">"visa"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"address"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"card_number"</span><span class="p">:</span><span class="s2">"411111XXXXXX1111"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"holder_name"</span><span class="p">:</span><span class="s2">"Juan Perez Ramirez"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"expiration_year"</span><span class="p">:</span><span class="s2">"20"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"expiration_month"</span><span class="p">:</span><span class="s2">"12"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"allows_charges"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="s2">"allows_payouts"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="s2">"bank_name"</span><span class="p">:</span><span class="s2">"Banamex"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"bank_code"</span><span class="p">:</span><span class="s2">"002"</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="s2">"status"</span><span class="p">:</span><span class="s2">"completed"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"currency"</span><span class="p">:</span><span class="s2">"MXN"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="s2">"2014-05-26T14:00:17-05:00"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"operation_date"</span><span class="p">:</span><span class="s2">"2014-05-26T14:00:17-05:00"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"description"</span><span class="p">:</span><span class="s2">"Cargo inicial a mi cuenta"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"error_message"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
   </span><span class="s2">"order_id"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
   </span><span class="s2">"customer_id"</span><span class="p">:</span><span class="s2">"ag4nktpdzebjiye1tlze"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<p>Confirm a charge created with the <code>capture = &quot;false&quot; </code> property, this method is the second part of the <a href="#with-a-card-id-or-token">create a charge with a card (id or token)</a> and it can confirm the amount captured on the first call or a lesser amount.</p>

<p><aside class="notice">
<strong>Note:</strong> You only can confirm charges via card. To cancel the charge created you should make a call to the method <a href="#charge-refund">charge refund</a>
</aside></p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>amount</td>
<td><strong><em>numeric</em></strong> (required) <br/>Amount to confirm. It can be less than or equal to the amount given with up to two decimal digits</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<p>Returns a <a href="#transaction-object">transaction object</a> with the charge information or with an <a href="#error-object">error response</a>.</p>

<h2 id="refunding-a-charge">Refunding a charge</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell">Merchant
POST https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/charges/<span class="o">{</span>TRANSACTION_ID<span class="o">}</span>/refund

Customer
POST https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/customers/<span class="o">{</span>CUSTOMER_ID<span class="o">}</span>/charges/<span class="o">{</span>TRANSACTION_ID<span class="o">}</span>/refund
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nx">Merchant</span>
<span class="nv">$charge</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">charges</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">transactionId</span><span class="p">);</span>
<span class="nv">$charge</span><span class="o">-&gt;</span><span class="na">refund</span><span class="p">(</span><span class="nx">refundData</span><span class="p">);</span>

<span class="nx">Customer</span>
<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">customerId</span><span class="p">);</span>
<span class="nv">$charge</span> <span class="o">=</span> <span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">charges</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">transactionId</span><span class="p">);</span>
<span class="nv">$charge</span><span class="o">-&gt;</span><span class="na">refund</span><span class="p">(</span><span class="nx">refundData</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="c1">//Customer</span>
<span class="n">openpayAPI</span><span class="o">.</span><span class="na">charges</span><span class="o">().</span><span class="na">refund</span><span class="o">(</span><span class="n">String</span> <span class="n">customerId</span><span class="o">,</span> <span class="n">RefundParams</span> <span class="n">request</span><span class="o">);</span>

<span class="c1">//Merchant</span>
<span class="n">openpayAPI</span><span class="o">.</span><span class="na">charges</span><span class="o">().</span><span class="na">refund</span><span class="o">(</span><span class="n">RefundParams</span> <span class="n">request</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="c1">//Customer
</span><span class="n">openpayAPI</span><span class="p">.</span><span class="n">ChargeService</span><span class="p">.</span><span class="nf">Refund</span><span class="p">(</span><span class="kt">string</span> <span class="n">customer_id</span><span class="p">,</span> <span class="kt">string</span> <span class="n">transaction_id</span><span class="p">,</span> <span class="kt">string</span> <span class="n">description</span><span class="p">);</span>

<span class="c1">//Merchant
</span><span class="n">openpayAPI</span><span class="p">.</span><span class="n">ChargeService</span><span class="p">.</span><span class="nf">Refund</span><span class="p">(</span><span class="kt">string</span> <span class="n">transaction_id</span><span class="p">,</span> <span class="kt">string</span> <span class="n">description</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="c1">// Merchant
</span><span class="nx">openpay</span><span class="p">.</span><span class="nx">charges</span><span class="p">.</span><span class="nx">refund</span><span class="p">(</span><span class="nx">transactionId</span><span class="p">,</span> <span class="nx">refundRequest</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>

<span class="c1">// Customer
</span><span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">charges</span><span class="p">.</span><span class="nx">refund</span><span class="p">(</span><span class="nx">customerId</span><span class="p">,</span> <span class="nx">transactionId</span><span class="p">,</span> <span class="nx">refundRequest</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
</pre><pre class="highlight ruby"><span class="c1">#Customer</span>
<span class="vi">@charges</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:charges</span><span class="p">)</span>
<span class="vi">@charges</span><span class="p">.</span><span class="nf">refund</span><span class="p">(</span><span class="n">transaction_id</span><span class="p">,</span> <span class="n">request_hash</span><span class="p">,</span> <span class="n">customer_id</span><span class="p">)</span>

<span class="c1">#Merchant</span>
<span class="vi">@charges</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:charges</span><span class="p">)</span>
<span class="vi">@charges</span><span class="p">.</span><span class="nf">refund</span><span class="p">(</span><span class="n">transaction_id</span><span class="p">,</span> <span class="n">request_hash</span><span class="p">)</span>
</pre>
<blockquote>
<p>Customer request example</p>
</blockquote>
<pre class="highlight shell">curl https://sandbox-api.openpay.mx/v1/mzdtln0bmtms6o3kck8f/customers/ag4nktpdzebjiye1tlze/charges/tr6cxbcefzatd10guvvw/refund <span class="se">\</span>
   -u sk_e568c42a6c384b7ab02cd47d2e407cab: <span class="se">\</span>
   -H <span class="s2">"Content-type: application/json"</span> <span class="se">\</span>
   -X POST -d <span class="s1">'{
   "description" : "devoluciÃ³n"
} '</span> 
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$openpay</span> <span class="o">=</span> <span class="nx">Openpay</span><span class="o">::</span><span class="na">getInstance</span><span class="p">(</span><span class="s1">'mzdtln0bmtms6o3kck8f'</span><span class="p">,</span> <span class="s1">'sk_e568c42a6c384b7ab02cd47d2e407cab'</span><span class="p">);</span>

<span class="nv">$refundData</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">'description'</span> <span class="o">=&gt;</span> <span class="s1">'devoluciÃ³n'</span> <span class="p">);</span>

<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'ag4nktpdzebjiye1tlze'</span><span class="p">);</span>
<span class="nv">$charge</span> <span class="o">=</span> <span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">charges</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'tr6cxbcefzatd10guvvw'</span><span class="p">);</span>
<span class="nv">$charge</span><span class="o">-&gt;</span><span class="na">refund</span><span class="p">(</span><span class="nv">$refundData</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OpenpayAPI</span><span class="o">(</span><span class="s">"https://sandbox-api.openpay.mx"</span><span class="o">,</span> <span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="o">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="o">);</span>
<span class="n">RefundParams</span> <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="n">RefundParams</span><span class="o">();</span>
<span class="n">request</span><span class="o">.</span><span class="na">chargeId</span><span class="o">(</span><span class="s">"tryqihxac3msedn4yxed"</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">description</span><span class="o">(</span><span class="s">"Monto de cargo devuelto"</span><span class="o">);</span>

<span class="n">Charge</span> <span class="kt">char</span><span class="n">ge</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="na">charges</span><span class="o">().</span><span class="na">refund</span><span class="o">(</span><span class="s">"ag4nktpdzebjiye1tlze"</span><span class="o">,</span> <span class="n">request</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">OpenpayAPI</span><span class="p">(</span><span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="p">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="p">);</span>
<span class="n">Charge</span> <span class="n">charge</span> <span class="p">=</span> <span class="n">api</span><span class="p">.</span><span class="n">ChargeService</span><span class="p">.</span><span class="nf">Refund</span><span class="p">(</span><span class="s">"ag4nktpdzebjiye1tlze"</span><span class="p">,</span> <span class="s">"tryqihxac3msedn4yxed"</span><span class="p">,</span> <span class="s">"Monto de cargo devuelto"</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="kd">var</span> <span class="nx">refundRequest</span> <span class="o">=</span> <span class="p">{</span>
   <span class="s1">'description'</span> <span class="err">:</span> <span class="s1">'devoluciÃ³n'</span>
<span class="p">};</span>

<span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">charges</span><span class="p">.</span><span class="nx">refund</span><span class="p">(</span><span class="s1">'ag4nktpdzebjiye1tlze'</span><span class="p">,</span> <span class="s1">'tryqihxac3msedn4yxed'</span><span class="p">,</span> <span class="nx">refundRequest</span><span class="p">,</span> 
    <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">charge</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// ...
</span><span class="p">});</span>
</pre><pre class="highlight ruby"><span class="vi">@openpay</span><span class="o">=</span><span class="no">OpenpayApi</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"moiep6umtcnanql3jrxp"</span><span class="p">,</span><span class="s2">"sk_3433941e467c4875b178ce26348b0fac"</span><span class="p">)</span>
<span class="vi">@charges</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:charges</span><span class="p">)</span>

<span class="n">request_hash</span><span class="o">=</span><span class="p">{</span>
     <span class="s2">"description"</span> <span class="o">=&gt;</span> <span class="s2">"Monto de cargo devuelto"</span>
   <span class="p">}</span>

<span class="n">response_hash</span><span class="o">=</span><span class="vi">@charges</span><span class="p">.</span><span class="nf">refund</span><span class="p">(</span><span class="s2">"tryqihxac3msedn4yxed"</span><span class="p">,</span> <span class="n">request_hash</span><span class="p">.</span><span class="nf">to_hash</span><span class="p">,</span> <span class="s2">"ag4nktpdzebjiye1tlze"</span><span class="p">)</span>
</pre>
<blockquote>
<p>Response example</p>
</blockquote>
<pre class="highlight json"><span class="p">{</span><span class="w">
   </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"tr6cxbcefzatd10guvvw"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"amount"</span><span class="p">:</span><span class="mf">100.00</span><span class="p">,</span><span class="w">
   </span><span class="s2">"authorization"</span><span class="p">:</span><span class="s2">"801585"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"method"</span><span class="p">:</span><span class="s2">"card"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"operation_type"</span><span class="p">:</span><span class="s2">"in"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"transaction_type"</span><span class="p">:</span><span class="s2">"charge"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"card"</span><span class="p">:{</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"debit"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"brand"</span><span class="p">:</span><span class="s2">"visa"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"address"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"card_number"</span><span class="p">:</span><span class="s2">"411111XXXXXX1111"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"holder_name"</span><span class="p">:</span><span class="s2">"Juan Perez Ramirez"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"expiration_year"</span><span class="p">:</span><span class="s2">"20"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"expiration_month"</span><span class="p">:</span><span class="s2">"12"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"allows_charges"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="s2">"allows_payouts"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="s2">"bank_name"</span><span class="p">:</span><span class="s2">"Banamex"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"bank_code"</span><span class="p">:</span><span class="s2">"002"</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="s2">"status"</span><span class="p">:</span><span class="s2">"completed"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"refund"</span><span class="p">:{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"trcbsmjkroqmjobxqhpb"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"amount"</span><span class="p">:</span><span class="mf">100.00</span><span class="p">,</span><span class="w">
      </span><span class="s2">"authorization"</span><span class="p">:</span><span class="s2">"801585"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"method"</span><span class="p">:</span><span class="s2">"card"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"operation_type"</span><span class="p">:</span><span class="s2">"out"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"transaction_type"</span><span class="p">:</span><span class="s2">"refund"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"status"</span><span class="p">:</span><span class="s2">"completed"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"currency"</span><span class="p">:</span><span class="s2">"MXN"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="s2">"2014-05-26T13:56:21-05:00"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"operation_date"</span><span class="p">:</span><span class="s2">"2014-05-26T13:56:21-05:00"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"description"</span><span class="p">:</span><span class="s2">"devolucion"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"error_message"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"order_id"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"customer_id"</span><span class="p">:</span><span class="s2">"ag4nktpdzebjiye1tlze"</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="s2">"currency"</span><span class="p">:</span><span class="s2">"MXN"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="s2">"2014-05-26T11:56:25-05:00"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"operation_date"</span><span class="p">:</span><span class="s2">"2014-05-26T11:56:25-05:00"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"description"</span><span class="p">:</span><span class="s2">"Cargo inicial a mi cuenta"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"error_message"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
   </span><span class="s2">"order_id"</span><span class="p">:</span><span class="s2">"oid-00052"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"customer_id"</span><span class="p">:</span><span class="s2">"ag4nktpdzebjiye1tlze"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<p>You can use this method f you want to make a charge refund to a card. The amount to be returned will be the total charge. Note that the refund may be delayed in the statement of your customer for 1-3 business days.</p>

<p><aside class="notice">
<strong>Note:</strong> Only charges via card can be refunded.
</aside></p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>description</td>
<td><strong><em>string</em></strong> (optional, length = 250) <br/>Text to describe the refund reason.</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<p>Returns a <a href="#transaction-object">transaction object</a> with the charge information or with an <a href="#error-object">error response</a>.</p>

<h2 id="get-a-charge">Get a charge</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell">Merchant
GET https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/charges/<span class="o">{</span>TRANSACTION_ID<span class="o">}</span>

Merchant
GET https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/customers/<span class="o">{</span>CUSTOMER_ID<span class="o">}</span>/charges/<span class="o">{</span>TRANSACTION_ID<span class="o">}</span>
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nx">Merchant</span>
<span class="nv">$charge</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">charges</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">transactionId</span><span class="p">);</span>

<span class="nx">Customer</span>
<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">customerId</span><span class="p">);</span>
<span class="nv">$charge</span> <span class="o">=</span> <span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">charges</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">transactionId</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="c1">//Customer</span>
<span class="n">openpayAPI</span><span class="o">.</span><span class="na">charges</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="n">String</span> <span class="n">customerId</span><span class="o">,</span> <span class="n">String</span> <span class="n">transactionId</span><span class="o">);</span>

<span class="c1">//Merchant</span>
<span class="n">openpayAPI</span><span class="o">.</span><span class="na">charges</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="n">String</span> <span class="n">transactionId</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="c1">//Customer
</span><span class="n">openpayAPI</span><span class="p">.</span><span class="n">ChargeService</span><span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="kt">string</span> <span class="n">customer_id</span><span class="p">,</span> <span class="kt">string</span> <span class="n">transaction_id</span><span class="p">);</span>

<span class="c1">//Merchant
</span><span class="n">openpayAPI</span><span class="p">.</span><span class="n">ChargeService</span><span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="kt">string</span> <span class="n">transaction_id</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="c1">// Merchant
</span><span class="nx">openpay</span><span class="p">.</span><span class="nx">charges</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">transactionId</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>

<span class="c1">// Customer
</span><span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">charges</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">customerId</span><span class="p">,</span> <span class="nx">transactionId</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
</pre><pre class="highlight ruby"><span class="c1">#Customer</span>
<span class="vi">@charges</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:charges</span><span class="p">)</span>
<span class="vi">@charges</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">transaction_id</span><span class="p">,</span> <span class="n">customerId</span><span class="p">)</span>

<span class="c1">#Merchant</span>
<span class="vi">@charges</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:charges</span><span class="p">)</span>
<span class="vi">@charges</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">transaction_id</span><span class="p">)</span>
</pre>
<blockquote>
<p>Customer request example</p>
</blockquote>
<pre class="highlight shell">curl https://sandbox-api.openpay.mx/v1/mzdtln0bmtms6o3kck8f/customers/ag4nktpdzebjiye1tlze/charges/tr6cxbcefzatd10guvvw <span class="se">\</span>
   -u sk_e568c42a6c384b7ab02cd47d2e407cab:
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$openpay</span> <span class="o">=</span> <span class="nx">Openpay</span><span class="o">::</span><span class="na">getInstance</span><span class="p">(</span><span class="s1">'mzdtln0bmtms6o3kck8f'</span><span class="p">,</span> <span class="s1">'sk_e568c42a6c384b7ab02cd47d2e407cab'</span><span class="p">);</span>

<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'ag4nktpdzebjiye1tlze'</span><span class="p">);</span>
<span class="nv">$charge</span> <span class="o">=</span> <span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">charges</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'tr6cxbcefzatd10guvvw'</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OpenpayAPI</span><span class="o">(</span><span class="s">"https://sandbox-api.openpay.mx"</span><span class="o">,</span> <span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="o">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="o">);</span>
<span class="n">Charge</span> <span class="kt">char</span><span class="n">ge</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="na">charges</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="s">"ag4nktpdzebjiye1tlze"</span><span class="o">,</span> <span class="s">"tr6cxbcefzatd10guvvw"</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">OpenpayAPI</span><span class="p">(</span><span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="p">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="p">);</span>
<span class="n">Charge</span> <span class="n">charge</span> <span class="p">=</span> <span class="n">api</span><span class="p">.</span><span class="n">ChargeService</span><span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="s">"ag4nktpdzebjiye1tlze"</span><span class="p">,</span> <span class="s">"tryqihxac3msedn4yxed"</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">charges</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'ag4nktpdzebjiye1tlze'</span><span class="p">,</span> <span class="s1">'tr6cxbcefzatd10guvvw'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">charge</span><span class="p">){</span>
  <span class="c1">// ...
</span><span class="p">});</span>
</pre><pre class="highlight ruby"><span class="vi">@openpay</span><span class="o">=</span><span class="no">OpenpayApi</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"moiep6umtcnanql3jrxp"</span><span class="p">,</span><span class="s2">"sk_3433941e467c4875b178ce26348b0fac"</span><span class="p">)</span>
<span class="vi">@charges</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:charges</span><span class="p">)</span>

<span class="n">response_hash</span><span class="o">=</span><span class="vi">@charges</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="s2">"tr6cxbcefzatd10guvvw"</span><span class="p">,</span> <span class="s2">"ag4nktpdzebjiye1tlze"</span><span class="p">)</span>
</pre>
<blockquote>
<p>Response example</p>
</blockquote>
<pre class="highlight json"><span class="p">{</span><span class="w">
   </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"tr6cxbcefzatd10guvvw"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"amount"</span><span class="p">:</span><span class="mf">100.00</span><span class="p">,</span><span class="w">
   </span><span class="s2">"authorization"</span><span class="p">:</span><span class="s2">"801585"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"method"</span><span class="p">:</span><span class="s2">"card"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"operation_type"</span><span class="p">:</span><span class="s2">"in"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"transaction_type"</span><span class="p">:</span><span class="s2">"charge"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"card"</span><span class="p">:{</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"debit"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"brand"</span><span class="p">:</span><span class="s2">"visa"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"address"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"card_number"</span><span class="p">:</span><span class="s2">"411111XXXXXX1111"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"holder_name"</span><span class="p">:</span><span class="s2">"Juan Perez Ramirez"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"expiration_year"</span><span class="p">:</span><span class="s2">"20"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"expiration_month"</span><span class="p">:</span><span class="s2">"12"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"allows_charges"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="s2">"allows_payouts"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="s2">"bank_name"</span><span class="p">:</span><span class="s2">"Banamex"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"bank_code"</span><span class="p">:</span><span class="s2">"002"</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="s2">"status"</span><span class="p">:</span><span class="s2">"completed"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"refund"</span><span class="p">:{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"trcbsmjkroqmjobxqhpb"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"amount"</span><span class="p">:</span><span class="mf">100.00</span><span class="p">,</span><span class="w">
      </span><span class="s2">"authorization"</span><span class="p">:</span><span class="s2">"801585"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"method"</span><span class="p">:</span><span class="s2">"card"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"operation_type"</span><span class="p">:</span><span class="s2">"out"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"transaction_type"</span><span class="p">:</span><span class="s2">"refund"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"status"</span><span class="p">:</span><span class="s2">"completed"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"currency"</span><span class="p">:</span><span class="s2">"MXN"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="s2">"2014-05-26T13:56:21-05:00"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"operation_date"</span><span class="p">:</span><span class="s2">"2014-05-26T13:56:21-05:00"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"description"</span><span class="p">:</span><span class="s2">"devolucion"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"error_message"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"order_id"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"customer_id"</span><span class="p">:</span><span class="s2">"ag4nktpdzebjiye1tlze"</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="s2">"currency"</span><span class="p">:</span><span class="s2">"MXN"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="s2">"2014-05-26T11:56:25-05:00"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"operation_date"</span><span class="p">:</span><span class="s2">"2014-05-26T11:56:25-05:00"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"description"</span><span class="p">:</span><span class="s2">"Cargo inicial a mi cuenta"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"error_message"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
   </span><span class="s2">"order_id"</span><span class="p">:</span><span class="s2">"oid-00052"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"customer_id"</span><span class="p">:</span><span class="s2">"ag4nktpdzebjiye1tlze"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<p>Returns the information of a charge generated at any moment, only by knowing the charge id.</p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>transaction_id</td>
<td><em><strong>string</strong></em> (required, length = 45)<br/>Charge Id.</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<p>Returns a <a href="#transaction-object">transaction object</a> with the charge information or with an <a href="#error-object">error response</a>..</p>

<h2 id="list-of-charges">List of charges</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell">Merchant
GET https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/charges

Merchant
GET https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/customers/<span class="o">{</span>CUSTOMER_ID<span class="o">}</span>/charges
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nx">Merchant</span>
<span class="nv">$chargeList</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">charges</span><span class="o">-&gt;</span><span class="na">getList</span><span class="p">(</span><span class="nx">searchParams</span><span class="p">);</span>

<span class="nx">Customer</span>
<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">customerId</span><span class="p">);</span>
<span class="nv">$chargeList</span> <span class="o">=</span> <span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">charges</span><span class="o">-&gt;</span><span class="na">getList</span><span class="p">(</span><span class="nx">searchParams</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="c1">//Customer</span>
<span class="n">openpayAPI</span><span class="o">.</span><span class="na">charges</span><span class="o">().</span><span class="na">list</span><span class="o">(</span><span class="n">String</span> <span class="n">customerId</span><span class="o">,</span> <span class="n">SearchParams</span> <span class="n">request</span><span class="o">);</span>

<span class="c1">//Merchant</span>
<span class="n">openpayAPI</span><span class="o">.</span><span class="na">charges</span><span class="o">().</span><span class="na">list</span><span class="o">(</span><span class="n">SearchParams</span> <span class="n">request</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="c1">//Customer
</span><span class="n">openpayAPI</span><span class="p">.</span><span class="n">ChargeService</span><span class="p">.</span><span class="nf">List</span><span class="p">(</span><span class="kt">string</span> <span class="n">customer_id</span><span class="p">,</span> <span class="n">SearchParams</span> <span class="n">request</span> <span class="p">=</span> <span class="k">null</span><span class="p">);</span>

<span class="c1">//Merchant
</span><span class="n">openpayAPI</span><span class="p">.</span><span class="n">ChargeService</span><span class="p">.</span><span class="nf">List</span><span class="p">(</span><span class="n">SearchParams</span> <span class="n">request</span> <span class="p">=</span> <span class="k">null</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="c1">// Merchant
</span><span class="nx">openpay</span><span class="p">.</span><span class="nx">charges</span><span class="p">.</span><span class="nx">list</span><span class="p">(</span><span class="nx">callback</span><span class="p">);</span>
<span class="nx">openpay</span><span class="p">.</span><span class="nx">charges</span><span class="p">.</span><span class="nx">list</span><span class="p">(</span><span class="nx">searchParams</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>

<span class="c1">// Customer
</span><span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">charges</span><span class="p">.</span><span class="nx">list</span><span class="p">(</span><span class="nx">customerId</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
<span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">charges</span><span class="p">.</span><span class="nx">list</span><span class="p">(</span><span class="nx">customerId</span><span class="p">,</span> <span class="nx">searchParams</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
</pre><pre class="highlight ruby"><span class="c1">#Customer</span>
<span class="vi">@charges</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:charges</span><span class="p">)</span>
<span class="vi">@charges</span><span class="p">.</span><span class="nf">all</span><span class="p">(</span><span class="n">customer_id</span><span class="p">)</span>

<span class="c1">#Merchant</span>
<span class="vi">@charges</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:charges</span><span class="p">)</span>
<span class="vi">@charges</span><span class="p">.</span><span class="nf">all</span>
</pre>
<blockquote>
<p>Customer request example</p>
</blockquote>
<pre class="highlight shell">curl -g <span class="s2">"https://sandbox-api.openpay.mx/v1/mzdtln0bmtms6o3kck8f/customers/ag4nktpdzebjiye1tlze/charges?creation[gte]=2013-11-01&amp;limit=2"</span> <span class="se">\</span>
   -u sk_e568c42a6c384b7ab02cd47d2e407cab: 
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$openpay</span> <span class="o">=</span> <span class="nx">Openpay</span><span class="o">::</span><span class="na">getInstance</span><span class="p">(</span><span class="s1">'mzdtln0bmtms6o3kck8f'</span><span class="p">,</span> <span class="s1">'sk_e568c42a6c384b7ab02cd47d2e407cab'</span><span class="p">);</span>

<span class="nv">$searchParams</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'creation[gte]'</span> <span class="o">=&gt;</span> <span class="s1">'2013-11-01'</span><span class="p">,</span>
    <span class="s1">'creation[lte]'</span> <span class="o">=&gt;</span> <span class="s1">'2014-11-01'</span><span class="p">,</span>
    <span class="s1">'offset'</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">'limit'</span> <span class="o">=&gt;</span> <span class="mi">2</span><span class="p">);</span>

<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'ag4nktpdzebjiye1tlze'</span><span class="p">);</span>
<span class="nv">$chargeList</span> <span class="o">=</span> <span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">charges</span><span class="o">-&gt;</span><span class="na">getList</span><span class="p">(</span><span class="nv">$searchParams</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="kd">final</span> <span class="n">Calendar</span> <span class="n">dateGte</span> <span class="o">=</span> <span class="n">Calendar</span><span class="o">.</span><span class="na">getInstance</span><span class="o">();</span>
<span class="kd">final</span> <span class="n">Calendar</span> <span class="n">dateLte</span> <span class="o">=</span> <span class="n">Calendar</span><span class="o">.</span><span class="na">getInstance</span><span class="o">();</span>
<span class="n">dateGte</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="mi">2014</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">);</span>
<span class="n">dateLte</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="mi">2014</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">15</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">);</span>

<span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OpenpayAPI</span><span class="o">(</span><span class="s">"https://sandbox-api.openpay.mx"</span><span class="o">,</span> <span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="o">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="o">);</span>
<span class="n">SearchParams</span> <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SearchParams</span><span class="o">();</span>
<span class="n">request</span><span class="o">.</span><span class="na">creationGte</span><span class="o">(</span><span class="n">dateGte</span><span class="o">.</span><span class="na">getTime</span><span class="o">());</span>
<span class="n">request</span><span class="o">.</span><span class="na">creationLte</span><span class="o">(</span><span class="n">dateLte</span><span class="o">.</span><span class="na">getTime</span><span class="o">());</span>
<span class="n">request</span><span class="o">.</span><span class="na">offset</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">limit</span><span class="o">(</span><span class="mi">100</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">amount</span><span class="o">(</span><span class="k">new</span> <span class="n">BigDecimal</span><span class="o">(</span><span class="s">"100.00"</span><span class="o">));</span>

<span class="n">List</span><span class="o">&lt;</span><span class="n">Charge</span><span class="o">&gt;</span> <span class="kt">char</span><span class="n">ges</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="na">charges</span><span class="o">().</span><span class="na">list</span><span class="o">(</span><span class="s">"ag4nktpdzebjiye1tlze"</span><span class="o">,</span> <span class="n">request</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">OpenpayAPI</span><span class="p">(</span><span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="p">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="p">);</span>
<span class="n">SearchParams</span> <span class="n">request</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SearchParams</span><span class="p">();</span>
<span class="n">request</span><span class="p">.</span><span class="n">CreationGte</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Datetime</span><span class="p">(</span><span class="m">2014</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">1</span><span class="p">);</span>
<span class="n">request</span><span class="p">.</span><span class="n">CreationLte</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">2014</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">15</span><span class="p">);</span>
<span class="n">request</span><span class="p">.</span><span class="n">Offset</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">Limit</span> <span class="p">=</span> <span class="m">100</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">Amount</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Decimal</span><span class="p">(</span><span class="m">100.00</span><span class="p">);</span>

<span class="n">List</span><span class="p">&lt;</span><span class="n">Charge</span><span class="p">&gt;</span> <span class="n">charges</span><span class="p">=</span> <span class="n">openpayAPI</span><span class="p">.</span><span class="n">ChargeService</span><span class="p">.</span><span class="nf">List</span><span class="p">(</span><span class="s">"ag4nktpdzebjiye1tlze"</span><span class="p">,</span> <span class="n">request</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="kd">var</span> <span class="nx">searchParams</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">'creation[gte]'</span> <span class="err">:</span> <span class="s1">'2013-11-01'</span><span class="p">,</span>
  <span class="s1">'limit'</span> <span class="err">:</span> <span class="mi">2</span>
<span class="p">};</span>

<span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">charges</span><span class="p">.</span><span class="nx">list</span><span class="p">(</span><span class="s1">'ag4nktpdzebjiye1tlze'</span><span class="p">,</span><span class="nx">searchParams</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">chargeList</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// ...
</span><span class="p">});</span>
</pre><pre class="highlight ruby"><span class="vi">@openpay</span><span class="o">=</span><span class="no">OpenpayApi</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"moiep6umtcnanql3jrxp"</span><span class="p">,</span><span class="s2">"sk_3433941e467c4875b178ce26348b0fac"</span><span class="p">)</span>
<span class="vi">@charges</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:charges</span><span class="p">)</span>

<span class="n">response_hash</span><span class="o">=</span><span class="vi">@charges</span><span class="p">.</span><span class="nf">all</span><span class="p">(</span><span class="s2">"ag4nktpdzebjiye1tlze"</span><span class="p">)</span>
</pre>
<blockquote>
<p>Response example</p>
</blockquote>
<pre class="highlight json"><span class="p">[</span><span class="w">
   </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"tryqihxac3msedn4yxed"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"amount"</span><span class="p">:</span><span class="mf">100.00</span><span class="p">,</span><span class="w">
      </span><span class="s2">"authorization"</span><span class="p">:</span><span class="s2">"801585"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"method"</span><span class="p">:</span><span class="s2">"card"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"operation_type"</span><span class="p">:</span><span class="s2">"in"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"transaction_type"</span><span class="p">:</span><span class="s2">"charge"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"card"</span><span class="p">:{</span><span class="w">
         </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"debit"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"brand"</span><span class="p">:</span><span class="s2">"visa"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"address"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
         </span><span class="s2">"card_number"</span><span class="p">:</span><span class="s2">"411111XXXXXX1111"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"holder_name"</span><span class="p">:</span><span class="s2">"Juan Perez Ramirez"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"expiration_year"</span><span class="p">:</span><span class="s2">"20"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"expiration_month"</span><span class="p">:</span><span class="s2">"12"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"allows_charges"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
         </span><span class="s2">"allows_payouts"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
         </span><span class="s2">"bank_name"</span><span class="p">:</span><span class="s2">"Banamex"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"bank_code"</span><span class="p">:</span><span class="s2">"002"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"status"</span><span class="p">:</span><span class="s2">"completed"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"currency"</span><span class="p">:</span><span class="s2">"MXN"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="s2">"2014-05-26T14:00:17-05:00"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"operation_date"</span><span class="p">:</span><span class="s2">"2014-05-26T14:00:17-05:00"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"description"</span><span class="p">:</span><span class="s2">"Cargo inicial a mi cuenta"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"error_message"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"order_id"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"customer_id"</span><span class="p">:</span><span class="s2">"ag4nktpdzebjiye1tlze"</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"trnzf2xjwpupjfryyj23"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"amount"</span><span class="p">:</span><span class="mf">100.00</span><span class="p">,</span><span class="w">
      </span><span class="s2">"authorization"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"method"</span><span class="p">:</span><span class="s2">"bank_account"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"operation_type"</span><span class="p">:</span><span class="s2">"in"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"transaction_type"</span><span class="p">:</span><span class="s2">"charge"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"status"</span><span class="p">:</span><span class="s2">"in_progress"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"currency"</span><span class="p">:</span><span class="s2">"MXN"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="s2">"2014-05-26T13:51:25-05:00"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"operation_date"</span><span class="p">:</span><span class="s2">"2014-05-26T13:51:25-05:00"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"description"</span><span class="p">:</span><span class="s2">"Cargo con banco"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"error_message"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"order_id"</span><span class="p">:</span><span class="s2">"oid-00055"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"customer_id"</span><span class="p">:</span><span class="s2">"ag4nktpdzebjiye1tlze"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"payment_method"</span><span class="p">:{</span><span class="w">
         </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"bank_transfer"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"bank"</span><span class="p">:</span><span class="s2">"STP"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"clabe"</span><span class="p">:</span><span class="s2">"646180109400135624"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"name"</span><span class="p">:</span><span class="s2">"0021589"</span><span class="w">
      </span><span class="p">}</span><span class="w">
   </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></pre>
<p>Gets a list of the charges made by Merchant or customer.</p>

<h3 id="request">Request</h3>

<p>You can search using the following parameters as filters.</p>

<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>creation</td>
<td><strong><em>date</em></strong> <br/>Same as creation date. Format yyyy-mm-dd</td>
</tr>
<tr>
<td>creation[gte]</td>
<td><strong><em>date</em></strong> <br/>After the creation date. Format yyyy-mm-dd</td>
</tr>
<tr>
<td>creation[lte]</td>
<td><strong><em>date</em></strong> <br/>Before the creation date. Format yyyy-mm-dd</td>
</tr>
<tr>
<td>offset</td>
<td><strong><em>numeric</em></strong> <br/>Number of records to skip at the beginning, default 0.</td>
</tr>
<tr>
<td>limit</td>
<td><strong><em>numeric</em></strong> <br/>Number of required records, default 10.</td>
</tr>
<tr>
<td>amount</td>
<td><strong><em>numeric</em></strong> <br/>Same as the amount.</td>
</tr>
<tr>
<td>amount[gte]</td>
<td><strong><em>numeric</em></strong> <br/>Greater than or equal to the amount.</td>
</tr>
<tr>
<td>amount[lte]</td>
<td><strong><em>numeric</em></strong> <br/>Less than or equal to the amount.</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<p>Returns an array of <a href="#transaction-object">transaction objects</a> charges in descending order by creation date.</p>

<h1 id="payouts-or-withdrawals">Payouts or withdrawals</h1>

<p>A payout is the transaction that allows to extract funds from a Openpay account and send the funds to a bank account or a debit card. Payouts can be made from the accounts of the customers or from the Merchant account.</p>

<p><aside class="notice">
<strong>Note:</strong>  All payout transactions will be returned in <strong>IN_PROGRESS</strong> status meaning that it is scheduled for the next day when the operation takes place the status will change to <strong>completed</strong> and if there are configured WebHooks, a notification will be sent.
</aside></p>

<h2 id="payout-to-a-registered-id">Payout to a registered id</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell">Merchant
POST https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/payouts

Customer
POST https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/customers/<span class="o">{</span>CUSTOMER_ID<span class="o">}</span>/payouts
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nx">Customer</span>
<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">customerId</span><span class="p">);</span>
<span class="nv">$payout</span> <span class="o">=</span> <span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">payouts</span><span class="o">-&gt;</span><span class="na">create</span><span class="p">(</span><span class="nx">payoutRequest</span><span class="p">);</span>

<span class="nx">Merchant</span>
<span class="nv">$payout</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">payouts</span><span class="o">-&gt;</span><span class="na">create</span><span class="p">(</span><span class="nx">payoutRequest</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="c1">//Customer</span>
<span class="n">openpayAPI</span><span class="o">.</span><span class="na">payouts</span><span class="o">().</span><span class="na">create</span><span class="o">(</span><span class="n">String</span> <span class="n">customerId</span><span class="o">,</span> <span class="n">CreateBankPayoutParams</span> <span class="n">request</span><span class="o">);</span>

<span class="c1">//Merchant</span>
<span class="n">openpayAPI</span><span class="o">.</span><span class="na">payouts</span><span class="o">().</span><span class="na">create</span><span class="o">(</span><span class="n">CreateBankPayoutParams</span> <span class="n">request</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="c1">//Customer
</span><span class="n">openpayAPI</span><span class="p">.</span><span class="n">PayoutService</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="kt">string</span> <span class="n">customer_id</span><span class="p">,</span> <span class="n">PayoutRequest</span> <span class="n">request</span><span class="p">);</span>

<span class="c1">//Merchant
</span><span class="n">openpayAPI</span><span class="p">.</span><span class="n">PayoutService</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="n">PayoutRequest</span> <span class="n">request</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="c1">// Merchant
</span><span class="nx">openpay</span><span class="p">.</span><span class="nx">payouts</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">payoutRequest</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>

<span class="c1">// Customer
</span><span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">payouts</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">customerId</span><span class="p">,</span> <span class="nx">payoutRequest</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
</pre><pre class="highlight ruby"><span class="c1">#Customer</span>
<span class="vi">@payouts</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:payouts</span><span class="p">)</span>
<span class="vi">@payouts</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="n">request_hash</span><span class="p">,</span> <span class="n">customer_id</span><span class="p">)</span>

<span class="c1">#Merchant</span>
<span class="vi">@payouts</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:payouts</span><span class="p">)</span>
<span class="vi">@payouts</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="n">request_hash</span><span class="p">)</span>
</pre>
<blockquote>
<p>Customer request example</p>
</blockquote>
<pre class="highlight shell">curl https://sandbox-api.openpay.mx/v1/mzdtln0bmtms6o3kck8f/customers/ag4nktpdzebjiye1tlze/payouts <span class="se">\</span>
   -u sk_e568c42a6c384b7ab02cd47d2e407cab: <span class="se">\</span>
   -H <span class="s2">"Content-type: application/json"</span> <span class="se">\</span>
   -X POST -d <span class="s1">'{
    "method": "card",
    "destination_id": "k3d54sd3mdjf75udjfvoc",
    "amount": 10.50,
    "description": "Retiro de saldo semanal",
    "order_id": "oid-00021"
}'</span> 
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$openpay</span> <span class="o">=</span> <span class="nx">Openpay</span><span class="o">::</span><span class="na">getInstance</span><span class="p">(</span><span class="s1">'mzdtln0bmtms6o3kck8f'</span><span class="p">,</span> <span class="s1">'sk_e568c42a6c384b7ab02cd47d2e407cab'</span><span class="p">);</span>

<span class="nv">$payoutRequest</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'method'</span> <span class="o">=&gt;</span> <span class="s1">'card'</span><span class="p">,</span>
    <span class="s1">'destination_id'</span> <span class="o">=&gt;</span> <span class="s1">'k3d54sd3mdjf75udjfvoc'</span><span class="p">,</span>
    <span class="s1">'amount'</span> <span class="o">=&gt;</span> <span class="mi">1000</span><span class="p">,</span>
    <span class="s1">'description'</span> <span class="o">=&gt;</span> <span class="s1">'Retiro de saldo semanal'</span><span class="p">,</span>
    <span class="s1">'order_id'</span> <span class="o">=&gt;</span> <span class="s1">'ORDEN-00021'</span><span class="p">);</span>

<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'ag4nktpdzebjiye1tlze'</span><span class="p">);</span>
<span class="nv">$payout</span> <span class="o">=</span> <span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">payouts</span><span class="o">-&gt;</span><span class="na">create</span><span class="p">(</span><span class="nv">$payoutRequest</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OpenpayAPI</span><span class="o">(</span><span class="s">"https://sandbox-api.openpay.mx"</span><span class="o">,</span> <span class="s">"sk_e568c42a6c384b7ab02cd47d2e407cab"</span><span class="o">,</span> <span class="s">"mzdtln0bmtms6o3kck8f"</span><span class="o">);</span>
<span class="n">CreateBankPayoutParams</span> <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CreateBankPayoutParams</span><span class="o">();</span>
<span class="n">request</span><span class="o">.</span><span class="na">bankAccountId</span><span class="o">(</span><span class="s">"k3d54sd3mdjf75udjfvoc"</span><span class="o">);</span> <span class="c1">// = destination_id</span>
<span class="n">request</span><span class="o">.</span><span class="na">amount</span><span class="o">(</span><span class="k">new</span> <span class="n">BigDecimal</span><span class="o">(</span><span class="s">"10.50"</span><span class="o">));</span>
<span class="n">request</span><span class="o">.</span><span class="na">description</span><span class="o">(</span><span class="s">"Retiro de saldo semanal"</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">orderId</span><span class="o">(</span><span class="s">"oid-00021"</span><span class="o">);</span>

<span class="n">Payout</span> <span class="n">payout</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="na">payouts</span><span class="o">().</span><span class="na">create</span><span class="o">(</span><span class="s">"ag4nktpdzebjiye1tlze"</span><span class="o">,</span> <span class="n">request</span><span class="o">);</span>
<span class="c1">// Para crear pagos a tarjetas se deberÃ¡ usar la clase CreateCardPayoutParams</span>
</pre><pre class="highlight csharp"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">OpenpayAPI</span><span class="p">(</span><span class="s">"sk_e568c42a6c384b7ab02cd47d2e407cab"</span><span class="p">,</span> <span class="s">"mzdtln0bmtms6o3kck8f"</span><span class="p">);</span>
<span class="n">PayoutRequest</span> <span class="n">request</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">PayoutRequest</span><span class="p">();</span>
<span class="n">request</span><span class="p">.</span><span class="n">Method</span> <span class="p">=</span> <span class="s">"bank_account"</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">DestinationId</span> <span class="p">=</span> <span class="s">"k3d54sd3mdjf75udjfvoc"</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">Amount</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Decimal</span><span class="p">(</span><span class="m">10.50</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">Description</span> <span class="p">=</span> <span class="s">"Retiro de saldo semanal"</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">OrderId</span> <span class="p">=</span> <span class="s">"oid-00021;
</span>
<span class="n">Payout</span> <span class="p">=</span> <span class="n">api</span><span class="p">.</span><span class="n">PayoutService</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="s">"ag4nktpdzebjiye1tlze"</span><span class="p">,</span> <span class="n">request</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="kd">var</span> <span class="nx">payoutRequest</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'method'</span><span class="err">:</span> <span class="s1">'card'</span><span class="p">,</span>
    <span class="s1">'destination_id'</span><span class="err">:</span> <span class="s1">'k3d54sd3mdjf75udjfvoc'</span><span class="p">,</span>
    <span class="s1">'amount'</span><span class="err">:</span> <span class="mf">10.50</span><span class="p">,</span>
    <span class="s1">'description'</span><span class="err">:</span> <span class="s1">'Retiro de saldo semanal'</span><span class="p">,</span>
    <span class="s1">'order_id'</span><span class="err">:</span> <span class="s1">'oid-00021'</span>
<span class="p">};</span>

<span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">payouts</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="s1">'ag4nktpdzebjiye1tlze'</span><span class="p">,</span> <span class="nx">payoutRequest</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">payout</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// ...
</span><span class="p">});</span>
</pre><pre class="highlight ruby"><span class="vi">@openpay</span><span class="o">=</span><span class="no">OpenpayApi</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"mzdtln0bmtms6o3kck8f"</span><span class="p">,</span><span class="s2">"sk_e568c42a6c384b7ab02cd47d2e407cab"</span><span class="p">)</span>
<span class="vi">@payouts</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:payouts</span><span class="p">)</span>
<span class="n">request_hash</span><span class="o">=</span><span class="p">{</span>
     <span class="s2">"method"</span> <span class="o">=&gt;</span> <span class="s2">"bank_account"</span><span class="p">,</span>
     <span class="s2">"destination_id"</span> <span class="o">=&gt;</span> <span class="s2">"k3d54sd3mdjf75udjfvoc"</span><span class="p">,</span>   
     <span class="s2">"amount"</span> <span class="o">=&gt;</span> <span class="mi">10</span><span class="o">.</span><span class="mi">50</span><span class="p">,</span>
     <span class="s2">"description"</span> <span class="o">=&gt;</span> <span class="s2">"Retiro de saldo semanal"</span><span class="p">,</span>
     <span class="s2">"order_id"</span> <span class="o">=&gt;</span> <span class="s2">"oid-00021"</span>
   <span class="p">}</span>

<span class="n">response_hash</span><span class="o">=</span><span class="vi">@payouts</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="n">request_hash</span><span class="p">.</span><span class="nf">to_hash</span><span class="p">,</span> <span class="s2">"ag4nktpdzebjiye1tlze"</span><span class="p">)</span>
</pre>
<blockquote>
<p>Response example</p>
</blockquote>
<pre class="highlight json"><span class="p">{</span><span class="w">
   </span><span class="s2">"amount"</span><span class="p">:</span><span class="mf">10.5</span><span class="p">,</span><span class="w">
   </span><span class="s2">"authorization"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
   </span><span class="s2">"method"</span><span class="p">:</span><span class="s2">"card"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"currency"</span><span class="p">:</span><span class="s2">"MXN"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"operation_type"</span><span class="p">:</span><span class="s2">"out"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"transaction_type"</span><span class="p">:</span><span class="s2">"payout"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"card"</span><span class="p">:{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"k3d54sd3mdjf75udjfvoc"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"debit"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"brand"</span><span class="p">:</span><span class="s2">"visa"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"address"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"card_number"</span><span class="p">:</span><span class="s2">"411111XXXXXX1111"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"holder_name"</span><span class="p">:</span><span class="s2">"Juan Perez Ramirez"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"expiration_year"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"expiration_month"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"allows_payouts"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="s2">"allows_charges"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="s2">"2013-11-15T13:42:00-06:00"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"bank_name"</span><span class="p">:</span><span class="s2">"BANCOMER"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"bank_code"</span><span class="p">:</span><span class="s2">"012"</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="s2">"status"</span><span class="p">:</span><span class="s2">"in_progress"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"tm50pl40gf6awvalw1ei"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="s2">"2013-11-15T13:42:00-06:00"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"description"</span><span class="p">:</span><span class="s2">"Retiro de saldo semanal"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"error_message"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
   </span><span class="s2">"order_id"</span><span class="p">:</span><span class="s2">"oid-00021"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"customer_id"</span><span class="p">:</span><span class="s2">"aayr5jjb1fln44yautef"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<p>Sends a payout to a bank account or debit card previously registered. Refer to <a href="#create-a-bank-account">create a bank account</a></p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>method</td>
<td><strong><em>string</em></strong> (required) <br/>It must contain the <strong>card</strong> value in order to a make payout to a registered card, and the <strong>bank_account</strong> for the payout to a registered bank account.</td>
</tr>
<tr>
<td>destination_id</td>
<td><strong><em>string</em></strong> (required, length = 45) <br/>ID of the bank account and registered the debit card.</td>
</tr>
<tr>
<td>amount</td>
<td><strong><em>numeric</em></strong> (required) <br/>Amount of payout. Must be an amount greater than zero, with up to two decimal digits.</td>
</tr>
<tr>
<td>description</td>
<td><strong><em>string</em></strong> (required, length = 250) <br/>A description associated to the payment.</td>
</tr>
<tr>
<td>order_id</td>
<td><strong><em>string</em></strong> (optional, length = 100) <br/>Unique identifier of payout. Must be unique among all transactions.</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<p>Returns a <a href="#transaction-object">transaction object</a> with the payout information or with an <a href="#error-object">error response</a>.</p>

<h2 id="pament-to-a-bank-account">Pament to a bank account</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell">Merchant
POST https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/payouts

Customer
POST https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/customers/<span class="o">{</span>CUSTOMER_ID<span class="o">}</span>/payouts
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nx">Customer</span>
<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">customerId</span><span class="p">);</span>
<span class="nv">$payout</span> <span class="o">=</span> <span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">payouts</span><span class="o">-&gt;</span><span class="na">create</span><span class="p">(</span><span class="nx">payoutRequest</span><span class="p">);</span>

<span class="nx">Merchant</span>
<span class="nv">$payout</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">payouts</span><span class="o">-&gt;</span><span class="na">create</span><span class="p">(</span><span class="nx">payoutRequest</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="c1">//Customere</span>
<span class="n">openpayAPI</span><span class="o">.</span><span class="na">payouts</span><span class="o">().</span><span class="na">create</span><span class="o">(</span><span class="n">String</span> <span class="n">customerId</span><span class="o">,</span> <span class="n">CreateBankPayoutParams</span> <span class="n">request</span><span class="o">);</span>

<span class="c1">//Comercio</span>
<span class="n">openpayAPI</span><span class="o">.</span><span class="na">payouts</span><span class="o">().</span><span class="na">create</span><span class="o">(</span><span class="n">CreateBankPayoutParams</span> <span class="n">request</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="c1">//Customer
</span><span class="n">openpayAPI</span><span class="p">.</span><span class="n">PayoutService</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="kt">string</span> <span class="n">customer_id</span><span class="p">,</span> <span class="n">PayoutRequest</span> <span class="n">request</span><span class="p">);</span>

<span class="c1">//Merchant
</span><span class="n">openpayAPI</span><span class="p">.</span><span class="n">PayoutService</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="n">PayoutRequest</span> <span class="n">request</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="c1">// Merchant
</span><span class="nx">openpay</span><span class="p">.</span><span class="nx">payouts</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">payoutRequest</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>

<span class="c1">// Customer
</span><span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">payouts</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">customerId</span><span class="p">,</span> <span class="nx">payoutRequest</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
</pre><pre class="highlight ruby"><span class="c1">#Customer</span>
<span class="vi">@payouts</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:payouts</span><span class="p">)</span>
<span class="vi">@payouts</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="n">request_hash</span><span class="p">,</span> <span class="n">customer_id</span><span class="p">)</span>

<span class="c1">#Merchant</span>
<span class="vi">@payouts</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:payouts</span><span class="p">)</span>
<span class="vi">@payouts</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="n">request_hash</span><span class="p">)</span>
</pre>
<blockquote>
<p>Customer request example</p>
</blockquote>
<pre class="highlight shell">curl https://sandbox-api.openpay.mx/v1/mzdtln0bmtms6o3kck8f/customers/asynwirguzkgq2bizogo/payouts <span class="se">\</span>
   -u sk_e568c42a6c384b7ab02cd47d2e407cab: <span class="se">\</span>
   -H <span class="s2">"Content-type: application/json"</span> <span class="se">\</span>
   -X POST -d <span class="s1">'{
   "method":"bank_account",
   "bank_account":{
      "clabe":"012298026516924616",
      "holder_name":"Mi empresa"
   },
   "amount":100.00,
   "description":"Retiro de saldo semanal",
   "order_id":"oid-1110011"
}'</span> 
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$openpay</span> <span class="o">=</span> <span class="nx">Openpay</span><span class="o">::</span><span class="na">getInstance</span><span class="p">(</span><span class="s1">'mzdtln0bmtms6o3kck8f'</span><span class="p">,</span> <span class="s1">'sk_e568c42a6c384b7ab02cd47d2e407cab'</span><span class="p">);</span>

<span class="nv">$payoutRequest</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'method'</span> <span class="o">=&gt;</span> <span class="s1">'bank_account'</span><span class="p">,</span>
    <span class="s1">'bank_account'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'clabe'</span> <span class="o">=&gt;</span> <span class="s1">'012298026516924616'</span><span class="p">,</span>
        <span class="s1">'holder_name'</span> <span class="o">=&gt;</span> <span class="s1">'Mi empresa'</span><span class="p">),</span>
    <span class="s1">'amount'</span> <span class="o">=&gt;</span> <span class="mf">100.00</span><span class="p">,</span>
    <span class="s1">'description'</span> <span class="o">=&gt;</span> <span class="s1">'Retiro de saldo semanal'</span><span class="p">,</span>
    <span class="s1">'order_id'</span> <span class="o">=&gt;</span> <span class="s1">'ORDEN-00021'</span><span class="p">);</span>

<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'asynwirguzkgq2bizogo'</span><span class="p">);</span>
<span class="nv">$payout</span> <span class="o">=</span> <span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">payouts</span><span class="o">-&gt;</span><span class="na">create</span><span class="p">(</span><span class="nv">$payoutRequest</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OpenpayAPI</span><span class="o">(</span><span class="s">"https://sandbox-api.openpay.mx"</span><span class="o">,</span> <span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="o">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="o">);</span>
<span class="n">CreateBankPayoutParams</span> <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CreateBankPayoutParams</span><span class="o">();</span>
<span class="n">BankAccount</span> <span class="n">bankAccount</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BankAccount</span><span class="o">();</span>
<span class="n">bankAccount</span><span class="o">.</span><span class="na">holderName</span><span class="o">(</span><span class="s">"Mi empresa"</span><span class="o">);</span>
<span class="n">bankAccount</span><span class="o">.</span><span class="na">alias</span><span class="o">(</span><span class="kc">null</span><span class="o">);</span>
<span class="n">bankAccount</span><span class="o">.</span><span class="na">clabe</span><span class="o">(</span><span class="s">"012XXXXXXXXXX24616"</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">bankAccount</span><span class="o">(</span><span class="n">bankAccount</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">amount</span><span class="o">(</span><span class="k">new</span> <span class="n">BigDecimal</span><span class="o">(</span><span class="s">"10.50"</span><span class="o">));</span>
<span class="n">request</span><span class="o">.</span><span class="na">description</span><span class="o">(</span><span class="s">"Retiro de saldo semanal"</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">orderId</span><span class="o">(</span><span class="s">"oid-1110011"</span><span class="o">);</span>

<span class="n">Payout</span> <span class="n">payout</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="na">payouts</span><span class="o">().</span><span class="na">create</span><span class="o">(</span><span class="s">"ag4nktpdzebjiye1tlze"</span><span class="o">,</span> <span class="n">request</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">OpenpayAPI</span><span class="p">(</span><span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="p">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="p">);</span>
<span class="n">PayoutRequest</span> <span class="n">request</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">PayoutRequest</span><span class="p">();</span>
<span class="n">request</span><span class="p">.</span><span class="n">Method</span> <span class="p">=</span> <span class="s">"bank_account"</span><span class="p">;</span>
<span class="n">BankAccount</span> <span class="n">bankAccount</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">BankAccount</span><span class="p">();</span>
<span class="n">bankAccount</span><span class="p">.</span><span class="n">HolderName</span> <span class="p">=</span> <span class="s">"Mi empresa"</span><span class="p">;</span>
<span class="n">bankAccount</span><span class="p">.</span><span class="n">Alias</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
<span class="n">bankAccount</span><span class="p">.</span><span class="n">CLABE</span> <span class="p">=</span> <span class="s">"012XXXXXXXXXX24616"</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">BankAccount</span> <span class="p">=</span> <span class="n">bankAccount</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">Amount</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Decimal</span><span class="p">(</span><span class="m">10.50</span><span class="p">);</span>
<span class="n">request</span><span class="p">.</span><span class="n">Description</span> <span class="p">=</span> <span class="s">"Retiro de saldo semanal"</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">OrderId</span> <span class="p">=</span> <span class="s">"oid-1110011"</span><span class="p">;</span>

<span class="n">Payout</span> <span class="p">=</span> <span class="n">api</span><span class="p">.</span><span class="n">PayoutService</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="s">"ag4nktpdzebjiye1tlze"</span><span class="p">,</span> <span class="n">request</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="kd">var</span> <span class="nx">payoutRequest</span> <span class="o">=</span> <span class="p">{</span>
   <span class="s1">'method'</span><span class="err">:</span><span class="s1">'bank_account'</span><span class="p">,</span>
   <span class="s1">'bank_account'</span><span class="err">:</span><span class="p">{</span>
      <span class="s1">'clabe'</span><span class="err">:</span><span class="s1">'012298026516924616'</span><span class="p">,</span>
      <span class="s1">'holder_name'</span><span class="err">:</span><span class="s1">'Mi empresa'</span>
   <span class="p">},</span>
   <span class="s1">'amount'</span><span class="err">:</span><span class="mf">10.50</span><span class="p">,</span>
   <span class="s1">'description'</span><span class="err">:</span><span class="s1">'Retiro de saldo semanal'</span><span class="p">,</span>
   <span class="s1">'order_id'</span><span class="err">:</span><span class="s1">'oid-1110011'</span>
<span class="p">};</span>

<span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">payouts</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="s1">'ag4nktpdzebjiye1tlze'</span><span class="p">,</span> <span class="nx">payoutRequest</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">payout</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// ...
</span><span class="p">});</span>
</pre><pre class="highlight ruby"><span class="vi">@openpay</span><span class="o">=</span><span class="no">OpenpayApi</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"mzdtln0bmtms6o3kck8f"</span><span class="p">,</span><span class="s2">"sk_e568c42a6c384b7ab02cd47d2e407cab"</span><span class="p">)</span>
<span class="vi">@payouts</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:payouts</span><span class="p">)</span>
<span class="n">bank_account_hash</span><span class="o">=</span><span class="p">{</span>
     <span class="s2">"holder_name"</span> <span class="o">=&gt;</span> <span class="s2">"Mi empresa"</span><span class="p">,</span>
     <span class="s2">"alias"</span> <span class="o">=&gt;</span> <span class="kp">nil</span><span class="p">,</span>
     <span class="s2">"clabe"</span> <span class="o">=&gt;</span> <span class="s2">"012XXXXXXXXXX24616"</span>
   <span class="p">}</span>
<span class="n">request_hash</span><span class="o">=</span><span class="p">{</span>
     <span class="s2">"method"</span> <span class="o">=&gt;</span> <span class="s2">"bank_account"</span><span class="p">,</span>
     <span class="s2">"bank_account"</span> <span class="o">=&gt;</span> <span class="n">bank_account_hash</span><span class="p">,</span>
     <span class="s2">"amount"</span> <span class="o">=&gt;</span> <span class="mi">10</span><span class="o">.</span><span class="mi">50</span><span class="p">,</span>
     <span class="s2">"description"</span> <span class="o">=&gt;</span> <span class="s2">"Retiro de saldo semanal"</span><span class="p">,</span>
     <span class="s2">"order_id"</span> <span class="o">=&gt;</span> <span class="s2">"oid-1110011"</span>
   <span class="p">}</span>

<span class="n">response_hash</span><span class="o">=</span><span class="vi">@payouts</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="n">request_hash</span><span class="p">.</span><span class="nf">to_hash</span><span class="p">,</span> <span class="s2">"ag4nktpdzebjiye1tlze"</span><span class="p">)</span>
</pre>
<blockquote>
<p>Response example</p>
</blockquote>
<pre class="highlight json"><span class="p">{</span><span class="w">
   </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"tr4f2atubqchinw71vfs"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"amount"</span><span class="p">:</span><span class="mf">10.50</span><span class="p">,</span><span class="w">
   </span><span class="s2">"authorization"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
   </span><span class="s2">"method"</span><span class="p">:</span><span class="s2">"bank_account"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"operation_type"</span><span class="p">:</span><span class="s2">"out"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"transaction_type"</span><span class="p">:</span><span class="s2">"payout"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"status"</span><span class="p">:</span><span class="s2">"in_progress"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"currency"</span><span class="p">:</span><span class="s2">"MXN"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="s2">"2014-05-26T17:23:03-05:00"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"operation_date"</span><span class="p">:</span><span class="s2">"2014-05-26T17:23:03-05:00"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"description"</span><span class="p">:</span><span class="s2">"Retiro de saldo semanal"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"error_message"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
   </span><span class="s2">"order_id"</span><span class="p">:</span><span class="s2">"oid-1110011"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"bank_account"</span><span class="p">:{</span><span class="w">
      </span><span class="s2">"clabe"</span><span class="p">:</span><span class="s2">"012XXXXXXXXXX24616"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"bank_code"</span><span class="p">:</span><span class="s2">"012"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"bank_name"</span><span class="p">:</span><span class="s2">"BANCOMER"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"alias"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"holder_name"</span><span class="p">:</span><span class="s2">"Mi empresa"</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="s2">"customer_id"</span><span class="p">:</span><span class="s2">"asynwirguzkgq2bizogo"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<p>Sends a payment to a bank account.</p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>method</td>
<td><strong><em>string</em></strong> (required) <br/>It must contain the <strong>bank_account</strong> value.</td>
</tr>
<tr>
<td>bank_account</td>
<td><strong><em>object</em></strong> (required) <br/>Data of the bank account where the funds will be sent. <br/><br/> <strong>clabe</strong>.- CLABE account number where the funds will be sent. <br/><strong>holder_name</strong>.- Name of the account owner .</td>
</tr>
<tr>
<td>amount</td>
<td><strong><em>numeric</em></strong> (required) <br/>Amount of payout. Must be an amount greater than zero, with up to two decimal digits.</td>
</tr>
<tr>
<td>description</td>
<td><strong><em>string</em></strong> (required, length = 250) <br/>A description associated to the payment.</td>
</tr>
<tr>
<td>order_id</td>
<td><strong><em>string</em></strong> (optional, length = 100) <br/>Unique identifier of payout. Must be unique among all transactions.</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<p>Returns a <a href="#transaction-object">transaction object</a> with the payout information or with an <a href="#error-object">error response</a>.</p>

<h2 id="payout-to-a-debit-card.">Payout to a debit card.</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell">Merchant
POST https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/payouts

Customer
POST https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/customers/<span class="o">{</span>CUSTOMER_ID<span class="o">}</span>/payouts
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nx">Customer</span>
<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">customerId</span><span class="p">);</span>
<span class="nv">$payout</span> <span class="o">=</span> <span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">payouts</span><span class="o">-&gt;</span><span class="na">create</span><span class="p">(</span><span class="nx">payoutRequest</span><span class="p">);</span>

<span class="nx">Merchant</span>
<span class="nv">$payout</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">payouts</span><span class="o">-&gt;</span><span class="na">create</span><span class="p">(</span><span class="nx">payoutRequest</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="c1">//Customer</span>
<span class="n">openpayAPI</span><span class="o">.</span><span class="na">payouts</span><span class="o">().</span><span class="na">create</span><span class="o">(</span><span class="n">String</span> <span class="n">customerId</span><span class="o">,</span> <span class="n">CreateCardPayoutParams</span> <span class="n">request</span><span class="o">);</span>

<span class="c1">//Merchant</span>
<span class="n">openpayAPI</span><span class="o">.</span><span class="na">payouts</span><span class="o">().</span><span class="na">create</span><span class="o">(</span><span class="n">CreateCardPayoutParams</span> <span class="n">request</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="c1">//Customer
</span><span class="n">openpayAPI</span><span class="p">.</span><span class="n">PayoutService</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="kt">string</span> <span class="n">customer_id</span><span class="p">,</span> <span class="n">PayoutRequest</span> <span class="n">request</span><span class="p">);</span>

<span class="c1">//Merchant
</span><span class="n">openpayAPI</span><span class="p">.</span><span class="n">PayoutService</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="n">PayoutRequest</span> <span class="n">request</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="c1">// Merchant
</span><span class="nx">openpay</span><span class="p">.</span><span class="nx">payouts</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">payoutRequest</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>

<span class="c1">// Customer
</span><span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">payouts</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">customerId</span><span class="p">,</span> <span class="nx">payoutRequest</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
</pre><pre class="highlight ruby"><span class="c1">#Customer</span>
<span class="vi">@payouts</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:payouts</span><span class="p">)</span>
<span class="vi">@payouts</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="n">request_hash</span><span class="p">,</span> <span class="n">customer_id</span><span class="p">)</span>

<span class="c1">#Merchant</span>
<span class="vi">@payouts</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:payouts</span><span class="p">)</span>
<span class="vi">@payouts</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="n">request_hash</span><span class="p">)</span>
</pre>
<blockquote>
<p>Customer request example</p>
</blockquote>
<pre class="highlight shell">curl https://sandbox-api.openpay.mx/v1/mzdtln0bmtms6o3kck8f/customers/asynwirguzkgq2bizogo/payouts <span class="se">\</span>
   -u sk_e568c42a6c384b7ab02cd47d2e407cab: <span class="se">\</span>
   -H <span class="s2">"Content-type: application/json"</span> <span class="se">\</span>
   -X POST -d <span class="s1">'{
   "method": "card",
   "card": {
      "card_number": "4111111111111111",
      "holder_name": "Juan Perez Ramirez"
   },
   "amount" : 100.00,
   "description" : "Retiro de saldo semanal",
   "order_id" : "ORDEN-00021"
} '</span> 
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$openpay</span> <span class="o">=</span> <span class="nx">Openpay</span><span class="o">::</span><span class="na">getInstance</span><span class="p">(</span><span class="s1">'mzdtln0bmtms6o3kck8f'</span><span class="p">,</span> <span class="s1">'sk_e568c42a6c384b7ab02cd47d2e407cab'</span><span class="p">);</span>

<span class="nv">$payoutRequest</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'method'</span> <span class="o">=&gt;</span> <span class="s1">'card'</span><span class="p">,</span>
    <span class="s1">'card'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'card_number'</span> <span class="o">=&gt;</span> <span class="s1">'4111111111111111'</span><span class="p">,</span>
        <span class="s1">'holder_name'</span> <span class="o">=&gt;</span> <span class="s1">'Juan Perez Ramirez'</span><span class="p">),</span>
    <span class="s1">'amount'</span> <span class="o">=&gt;</span> <span class="mf">100.00</span><span class="p">,</span>
    <span class="s1">'description'</span> <span class="o">=&gt;</span> <span class="s1">'Retiro de saldo semanal'</span><span class="p">,</span>
    <span class="s1">'order_id'</span> <span class="o">=&gt;</span> <span class="s1">'ORDEN-00021'</span><span class="p">);</span>

<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'asynwirguzkgq2bizogo'</span><span class="p">);</span>
<span class="nv">$payout</span> <span class="o">=</span> <span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">payouts</span><span class="o">-&gt;</span><span class="na">create</span><span class="p">(</span><span class="nv">$payoutRequest</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OpenpayAPI</span><span class="o">(</span><span class="s">"https://sandbox-api.openpay.mx"</span><span class="o">,</span> <span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="o">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="o">);</span>
<span class="n">CreateCardPayoutParams</span> <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CreateCardPayoutParams</span><span class="o">();</span>
<span class="n">Card</span> <span class="n">card</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Card</span><span class="o">();</span>
<span class="n">card</span><span class="o">.</span><span class="na">holderName</span><span class="o">(</span><span class="s">"Juan Perez Ramirez"</span><span class="o">);</span>
<span class="n">card</span><span class="o">.</span><span class="na">cardNumber</span><span class="o">(</span><span class="s">"4111111111111111"</span><span class="o">);</span>
<span class="n">card</span><span class="o">.</span><span class="na">cvv2</span><span class="o">(</span><span class="s">"110"</span><span class="o">);</span>
<span class="n">card</span><span class="o">.</span><span class="na">expirationMonth</span><span class="o">(</span><span class="mi">12</span><span class="o">);</span>
<span class="n">card</span><span class="o">.</span><span class="na">expirationYear</span><span class="o">(</span><span class="mi">20</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">card</span><span class="o">(</span><span class="n">card</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">amount</span><span class="o">(</span><span class="k">new</span> <span class="n">BigDecimal</span><span class="o">(</span><span class="s">"100.00"</span><span class="o">));</span>
<span class="n">request</span><span class="o">.</span><span class="na">description</span><span class="o">(</span><span class="s">"Pago a cuenta de banco"</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">orderId</span><span class="o">(</span><span class="s">"ord-103"</span><span class="o">);</span>

<span class="n">Payout</span> <span class="n">payout</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="na">payouts</span><span class="o">().</span><span class="na">create</span><span class="o">(</span><span class="s">"ag4nktpdzebjiye1tlze"</span><span class="o">,</span> <span class="n">request</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">OpenpayAPI</span><span class="p">(</span><span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="p">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="p">);</span>
<span class="n">PayoutRequest</span> <span class="n">request</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">PayoutRequest</span><span class="p">();</span>
<span class="n">request</span><span class="p">.</span><span class="n">Method</span> <span class="p">=</span> <span class="s">"card"</span><span class="p">;</span>
<span class="n">Card</span> <span class="n">card</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Card</span><span class="p">();</span>
<span class="n">card</span><span class="p">.</span><span class="n">HolderName</span> <span class="p">=</span> <span class="s">"Juan Perez Ramirez"</span><span class="p">;</span>
<span class="n">card</span><span class="p">.</span><span class="n">CardNumber</span> <span class="p">=</span> <span class="s">"4111111111111111"</span><span class="p">;</span>
<span class="n">card</span><span class="p">.</span><span class="n">Cvv2</span> <span class="p">=</span> <span class="s">"110"</span><span class="p">;</span>
<span class="n">card</span><span class="p">.</span><span class="n">ExpirationMonth</span> <span class="p">=</span> <span class="s">"12"</span><span class="p">;</span>
<span class="n">card</span><span class="p">.</span><span class="n">ExpirationYear</span> <span class="p">=</span> <span class="s">"20"</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">Card</span> <span class="p">=</span> <span class="n">card</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">Amount</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Decimal</span><span class="p">(</span><span class="m">100.00</span><span class="p">);</span>
<span class="n">request</span><span class="p">.</span><span class="n">Description</span> <span class="p">=</span> <span class="s">"Pago a cuenta de banco"</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">OrderId</span> <span class="p">=</span> <span class="s">"ord-101"</span><span class="p">;</span>

<span class="n">Payout</span> <span class="p">=</span> <span class="n">api</span><span class="p">.</span><span class="n">PayoutService</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="s">"ag4nktpdzebjiye1tlze"</span><span class="p">,</span> <span class="n">request</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="kd">var</span> <span class="nx">payoutRequest</span> <span class="o">=</span> <span class="p">{</span>
   <span class="s1">'method'</span><span class="err">:</span> <span class="s1">'card'</span><span class="p">,</span>
   <span class="s1">'card'</span><span class="err">:</span> <span class="p">{</span>
      <span class="s1">'card_number'</span><span class="err">:</span> <span class="s1">'4111111111111111'</span><span class="p">,</span>
      <span class="s1">'holder_name'</span><span class="err">:</span> <span class="s1">'Juan Perez Ramirez'</span>
   <span class="p">},</span>
   <span class="s1">'amount'</span> <span class="err">:</span> <span class="mf">10.50</span><span class="p">,</span>
   <span class="s1">'description'</span> <span class="err">:</span> <span class="s1">'Retiro de saldo semanal'</span><span class="p">,</span>
   <span class="s1">'order_id'</span> <span class="err">:</span> <span class="s1">'oid-00021'</span>
<span class="p">};</span>

<span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">payouts</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="s1">'asynwirguzkgq2bizogo'</span><span class="p">,</span> <span class="nx">payoutRequest</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">payout</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// ...
</span><span class="p">});</span>
</pre><pre class="highlight ruby"><span class="vi">@openpay</span><span class="o">=</span><span class="no">OpenpayApi</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"mzdtln0bmtms6o3kck8f"</span><span class="p">,</span><span class="s2">"sk_e568c42a6c384b7ab02cd47d2e407cab"</span><span class="p">)</span>
<span class="vi">@payouts</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:payouts</span><span class="p">)</span>
<span class="n">card_hash</span><span class="o">=</span><span class="p">{</span>
     <span class="s2">"holder_name"</span> <span class="o">=&gt;</span> <span class="s2">"Juan Perez Ramirez"</span><span class="p">,</span>
     <span class="s2">"card_number"</span> <span class="o">=&gt;</span> <span class="s2">"411111XXXXXX1111"</span><span class="p">,</span>
     <span class="s2">"cvv2"</span> <span class="o">=&gt;</span> <span class="s2">"110"</span><span class="p">,</span>
     <span class="s2">"expiration_month"</span> <span class="o">=&gt;</span> <span class="s2">"12"</span><span class="p">,</span>
     <span class="s2">"expiration_year"</span> <span class="o">=&gt;</span> <span class="s2">"20"</span>
   <span class="p">}</span>
<span class="n">request_hash</span><span class="o">=</span><span class="p">{</span>
     <span class="s2">"method"</span> <span class="o">=&gt;</span> <span class="s2">"card"</span><span class="p">,</span>
     <span class="s2">"card"</span> <span class="o">=&gt;</span> <span class="n">card_hash</span><span class="p">,</span>
     <span class="s2">"amount"</span> <span class="o">=&gt;</span> <span class="mi">10</span><span class="o">.</span><span class="mi">50</span><span class="p">,</span>
     <span class="s2">"description"</span> <span class="o">=&gt;</span> <span class="s2">"Retiro de saldo semanal"</span><span class="p">,</span>
     <span class="s2">"order_id"</span> <span class="o">=&gt;</span> <span class="s2">"oid-00021"</span>
   <span class="p">}</span>

<span class="n">response_hash</span><span class="o">=</span><span class="vi">@payouts</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="n">request_hash</span><span class="p">.</span><span class="nf">to_hash</span><span class="p">,</span> <span class="s2">"asynwirguzkgq2bizogo"</span><span class="p">)</span>
</pre>
<blockquote>
<p>Response example</p>
</blockquote>
<pre class="highlight json"><span class="p">{</span><span class="w">
   </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"trwpxhrgfeub9eqdyvqz"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"amount"</span><span class="p">:</span><span class="mf">10.50</span><span class="p">,</span><span class="w">
   </span><span class="s2">"authorization"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
   </span><span class="s2">"method"</span><span class="p">:</span><span class="s2">"card"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"operation_type"</span><span class="p">:</span><span class="s2">"out"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"transaction_type"</span><span class="p">:</span><span class="s2">"payout"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"card"</span><span class="p">:{</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"debit"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"brand"</span><span class="p">:</span><span class="s2">"visa"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"address"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"card_number"</span><span class="p">:</span><span class="s2">"411111XXXXXX1111"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"holder_name"</span><span class="p">:</span><span class="s2">"Juan Perez Ramirez"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"expiration_year"</span><span class="p">:</span><span class="s2">"20"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"expiration_month"</span><span class="p">:</span><span class="s2">"12"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"allows_charges"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="s2">"allows_payouts"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="s2">"bank_name"</span><span class="p">:</span><span class="s2">"Banamex"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"bank_code"</span><span class="p">:</span><span class="s2">"002"</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="s2">"status"</span><span class="p">:</span><span class="s2">"in_progress"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"currency"</span><span class="p">:</span><span class="s2">"MXN"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="s2">"2014-05-26T17:04:26-05:00"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"operation_date"</span><span class="p">:</span><span class="s2">"2014-05-26T17:04:26-05:00"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"description"</span><span class="p">:</span><span class="s2">"Retiro de saldo semanal"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"error_message"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
   </span><span class="s2">"order_id"</span><span class="p">:</span><span class="s2">"oid-00021"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"customer_id"</span><span class="p">:</span><span class="s2">"asynwirguzkgq2bizogo"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<p>Sends a payment to a debit card. In  case the used card is not debit, the funds will be returned to the account from which they were withdrawn.</p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>method</td>
<td><strong><em>string</em></strong> (required) <br/>It must contain the <strong>card</strong> value.</td>
</tr>
<tr>
<td>card</td>
<td><strong><em>object</em></strong> (required) <br/>Data of the card where the funds will be sent. <br/><br/> <strong>card_number</strong>.- Card number where the funds will be sent. <br/><strong>holder_name</strong>.- Name of the card owner (cardholder).</td>
</tr>
<tr>
<td>amount</td>
<td><strong><em>numeric</em></strong> (required) <br/>Amount of payout. Must be an amount greater than zero, with up to two decimal digits.</td>
</tr>
<tr>
<td>description</td>
<td><strong><em>string</em></strong> (required, length = 250) <br/>A description associated to the payment.</td>
</tr>
<tr>
<td>order_id</td>
<td><strong><em>string</em></strong> (optional, length = 100) <br/>Unique identifier of payout. Must be unique among all transactions.</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<p>Returns a <a href="#transaction-object">transaction object</a> with the payout information or with an <a href="#error-object">error response</a>.</p>

<h2 id="get-a-payout">Get a payout</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell">Merchant
GET https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/payouts/<span class="o">{</span>TRANSACTION_ID<span class="o">}</span>

Customer
GET https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/customers/<span class="o">{</span>CUSTOMER_ID<span class="o">}</span>/payouts/<span class="o">{</span>TRANSACTION_ID<span class="o">}</span>
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nx">Merchant</span>
<span class="nv">$payout</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">payouts</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">transactionId</span><span class="p">);</span>

<span class="nx">Customer</span>
<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">customerId</span><span class="p">);</span>
<span class="nv">$payout</span> <span class="o">=</span> <span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">payouts</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">transactionId</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="c1">//Customer</span>
<span class="n">openpayAPI</span><span class="o">.</span><span class="na">payouts</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="n">String</span> <span class="n">customerId</span><span class="o">,</span> <span class="n">String</span> <span class="n">transactionId</span><span class="o">);</span>

<span class="c1">//Merchant</span>
<span class="n">openpayAPI</span><span class="o">.</span><span class="na">payouts</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="n">String</span> <span class="n">transactionId</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="c1">//Customer
</span><span class="n">openpayAPI</span><span class="p">.</span><span class="n">PayoutService</span><span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="kt">string</span> <span class="n">customer_id</span><span class="p">,</span> <span class="kt">string</span> <span class="n">transaction_id</span><span class="p">);</span>

<span class="c1">//Merchant
</span><span class="n">openpayAPI</span><span class="p">.</span><span class="n">PayoutService</span><span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="kt">string</span> <span class="n">transaction_id</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="c1">// Merchant
</span><span class="nx">openpay</span><span class="p">.</span><span class="nx">payouts</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">transactionId</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>

<span class="c1">// Customer
</span><span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">payouts</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">customerId</span><span class="p">,</span> <span class="nx">transactionId</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
</pre><pre class="highlight ruby"><span class="c1">#Customer</span>
<span class="vi">@payouts</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:payouts</span><span class="p">)</span>
<span class="vi">@payouts</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">transaction_id</span><span class="p">,</span> <span class="n">customer_id</span><span class="p">)</span>

<span class="c1">#Merchant</span>
<span class="vi">@payouts</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:payouts</span><span class="p">)</span>
<span class="vi">@payouts</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">transaction_id</span><span class="p">)</span>
</pre>
<blockquote>
<p>Customer request example</p>
</blockquote>
<pre class="highlight shell">curl https://sandbox-api.openpay.mx/v1/mzdtln0bmtms6o3kck8f/customers/asynwirguzkgq2bizogo/payouts/trwpxhrgfeub9eqdyvqz <span class="se">\</span>
   -u sk_e568c42a6c384b7ab02cd47d2e407cab:
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$openpay</span> <span class="o">=</span> <span class="nx">Openpay</span><span class="o">::</span><span class="na">getInstance</span><span class="p">(</span><span class="s1">'mzdtln0bmtms6o3kck8f'</span><span class="p">,</span> <span class="s1">'sk_e568c42a6c384b7ab02cd47d2e407cab'</span><span class="p">);</span>

<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'asynwirguzkgq2bizogo'</span><span class="p">);</span>
<span class="nv">$payout</span> <span class="o">=</span> <span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">payouts</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'trwpxhrgfeub9eqdyvqz'</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OpenpayAPI</span><span class="o">(</span><span class="s">"https://sandbox-api.openpay.mx"</span><span class="o">,</span> <span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="o">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="o">);</span>
<span class="n">Payout</span> <span class="n">payout</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="na">payouts</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="s">"ag4nktpdzebjiye1tlze"</span><span class="o">,</span> <span class="s">"tr6cxbcefzatd10guvvw"</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">OpenpayAPI</span><span class="p">(</span><span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="p">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="p">);</span>
<span class="n">Payout</span> <span class="p">=</span> <span class="n">api</span><span class="p">.</span><span class="n">PayoutService</span><span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="s">"ag4nktpdzebjiye1tlze"</span><span class="p">,</span> <span class="s">"tr6cxbcefzatd10guvvw"</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">payouts</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'ag4nktpdzebjiye1tlze'</span><span class="p">,</span> <span class="s1">'tr6cxbcefzatd10guvvw'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">payout</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// ...
</span><span class="p">});</span>
</pre><pre class="highlight ruby"><span class="vi">@openpay</span><span class="o">=</span><span class="no">OpenpayApi</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"mzdtln0bmtms6o3kck8f"</span><span class="p">,</span><span class="s2">"sk_e568c42a6c384b7ab02cd47d2e407cab"</span><span class="p">)</span>
<span class="vi">@payouts</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:payouts</span><span class="p">)</span>

<span class="n">response_hash</span><span class="o">=</span><span class="vi">@payouts</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="s2">"tr6cxbcefzatd10guvvw"</span><span class="p">,</span> <span class="s2">"asynwirguzkgq2bizogo"</span><span class="p">)</span>
</pre>
<blockquote>
<p>Response example</p>
</blockquote>
<pre class="highlight json"><span class="p">{</span><span class="w">
   </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"trwpxhrgfeub9eqdyvqz"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"amount"</span><span class="p">:</span><span class="mf">10.50</span><span class="p">,</span><span class="w">
   </span><span class="s2">"authorization"</span><span class="p">:</span><span class="s2">"TRWPXHRGFEUB9EQDYVQZ"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"method"</span><span class="p">:</span><span class="s2">"card"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"operation_type"</span><span class="p">:</span><span class="s2">"out"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"transaction_type"</span><span class="p">:</span><span class="s2">"payout"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"card"</span><span class="p">:{</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"debit"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"brand"</span><span class="p">:</span><span class="s2">"visa"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"address"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"card_number"</span><span class="p">:</span><span class="s2">"411111XXXXXX1111"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"holder_name"</span><span class="p">:</span><span class="s2">"Juan Perez Ramirez"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"expiration_year"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"expiration_month"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"allows_charges"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="s2">"allows_payouts"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="s2">"bank_name"</span><span class="p">:</span><span class="s2">"Banamex"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"bank_code"</span><span class="p">:</span><span class="s2">"002"</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="s2">"status"</span><span class="p">:</span><span class="s2">"completed"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"currency"</span><span class="p">:</span><span class="s2">"MXN"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="s2">"2014-05-26T17:04:26-05:00"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"operation_date"</span><span class="p">:</span><span class="s2">"2014-05-26T17:06:28-05:00"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"description"</span><span class="p">:</span><span class="s2">"Retiro de saldo semanal"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"error_message"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
   </span><span class="s2">"order_id"</span><span class="p">:</span><span class="s2">"oid-00021"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"customer_id"</span><span class="p">:</span><span class="s2">"asynwirguzkgq2bizogo"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<p>Returns de information of the payout. You must know the payout id.</p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>transaction_id</td>
<td><em><strong>string</strong></em> (required, length = 45)<br/>Id of the payout you want to get.</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<p>Returns a <a href="#transaction-object">transaction object</a> with the payout information or with an <a href="#error-object">error response</a>.</p>

<h2 id="list-of-payouts">List of payouts</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell">Merchant
GET https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/payouts

Customer
GET https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/customers/<span class="o">{</span>CUSTOMER_ID<span class="o">}</span>/payouts
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nx">Merchant</span>
<span class="nv">$payoutList</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">payouts</span><span class="o">-&gt;</span><span class="na">getList</span><span class="p">(</span><span class="nx">searchParams</span><span class="p">);</span>

<span class="nx">Customer</span>
<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">customerId</span><span class="p">);</span>
<span class="nv">$payoutList</span> <span class="o">=</span> <span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">payouts</span><span class="o">-&gt;</span><span class="na">getList</span><span class="p">(</span><span class="nx">searchParams</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="c1">//Customer</span>
<span class="n">openpayAPI</span><span class="o">.</span><span class="na">payouts</span><span class="o">().</span><span class="na">list</span><span class="o">(</span><span class="n">String</span> <span class="n">customerId</span><span class="o">,</span> <span class="n">SearchParams</span> <span class="n">request</span><span class="o">);</span>

<span class="c1">//Merchant</span>
<span class="n">openpayAPI</span><span class="o">.</span><span class="na">payouts</span><span class="o">().</span><span class="na">list</span><span class="o">(</span><span class="n">SearchParams</span> <span class="n">request</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="c1">//Customer
</span><span class="n">openpayAPI</span><span class="p">.</span><span class="n">PayoutService</span><span class="p">.</span><span class="nf">List</span><span class="p">(</span><span class="kt">string</span> <span class="n">customer_id</span><span class="p">,</span> <span class="n">SearchParams</span> <span class="n">request</span> <span class="p">=</span> <span class="k">null</span><span class="p">);</span>

<span class="c1">//Merchant
</span><span class="n">openpayAPI</span><span class="p">.</span><span class="n">PayoutService</span><span class="p">.</span><span class="nf">List</span><span class="p">(</span><span class="n">SearchParams</span> <span class="n">request</span> <span class="p">=</span> <span class="k">null</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="c1">// Merchant
</span><span class="nx">openpay</span><span class="p">.</span><span class="nx">payouts</span><span class="p">.</span><span class="nx">list</span><span class="p">(</span><span class="nx">callback</span><span class="p">);</span>
<span class="nx">openpay</span><span class="p">.</span><span class="nx">payouts</span><span class="p">.</span><span class="nx">list</span><span class="p">(</span><span class="nx">searchParams</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>

<span class="c1">// Customer
</span><span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">payouts</span><span class="p">.</span><span class="nx">list</span><span class="p">(</span><span class="nx">customerId</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
<span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">payouts</span><span class="p">.</span><span class="nx">list</span><span class="p">(</span><span class="nx">customerId</span><span class="p">,</span> <span class="nx">searchParams</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
</pre><pre class="highlight ruby"><span class="c1">#Customer</span>
<span class="vi">@payouts</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:payouts</span><span class="p">)</span>
<span class="vi">@payouts</span><span class="p">.</span><span class="nf">all</span><span class="p">(</span><span class="n">customer_id</span><span class="p">)</span>

<span class="c1">#Merchant</span>
<span class="vi">@payouts</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:payouts</span><span class="p">)</span>
<span class="vi">@payouts</span><span class="p">.</span><span class="nf">all</span>
</pre>
<blockquote>
<p>Request example </p>
</blockquote>
<pre class="highlight shell">curl -g <span class="s2">"https://sandbox-api.openpay.mx/v1/mzdtln0bmtms6o3kck8f/customers/asynwirguzkgq2bizogo/payouts?creation[gte]=2013-11-01&amp;limit=2&amp;payout_type=AUTOMATIC"</span> <span class="se">\</span>
   -u sk_e568c42a6c384b7ab02cd47d2e407cab: 
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$openpay</span> <span class="o">=</span> <span class="nx">Openpay</span><span class="o">::</span><span class="na">getInstance</span><span class="p">(</span><span class="s1">'mzdtln0bmtms6o3kck8f'</span><span class="p">,</span> <span class="s1">'sk_e568c42a6c384b7ab02cd47d2e407cab'</span><span class="p">);</span>

<span class="nv">$searchParams</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'creation[gte]'</span> <span class="o">=&gt;</span> <span class="s1">'2013-11-01'</span><span class="p">,</span>
    <span class="s1">'creation[lte]'</span> <span class="o">=&gt;</span> <span class="s1">'2017-12-31'</span><span class="p">,</span>
    <span class="s1">'payout_type'</span> <span class="o">=&gt;</span> <span class="s1">'AUTOMATIC'</span><span class="p">,</span>
    <span class="s1">'offset'</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">'limit'</span> <span class="o">=&gt;</span> <span class="mi">2</span><span class="p">);</span>

<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'asynwirguzkgq2bizogo'</span><span class="p">);</span>
<span class="nv">$payoutList</span> <span class="o">=</span> <span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">payouts</span><span class="o">-&gt;</span><span class="na">getList</span><span class="p">(</span><span class="nv">$searchParams</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="kd">final</span> <span class="n">Calendar</span> <span class="n">dateGte</span> <span class="o">=</span> <span class="n">Calendar</span><span class="o">.</span><span class="na">getInstance</span><span class="o">();</span>
<span class="kd">final</span> <span class="n">Calendar</span> <span class="n">dateLte</span> <span class="o">=</span> <span class="n">Calendar</span><span class="o">.</span><span class="na">getInstance</span><span class="o">();</span>
<span class="n">dateGte</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="mi">2014</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">);</span>
<span class="n">dateLte</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="mi">2014</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">15</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">);</span>

<span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OpenpayAPI</span><span class="o">(</span><span class="s">"https://sandbox-api.openpay.mx"</span><span class="o">,</span> <span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="o">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="o">);</span>
<span class="n">SearchParams</span> <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SearchParams</span><span class="o">();</span>
<span class="n">request</span><span class="o">.</span><span class="na">creationGte</span><span class="o">(</span><span class="n">dateGte</span><span class="o">.</span><span class="na">getTime</span><span class="o">());</span>
<span class="n">request</span><span class="o">.</span><span class="na">creationLte</span><span class="o">(</span><span class="n">dateLte</span><span class="o">.</span><span class="na">getTime</span><span class="o">());</span>
<span class="n">request</span><span class="o">.</span><span class="na">offset</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">limit</span><span class="o">(</span><span class="mi">100</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">amount</span><span class="o">(</span><span class="k">new</span> <span class="n">BigDecimal</span><span class="o">(</span><span class="s">"100.00"</span><span class="o">));</span>

<span class="n">List</span><span class="o">&lt;</span><span class="n">Payout</span><span class="o">&gt;</span> <span class="n">payouts</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="na">payouts</span><span class="o">().</span><span class="na">list</span><span class="o">(</span><span class="s">"ag4nktpdzebjiye1tlze"</span><span class="o">,</span> <span class="n">request</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">OpenpayAPI</span><span class="p">(</span><span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="p">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="p">);</span>
<span class="n">SearchParams</span> <span class="n">request</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SearchParams</span><span class="p">();</span>
<span class="n">request</span><span class="p">.</span><span class="n">CreationGte</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Datetime</span><span class="p">(</span><span class="m">2014</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">1</span><span class="p">);</span>
<span class="n">request</span><span class="p">.</span><span class="n">CreationLte</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">2014</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">15</span><span class="p">);</span>
<span class="n">request</span><span class="p">.</span><span class="n">Offset</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">Limit</span> <span class="p">=</span> <span class="m">100</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">Amount</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Decimal</span><span class="p">(</span><span class="m">100.00</span><span class="p">);</span>

<span class="n">List</span><span class="p">&lt;</span><span class="n">Payout</span><span class="p">&gt;</span> <span class="n">payouts</span> <span class="p">=</span> <span class="n">api</span><span class="p">.</span><span class="n">PayoutService</span><span class="p">.</span><span class="nf">List</span><span class="p">(</span><span class="s">"ag4nktpdzebjiye1tlze"</span><span class="p">,</span> <span class="n">request</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="kd">var</span> <span class="nx">searchParams</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">'creation[gte]'</span> <span class="err">:</span> <span class="s1">'2013-11-01'</span><span class="p">,</span>
  <span class="s1">'payout_type'</span> <span class="err">:</span> <span class="s1">'AUTOMATIC'</span><span class="p">,</span>
  <span class="s1">'limit'</span> <span class="err">:</span> <span class="mi">2</span>
<span class="p">};</span>

<span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">payouts</span><span class="p">.</span><span class="nx">list</span><span class="p">(</span><span class="s1">'asynwirguzkgq2bizogo'</span><span class="p">,</span> <span class="nx">searchParams</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">list</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// ...
</span><span class="p">});</span>
</pre><pre class="highlight ruby"><span class="vi">@openpay</span><span class="o">=</span><span class="no">OpenpayApi</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"mzdtln0bmtms6o3kck8f"</span><span class="p">,</span><span class="s2">"sk_e568c42a6c384b7ab02cd47d2e407cab"</span><span class="p">)</span>
<span class="vi">@payouts</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:payouts</span><span class="p">)</span>

<span class="n">response_hash</span><span class="o">=</span><span class="vi">@payouts</span><span class="p">.</span><span class="nf">all</span><span class="p">(</span><span class="s2">"asynwirguzkgq2bizogo"</span><span class="p">)</span>
</pre>
<blockquote>
<p>Response example</p>
</blockquote>
<pre class="highlight json"><span class="p">[</span><span class="w">
   </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"tr4f2atubqchinw71vfs"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"amount"</span><span class="p">:</span><span class="mf">10.50</span><span class="p">,</span><span class="w">
      </span><span class="s2">"authorization"</span><span class="p">:</span><span class="s2">"TR4F2ATUBQCHINW71VFS"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"method"</span><span class="p">:</span><span class="s2">"bank_account"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"operation_type"</span><span class="p">:</span><span class="s2">"out"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"transaction_type"</span><span class="p">:</span><span class="s2">"payout"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"status"</span><span class="p">:</span><span class="s2">"completed"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"currency"</span><span class="p">:</span><span class="s2">"MXN"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="s2">"2014-05-26T17:23:03-05:00"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"operation_date"</span><span class="p">:</span><span class="s2">"2014-05-26T17:26:27-05:00"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"description"</span><span class="p">:</span><span class="s2">"Retiro de saldo semanal"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"error_message"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"order_id"</span><span class="p">:</span><span class="s2">"oid-1110011"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"bank_account"</span><span class="p">:{</span><span class="w">
         </span><span class="s2">"clabe"</span><span class="p">:</span><span class="s2">"012XXXXXXXXXX24616"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"bank_code"</span><span class="p">:</span><span class="s2">"012"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"bank_name"</span><span class="p">:</span><span class="s2">"BANCOMER"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"alias"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
         </span><span class="s2">"holder_name"</span><span class="p">:</span><span class="s2">"Mi empresa"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"customer_id"</span><span class="p">:</span><span class="s2">"asynwirguzkgq2bizogo"</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"trwpxhrgfeub9eqdyvqz"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"amount"</span><span class="p">:</span><span class="mf">10.50</span><span class="p">,</span><span class="w">
      </span><span class="s2">"authorization"</span><span class="p">:</span><span class="s2">"TRWPXHRGFEUB9EQDYVQZ"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"method"</span><span class="p">:</span><span class="s2">"card"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"operation_type"</span><span class="p">:</span><span class="s2">"out"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"transaction_type"</span><span class="p">:</span><span class="s2">"payout"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"card"</span><span class="p">:{</span><span class="w">
         </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"debit"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"brand"</span><span class="p">:</span><span class="s2">"visa"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"address"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
         </span><span class="s2">"card_number"</span><span class="p">:</span><span class="s2">"411111XXXXXX1111"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"holder_name"</span><span class="p">:</span><span class="s2">"Juan Perez Ramirez"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"expiration_year"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
         </span><span class="s2">"expiration_month"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
         </span><span class="s2">"allows_charges"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
         </span><span class="s2">"allows_payouts"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
         </span><span class="s2">"bank_name"</span><span class="p">:</span><span class="s2">"Banamex"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"bank_code"</span><span class="p">:</span><span class="s2">"002"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"status"</span><span class="p">:</span><span class="s2">"completed"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"currency"</span><span class="p">:</span><span class="s2">"MXN"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="s2">"2014-05-26T17:04:26-05:00"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"operation_date"</span><span class="p">:</span><span class="s2">"2014-05-26T17:06:28-05:00"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"description"</span><span class="p">:</span><span class="s2">"Retiro de saldo semanal"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"error_message"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"order_id"</span><span class="p">:</span><span class="s2">"oid-00021"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"customer_id"</span><span class="p">:</span><span class="s2">"asynwirguzkgq2bizogo"</span><span class="w">
   </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></pre>
<p>Gets a list of payouts made at Merchant or customer level.</p>

<h3 id="request">Request</h3>

<p>You can search using the following parameters as filters.</p>

<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>creation</td>
<td><strong><em>date</em></strong> <br/>Same as creation date. Format yyyy-mm-dd</td>
</tr>
<tr>
<td>creation[gte]</td>
<td><strong><em>date</em></strong> <br/>After the creation date. Format yyyy-mm-dd</td>
</tr>
<tr>
<td>creation[lte]</td>
<td><strong><em>date</em></strong> <br/>Before the creation date. Format yyyy-mm-dd</td>
</tr>
<tr>
<td>offset</td>
<td><strong><em>numeric</em></strong> <br/>Number of records to skip at the beginning, default 0.</td>
</tr>
<tr>
<td>limit</td>
<td><strong><em>numeric</em></strong> <br/>Number of required records, default 10.</td>
</tr>
<tr>
<td>amount</td>
<td><strong><em>numeric</em></strong> <br/>Same as the amount.</td>
</tr>
<tr>
<td>amount[gte]</td>
<td><strong><em>numeric</em></strong> <br/>Greater than or equal to the amount.</td>
</tr>
<tr>
<td>amount[lte]</td>
<td><strong><em>numeric</em></strong> <br/>Less than or equal to the amount.</td>
</tr>
<tr>
<td>payout_type</td>
<td><strong><em>string (opfional, ALL, AUTOMATIC o MANUAL)</em></strong>  <br/>Payout type used to filter the transactions</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<p>Returns a list of <a href="#transaction-object">transaction objects</a> payouts in descending order by creation date.</p>

<h1 id="customers">Customers</h1>

<p>Customers are Openpay resources that are handled within the Merchant account and can represent users, customers or partners according to the type of Merchant.</p>

<p>You can add cards and bank accounts  to the customers so you can make transactions like Charges, Transfers or Payouts.</p>

<h2 id="customer-object">Customer object</h2>

<blockquote>
<p>Object example</p>
</blockquote>
<pre class="highlight json"><span class="p">{</span><span class="w">
   </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"cz4nkhrlcu9k7qd4lwqx"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="s2">"2013-11-08T12:04:46-06:00"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"name"</span><span class="p">:</span><span class="s2">"Rodrigo"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"last_name"</span><span class="p">:</span><span class="s2">"Velazco Perez"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"email"</span><span class="p">:</span><span class="s2">"rodrigo.velazco@payments.com"</span><span class="p">,</span><span class="w"> 
   </span><span class="s2">"phone_number"</span><span class="p">:</span><span class="s2">"4425667045"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"external_id"</span><span class="p">:</span><span class="s2">"cliente1"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"status"</span><span class="p">:</span><span class="s2">"active"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"balance"</span><span class="p">:</span><span class="mi">103</span><span class="p">,</span><span class="w">
   </span><span class="s2">"address"</span><span class="p">:{</span><span class="w">
      </span><span class="s2">"line1"</span><span class="p">:</span><span class="s2">"Av. 5 de febrero No. 1080 int Roble 207"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"line2"</span><span class="p">:</span><span class="s2">"Carrillo puerto"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"line3"</span><span class="p">:</span><span class="s2">"Zona industrial carrillo puerto"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"postal_code"</span><span class="p">:</span><span class="s2">"06500"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"state"</span><span class="p">:</span><span class="s2">"QuerÃ©taro"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"city"</span><span class="p">:</span><span class="s2">"QuerÃ©taro"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"country_code"</span><span class="p">:</span><span class="s2">"MX"</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="s2">"store"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
       </span><span class="s2">"reference"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OPENPAY02DQ35YOY7"</span><span class="p">,</span><span class="w">
       </span><span class="s2">"barcode_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://sandbox-api.openpay.mx/barcode/OPENPAY02DQ35YOY7?width=1&amp;height=45&amp;text=false"</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="s2">"clabe"</span><span class="p">:</span><span class="w"> </span><span class="s2">"646180109400423323"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td><strong><em>string</em></strong> <br/>Customer unique identifier.</td>
</tr>
<tr>
<td>creation_date</td>
<td><strong><em>datetime</em></strong> <br/>Date and time when the customer was created in ISO 8601 format.</td>
</tr>
<tr>
<td>name</td>
<td><strong><em>string</em></strong> <br/>Name of the customer.</td>
</tr>
<tr>
<td>last_name</td>
<td><strong><em>string</em></strong> <br/>Last name of the customer.</td>
</tr>
<tr>
<td>email</td>
<td><strong><em>string</em></strong> <br/>Email of the customer.</td>
</tr>
<tr>
<td>phone_number</td>
<td><strong><em>numeric</em></strong> <br/>Telephone number of the customer.</td>
</tr>
<tr>
<td>status</td>
<td><strong><em>string</em></strong> <br/>Account status of the customer can be active or deleted. If the account is on deleted status, no transaction is allowed.</td>
</tr>
<tr>
<td>balance</td>
<td><strong><em>numeric</em></strong> <br/>Account balance with two decimal digits.</td>
</tr>
<tr>
<td>clabe</td>
<td><strong><em>numeric</em></strong> <br/>CLABE account used to receive funds by transfer from any bank in Mexico.</td>
</tr>
<tr>
<td><a href="#addres-object">address</a></td>
<td><strong><em>object</em></strong> <br/>Address of the customer. It is usually used as shipping address.</td>
</tr>
<tr>
<td><a href="#store-object">store</a></td>
<td><em><em>object</em>*</em> <br/>Contains reference string to go to Store and make deposits, the url to generate barcode is contained too.</td>
</tr>
</tbody></table>

<h2 id="create-a-new-customer">Create a new customer</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell">POST https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/customers
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="nx">customerData</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">openpayAPI</span><span class="o">.</span><span class="na">customers</span><span class="o">().</span><span class="na">create</span><span class="o">(</span><span class="n">Customer</span> <span class="n">customer</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">openpayAPI</span><span class="p">.</span><span class="n">CustomerService</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="n">Customer</span> <span class="n">customer</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">customerRequest</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
</pre><pre class="highlight ruby"><span class="vi">@customers</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:customers</span><span class="p">)</span>
<span class="vi">@customers</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="n">request_hash</span><span class="p">)</span>
</pre>
<blockquote>
<p>Request example </p>
</blockquote>
<pre class="highlight shell">curl https://sandbox-api.openpay.mx/v1/mzdtln0bmtms6o3kck8f/customers <span class="se">\</span>
   -u sk_e568c42a6c384b7ab02cd47d2e407cab: <span class="se">\</span>
   -H <span class="s2">"Content-type: application/json"</span> <span class="se">\</span>
   -X POST -d <span class="s1">'{
   "name": "customer name",
   "email": "customer_email@me.com",
   "requires_account": false 
   }'</span> 
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$openpay</span> <span class="o">=</span> <span class="nx">Openpay</span><span class="o">::</span><span class="na">getInstance</span><span class="p">(</span><span class="s1">'mzdtln0bmtms6o3kck8f'</span><span class="p">,</span> <span class="s1">'sk_e568c42a6c384b7ab02cd47d2e407cab'</span><span class="p">);</span>

<span class="nv">$customerData</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
     <span class="s1">'external_id'</span> <span class="o">=&gt;</span> <span class="s1">''</span><span class="p">,</span>
     <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'customer name'</span><span class="p">,</span>
     <span class="s1">'last_name'</span> <span class="o">=&gt;</span> <span class="s1">''</span><span class="p">,</span>
     <span class="s1">'email'</span> <span class="o">=&gt;</span> <span class="s1">'customer_email@me.com'</span><span class="p">,</span>
     <span class="s1">'requires_account'</span> <span class="o">=&gt;</span> <span class="kc">false</span><span class="p">,</span>
     <span class="s1">'phone_number'</span> <span class="o">=&gt;</span> <span class="s1">'44209087654'</span><span class="p">,</span>
     <span class="s1">'address'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
         <span class="s1">'line1'</span> <span class="o">=&gt;</span> <span class="s1">'Calle 10'</span><span class="p">,</span>
         <span class="s1">'line2'</span> <span class="o">=&gt;</span> <span class="s1">'col. san pablo'</span><span class="p">,</span>
         <span class="s1">'line3'</span> <span class="o">=&gt;</span> <span class="s1">'entre la calle 1 y la 2'</span><span class="p">,</span>
         <span class="s1">'state'</span> <span class="o">=&gt;</span> <span class="s1">'Queretaro'</span><span class="p">,</span>
         <span class="s1">'city'</span> <span class="o">=&gt;</span> <span class="s1">'Queretaro'</span><span class="p">,</span>
         <span class="s1">'postal_code'</span> <span class="o">=&gt;</span> <span class="s1">'76000'</span><span class="p">,</span>
         <span class="s1">'country_code'</span> <span class="o">=&gt;</span> <span class="s1">'MX'</span>
      <span class="p">)</span>
   <span class="p">);</span>

<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="nv">$customerData</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OpenpayAPI</span><span class="o">(</span><span class="s">"https://sandbox-api.openpay.mx"</span><span class="o">,</span> <span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="o">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="o">);</span>
<span class="n">Customer</span> <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Customer</span><span class="o">();</span>
<span class="n">request</span><span class="o">.</span><span class="na">externalId</span><span class="o">(</span><span class="s">"idExterno0101"</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">name</span><span class="o">(</span><span class="s">"Julian Gerardo"</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">lastName</span><span class="o">(</span><span class="s">"LÃ³pez MartÃ­nez"</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">email</span><span class="o">(</span><span class="s">"julian.martinez@gmail.com"</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">phoneNumber</span><span class="o">(</span><span class="s">"4421432915"</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">requiresAccount</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span>
<span class="n">Address</span> <span class="n">address</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Address</span><span class="o">();</span>
<span class="n">address</span><span class="o">.</span><span class="na">city</span><span class="o">(</span><span class="s">"Queretaro"</span><span class="o">);</span>
<span class="n">address</span><span class="o">.</span><span class="na">countryCode</span><span class="o">(</span><span class="s">"MX"</span><span class="o">);</span>
<span class="n">address</span><span class="o">.</span><span class="na">state</span><span class="o">(</span><span class="s">"Queretaro"</span><span class="o">);</span>
<span class="n">address</span><span class="o">.</span><span class="na">postalCode</span><span class="o">(</span><span class="s">"79125"</span><span class="o">);</span>
<span class="n">address</span><span class="o">.</span><span class="na">line1</span><span class="o">(</span><span class="s">"Av. Pie de la cuesta #12"</span><span class="o">);</span>
<span class="n">address</span><span class="o">.</span><span class="na">line2</span><span class="o">(</span><span class="s">"Desarrollo San Pablo"</span><span class="o">);</span>
<span class="n">address</span><span class="o">.</span><span class="na">line3</span><span class="o">(</span><span class="s">"Qro. Qro."</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">address</span><span class="o">(</span><span class="n">address</span><span class="o">);</span>

<span class="n">request</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="na">customers</span><span class="o">().</span><span class="na">create</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">OpenpayAPI</span><span class="p">(</span><span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="p">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="p">);</span>
<span class="n">Customer</span> <span class="n">request</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Customer</span><span class="p">();</span>
<span class="n">request</span><span class="p">.</span><span class="n">ExternalId</span> <span class="p">=</span> <span class="s">"idExterno0101"</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">Name</span> <span class="p">=</span> <span class="s">"Julian Gerardo"</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">LastName</span> <span class="p">=</span> <span class="s">"LÃ³pez MartÃ­nez"</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">Email</span> <span class="p">=</span> <span class="s">"julian.martinez@gmail.com"</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">PhoneNumber</span> <span class="p">=</span> <span class="s">"4421432915"</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">RequiresAccount</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
<span class="n">Address</span> <span class="n">address</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Address</span><span class="p">();</span>
<span class="n">address</span><span class="p">.</span><span class="n">City</span> <span class="p">=</span> <span class="s">"Queretaro"</span><span class="p">;</span>
<span class="n">address</span><span class="p">.</span><span class="n">CountryCode</span> <span class="p">=</span> <span class="s">"MX"</span><span class="p">;</span>
<span class="n">address</span><span class="p">.</span><span class="n">State</span> <span class="p">=</span> <span class="s">"Queretaro"</span><span class="p">;</span>
<span class="n">address</span><span class="p">.</span><span class="n">PostalCode</span> <span class="p">=</span> <span class="s">"79125"</span><span class="p">;</span>
<span class="n">address</span><span class="p">.</span><span class="n">Line1</span> <span class="p">=</span> <span class="s">"Av. Pie de la cuesta #12"</span><span class="p">;</span>
<span class="n">address</span><span class="p">.</span><span class="n">Line2</span> <span class="p">=</span> <span class="s">"Desarrollo San Pablo"</span><span class="p">;</span>
<span class="n">address</span><span class="p">.</span><span class="n">Line3</span> <span class="p">=</span> <span class="s">"Qro. Qro."</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">Address</span> <span class="p">=</span> <span class="n">address</span><span class="p">;</span>

<span class="n">request</span> <span class="p">=</span> <span class="n">api</span><span class="p">.</span><span class="n">CustomerService</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="n">request</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="kd">var</span> <span class="nx">customerRequest</span> <span class="o">=</span> <span class="p">{</span>
   <span class="s1">'name'</span><span class="err">:</span> <span class="s1">'customer name'</span><span class="p">,</span>
   <span class="s1">'email'</span><span class="err">:</span> <span class="s1">'customer_email@me.com'</span><span class="p">,</span>
   <span class="s1">'requires_account'</span><span class="err">:</span> <span class="kc">false</span> 
   <span class="p">};</span>

<span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">customerRequest</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">customer</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// ... 
</span><span class="p">});</span>
</pre><pre class="highlight ruby"><span class="vi">@openpay</span><span class="o">=</span><span class="no">OpenpayApi</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"mzdtln0bmtms6o3kck8f"</span><span class="p">,</span><span class="s2">"sk_e568c42a6c384b7ab02cd47d2e407cab"</span><span class="p">)</span>
<span class="vi">@customers</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:customers</span><span class="p">)</span>
<span class="n">address_hash</span><span class="o">=</span><span class="p">{</span>
      <span class="s2">"line1"</span> <span class="o">=&gt;</span> <span class="s2">"Calle 10"</span><span class="p">,</span>
      <span class="s2">"line2"</span> <span class="o">=&gt;</span> <span class="s2">"col. san pablo"</span><span class="p">,</span>
      <span class="s2">"line3"</span> <span class="o">=&gt;</span> <span class="s2">"entre la calle 1 y la 2"</span><span class="p">,</span>
      <span class="s2">"state"</span> <span class="o">=&gt;</span> <span class="s2">"Queretaro"</span><span class="p">,</span>
      <span class="s2">"city"</span> <span class="o">=&gt;</span> <span class="s2">"Queretaro"</span><span class="p">,</span>
      <span class="s2">"postal_code"</span> <span class="o">=&gt;</span> <span class="s2">"76000"</span><span class="p">,</span>
      <span class="s2">"country_code"</span> <span class="o">=&gt;</span> <span class="s2">"MX"</span>
   <span class="p">}</span>
<span class="n">request_hash</span><span class="o">=</span><span class="p">{</span>
     <span class="s2">"external_id"</span> <span class="o">=&gt;</span> <span class="kp">nil</span><span class="p">,</span>
     <span class="s2">"name"</span> <span class="o">=&gt;</span> <span class="s2">"customer name"</span><span class="p">,</span>
     <span class="s2">"last_name"</span> <span class="o">=&gt;</span> <span class="kp">nil</span><span class="p">,</span>
     <span class="s2">"email"</span> <span class="o">=&gt;</span> <span class="s2">"customer_email@me.com"</span><span class="p">,</span>
     <span class="s2">"requires_account"</span> <span class="o">=&gt;</span> <span class="kp">false</span><span class="p">,</span>
     <span class="s2">"phone_number"</span> <span class="o">=&gt;</span> <span class="s2">"44209087654"</span><span class="p">,</span>
     <span class="s2">"address"</span> <span class="o">=&gt;</span> <span class="n">address_hash</span>
   <span class="p">}</span>

<span class="n">response_hash</span><span class="o">=</span><span class="vi">@customers</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="n">request_hash</span><span class="p">.</span><span class="nf">to_hash</span><span class="p">)</span>
</pre>
<blockquote>
<p>Response example</p>
</blockquote>
<pre class="highlight json"><span class="p">{</span><span class="w">
   </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"anbnldwgni1way3yp2dw"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"name"</span><span class="p">:</span><span class="s2">"customer name"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"last_name"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
   </span><span class="s2">"email"</span><span class="p">:</span><span class="s2">"customer_email@me.com"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"phone_number"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
   </span><span class="s2">"address"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
   </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="s2">"2014-05-20T16:47:47-05:00"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"external_id"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
   </span><span class="s2">"store"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
       </span><span class="s2">"reference"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OPENPAY02DQ35YOY7"</span><span class="p">,</span><span class="w">
       </span><span class="s2">"barcode_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://sandbox-api.openpay.mx/barcode/OPENPAY02DQ35YOY7?width=1&amp;height=45&amp;text=false"</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="s2">"clabe"</span><span class="p">:</span><span class="w"> </span><span class="s2">"646180109400423323"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<p>Create a customer object.</p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>external_id</td>
<td><strong><em>string</em></strong> (optional, length = 100)  <br/> Unique external identifier of the customer assigned for the Merchant.</td>
</tr>
<tr>
<td>name</td>
<td><strong><em>string</em></strong> (required, length = 100)<br/>Name of the customer.</td>
</tr>
<tr>
<td>last_name</td>
<td><strong><em>string</em></strong> (optional, length = 100)<br/>Last name of the customer.</td>
</tr>
<tr>
<td>email</td>
<td><strong><em>string</em></strong> (required, length = 100)<br/>Email of the customer.</td>
</tr>
<tr>
<td>requires_account</td>
<td><strong><em>boolean</em></strong>  (optional, default = true) <br/>Send it with <strong>false</strong> value if you need to create the customer without an account to manage the balance.</td>
</tr>
<tr>
<td>phone_number</td>
<td><strong><em>string</em></strong> (optional, length = 100) <br/>Telephone number of the customer.</td>
</tr>
<tr>
<td><a href="#address-object">address</a></td>
<td><strong><em>object</em></strong> (optional) <br/>Address of the customer. It is usually used as shipping address.</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<p>Returns a <a href="#customer-object">customer object</a> when all the data were sent correctly, or returns an <a href="#error-object">error response</a> if a problem happened.</p>

<h2 id="update-a-customer">Update a customer</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell">PUT https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/customers/<span class="o">{</span>CUSTOMER_ID<span class="o">}</span>
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">customerId</span><span class="p">);</span>
<span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">save</span><span class="p">();</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">openpayAPI</span><span class="o">.</span><span class="na">customers</span><span class="o">().</span><span class="na">update</span><span class="o">(</span><span class="n">Customer</span> <span class="n">customer</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">openpayAPI</span><span class="p">.</span><span class="n">CustomerService</span><span class="p">.</span><span class="nf">Update</span><span class="p">(</span><span class="n">Customer</span> <span class="n">customer</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">customerId</span><span class="p">,</span> <span class="nx">customerRequest</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
</pre><pre class="highlight ruby"><span class="vi">@customers</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:customers</span><span class="p">)</span>
<span class="vi">@customers</span><span class="p">.</span><span class="nf">update</span><span class="p">(</span><span class="n">request_hash</span><span class="p">)</span>
</pre>
<blockquote>
<p>Request example </p>
</blockquote>
<pre class="highlight shell">curl https://sandbox-api.openpay.mx/v1/mzdtln0bmtms6o3kck8f/customers/anbnldwgni1way3yp2dw <span class="se">\</span>
   -u sk_e568c42a6c384b7ab02cd47d2e407cab: <span class="se">\</span>
   -H <span class="s2">"Content-type: application/json"</span> <span class="se">\</span>
   -X PUT -d <span class="s1">'{
   "name": "customer name",
   "email": "customer_email@me.com",
   "address":{
      "city":"Queretaro",
      "state":"Queretaro",
      "line1":"Calle 10",
      "postal_code":"76000",
      "line2":"col. san pablo",
      "line3":"entre la calle 1 y la 2",
      "country_code":"MX"
   },
   "phone_number":"44209087654"
 }'</span> 
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$openpay</span> <span class="o">=</span> <span class="nx">Openpay</span><span class="o">::</span><span class="na">getInstance</span><span class="p">(</span><span class="s1">'moiep6umtcnanql3jrxp'</span><span class="p">,</span> <span class="s1">'sk_3433941e467c1055b178ce26348b0fac'</span><span class="p">);</span>

<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'a9ualumwnrcxkl42l6mh'</span><span class="p">);</span>
<span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">name</span> <span class="o">=</span> <span class="s1">'Juan'</span><span class="p">;</span>
<span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">last_name</span> <span class="o">=</span> <span class="s1">'Godinez'</span><span class="p">;</span>
<span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">save</span><span class="p">();</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OpenpayAPI</span><span class="o">(</span><span class="s">"https://sandbox-api.openpay.mx"</span><span class="o">,</span> <span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="o">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="o">);</span>
<span class="n">Customer</span> <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Customer</span><span class="o">();</span>
<span class="n">request</span><span class="o">.</span><span class="na">name</span><span class="o">(</span><span class="s">"Julian Gerardo"</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">lastName</span><span class="o">(</span><span class="s">"LÃ³pez MartÃ­nez"</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">email</span><span class="o">(</span><span class="s">"julian.martinez@gmail.com"</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">phoneNumber</span><span class="o">(</span><span class="s">"4421432915"</span><span class="o">);</span>
<span class="n">Address</span> <span class="n">address</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Address</span><span class="o">();</span>
<span class="n">address</span><span class="o">.</span><span class="na">city</span><span class="o">(</span><span class="s">"Queretaro"</span><span class="o">);</span>
<span class="n">address</span><span class="o">.</span><span class="na">countryCode</span><span class="o">(</span><span class="s">"10"</span><span class="o">);</span>
<span class="n">address</span><span class="o">.</span><span class="na">state</span><span class="o">(</span><span class="s">"Queretaro"</span><span class="o">);</span>
<span class="n">address</span><span class="o">.</span><span class="na">postalCode</span><span class="o">(</span><span class="s">"79125"</span><span class="o">);</span>
<span class="n">address</span><span class="o">.</span><span class="na">line1</span><span class="o">(</span><span class="s">"Av. Pie de la cuesta #12"</span><span class="o">);</span>
<span class="n">address</span><span class="o">.</span><span class="na">line2</span><span class="o">(</span><span class="s">"Desarrollo San Pablo"</span><span class="o">);</span>
<span class="n">address</span><span class="o">.</span><span class="na">line3</span><span class="o">(</span><span class="s">"Qro. Qro."</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">address</span><span class="o">(</span><span class="n">address</span><span class="o">);</span>

<span class="n">request</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="na">customers</span><span class="o">().</span><span class="na">update</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">OpenpayAPI</span><span class="p">(</span><span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="p">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="p">);</span>
<span class="n">Customer</span> <span class="n">request</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Customer</span><span class="p">();</span>
<span class="n">request</span><span class="p">.</span><span class="n">Name</span> <span class="p">=</span> <span class="s">"Julian Gerardo"</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">LastName</span> <span class="p">=</span> <span class="s">"LÃ³pez MartÃ­nez"</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">Email</span> <span class="p">=</span> <span class="s">"julian.martinez@gmail.com"</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">PhoneNumber</span> <span class="p">=</span> <span class="s">"4421432915"</span><span class="p">;</span>
<span class="n">Address</span> <span class="n">address</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Address</span><span class="p">();</span>
<span class="n">address</span><span class="p">.</span><span class="n">City</span> <span class="p">=</span> <span class="s">"Queretaro"</span><span class="p">;</span>
<span class="n">address</span><span class="p">.</span><span class="n">CountryCode</span> <span class="p">=</span> <span class="s">"MX"</span><span class="p">;</span>
<span class="n">address</span><span class="p">.</span><span class="n">State</span> <span class="p">=</span> <span class="s">"Queretaro"</span><span class="p">;</span>
<span class="n">address</span><span class="p">.</span><span class="n">PostalCode</span> <span class="p">=</span> <span class="s">"79125"</span><span class="p">;</span>
<span class="n">address</span><span class="p">.</span><span class="n">Line1</span> <span class="p">=</span> <span class="s">"Av. Pie de la cuesta #12"</span><span class="p">;</span>
<span class="n">address</span><span class="p">.</span><span class="n">Line2</span> <span class="p">=</span> <span class="s">"Desarrollo San Pablo"</span><span class="p">;</span>
<span class="n">address</span><span class="p">.</span><span class="n">Line3</span> <span class="p">=</span> <span class="s">"Qro. Qro."</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">Address</span> <span class="p">=</span> <span class="n">address</span><span class="p">;</span>

<span class="n">request</span> <span class="p">=</span> <span class="n">api</span><span class="p">.</span><span class="n">CustomerService</span><span class="p">.</span><span class="nf">Update</span><span class="p">(</span><span class="n">request</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="kd">var</span> <span class="nx">customerRequest</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'name'</span><span class="err">:</span> <span class="s1">'customer name'</span><span class="p">,</span>
    <span class="s1">'email'</span><span class="err">:</span> <span class="s1">'customer_email@me.com'</span><span class="p">,</span>
    <span class="s1">'address'</span><span class="err">:</span><span class="p">{</span>
      <span class="s1">'city'</span><span class="err">:</span><span class="s1">'Queretaro'</span><span class="p">,</span>
      <span class="s1">'state'</span><span class="err">:</span><span class="s1">'Queretaro'</span><span class="p">,</span>
      <span class="s1">'line1'</span><span class="err">:</span><span class="s1">'Calle 10'</span><span class="p">,</span>
      <span class="s1">'postal_code'</span><span class="err">:</span><span class="s1">'76000'</span><span class="p">,</span>
      <span class="s1">'line2'</span><span class="err">:</span><span class="s1">'col. san pablo'</span><span class="p">,</span>
      <span class="s1">'line3'</span><span class="err">:</span><span class="s1">'entre la calle 1 y la 2'</span><span class="p">,</span>
      <span class="s1">'country_code'</span><span class="err">:</span><span class="s1">'MX'</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="s1">'anbnldwgni1way3yp2dw'</span><span class="p">,</span> <span class="nx">customerRequest</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">customer</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// ... 
</span><span class="p">});</span>
</pre><pre class="highlight ruby"><span class="vi">@openpay</span><span class="o">=</span><span class="no">OpenpayApi</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"mzdtln0bmtms6o3kck8f"</span><span class="p">,</span><span class="s2">"sk_e568c42a6c384b7ab02cd47d2e407cab"</span><span class="p">)</span>
<span class="vi">@customers</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:customers</span><span class="p">)</span>
<span class="n">address_hash</span><span class="o">=</span><span class="p">{</span>
      <span class="s2">"line1"</span> <span class="o">=&gt;</span> <span class="s2">"Calle 10"</span><span class="p">,</span>
      <span class="s2">"line2"</span> <span class="o">=&gt;</span> <span class="s2">"col. san pablo"</span><span class="p">,</span>
      <span class="s2">"line3"</span> <span class="o">=&gt;</span> <span class="s2">"entre la calle 1 y la 2"</span><span class="p">,</span>
      <span class="s2">"state"</span> <span class="o">=&gt;</span> <span class="s2">"Queretaro"</span><span class="p">,</span>
      <span class="s2">"city"</span> <span class="o">=&gt;</span> <span class="s2">"Queretaro"</span><span class="p">,</span>
      <span class="s2">"postal_code"</span> <span class="o">=&gt;</span> <span class="s2">"76000"</span><span class="p">,</span>
      <span class="s2">"country_code"</span> <span class="o">=&gt;</span> <span class="s2">"MX"</span>
   <span class="p">}</span>
<span class="n">request_hash</span><span class="o">=</span><span class="p">{</span>
     <span class="s2">"external_id"</span> <span class="o">=&gt;</span> <span class="kp">nil</span><span class="p">,</span>
     <span class="s2">"name"</span> <span class="o">=&gt;</span> <span class="s2">"customer name"</span><span class="p">,</span>
     <span class="s2">"last_name"</span> <span class="o">=&gt;</span> <span class="kp">nil</span><span class="p">,</span>
     <span class="s2">"email"</span> <span class="o">=&gt;</span> <span class="s2">"customer_email@me.com"</span><span class="p">,</span>
     <span class="s2">"phone_number"</span> <span class="o">=&gt;</span> <span class="s2">"44209087654"</span><span class="p">,</span>
     <span class="s2">"address"</span> <span class="o">=&gt;</span> <span class="n">address_hash</span>
   <span class="p">}</span>

<span class="n">response_hash</span><span class="o">=</span><span class="vi">@customers</span><span class="p">.</span><span class="nf">update</span><span class="p">(</span><span class="n">request_hash</span><span class="p">.</span><span class="nf">to_hash</span><span class="p">)</span>
</pre>
<blockquote>
<p>Response example</p>
</blockquote>
<pre class="highlight json"><span class="p">{</span><span class="w">
   </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"anbnldwgni1way3yp2dw"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"name"</span><span class="p">:</span><span class="s2">"customer name"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"last_name"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
   </span><span class="s2">"email"</span><span class="p">:</span><span class="s2">"customer_email@me.com"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"phone_number"</span><span class="p">:</span><span class="s2">"44209087654"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"address"</span><span class="p">:{</span><span class="w">
      </span><span class="s2">"line1"</span><span class="p">:</span><span class="s2">"Calle 10"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"line2"</span><span class="p">:</span><span class="s2">"col. san pablo"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"line3"</span><span class="p">:</span><span class="s2">"entre la calle 1 y la 2"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"state"</span><span class="p">:</span><span class="s2">"Queretaro"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"city"</span><span class="p">:</span><span class="s2">"Queretaro"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"postal_code"</span><span class="p">:</span><span class="s2">"76000"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"country_code"</span><span class="p">:</span><span class="s2">"MX"</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="s2">"store"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"reference"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OPENPAY02DQ35YOY7"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"barcode_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://sandbox-api.openpay.mx/barcode/OPENPAY02DQ35YOY7?width=1&amp;height=45&amp;text=false"</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="s2">"clabe"</span><span class="p">:</span><span class="w"> </span><span class="s2">"646180109400423323"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="s2">"2014-05-20T16:47:47-05:00"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"external_id"</span><span class="p">:</span><span class="err">null</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<p>Updates one or more data of the customer. </p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td><strong><em>string</em></strong> (required, length = 100)<br/>Name of the customer.</td>
</tr>
<tr>
<td>last_name</td>
<td><strong><em>string</em></strong> (optional, length = 100)<br/>Last name of the customer.</td>
</tr>
<tr>
<td>email</td>
<td><strong><em>string</em></strong> (required, length = 100)<br/>Email of the customer.</td>
</tr>
<tr>
<td>phone_number</td>
<td><strong><em>string</em></strong> (optional, length = 100) <br/>Telephone number of the customer.</td>
</tr>
<tr>
<td><a href="#address-object">address</a></td>
<td><strong><em>object</em></strong> (optional) <br/>Address of the customer. It is usually used as shipping address.</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<p>Returns a <a href="#customer-object">customer object</a> with the updated info, or returns an <a href="#error-object">error response</a> if a problem happened while updating.</p>

<h2 id="get-an-existing-customer">Get an existing customer</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell">GET https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/customers/<span class="o">{</span>CUSTOMER_ID<span class="o">}</span>
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">customerId</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">openpayAPI</span><span class="o">.</span><span class="na">customers</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="n">String</span> <span class="n">customerId</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">openpayAPI</span><span class="p">.</span><span class="n">CustomerService</span><span class="p">.</span><span class="nf">Update</span><span class="p">(</span><span class="kt">string</span> <span class="n">customer_id</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">customerId</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
</pre><pre class="highlight ruby"><span class="vi">@customers</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:customers</span><span class="p">)</span>
<span class="vi">@customers</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">customer_id</span><span class="p">)</span>
</pre>
<blockquote>
<p>Request example </p>
</blockquote>
<pre class="highlight shell">curl https://sandbox-api.openpay.mx/v1/mzdtln0bmtms6o3kck8f/customers/anbnldwgni1way3yp2dw <span class="se">\</span>
   -u sk_e568c42a6c384b7ab02cd47d2e407cab: <span class="se">\</span>
   -H <span class="s2">"Content-type: application/json"</span> 
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$openpay</span> <span class="o">=</span> <span class="nx">Openpay</span><span class="o">::</span><span class="na">getInstance</span><span class="p">(</span><span class="s1">'moiep6umtcnanql3jrxp'</span><span class="p">,</span> <span class="s1">'sk_3433941e467c1055b178ce26348b0fac'</span><span class="p">);</span>

<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'a9ualumwnrcxkl42l6mh'</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OpenpayAPI</span><span class="o">(</span><span class="s">"https://sandbox-api.openpay.mx"</span><span class="o">,</span> <span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="o">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="o">);</span>
<span class="n">Customer</span> <span class="n">customer</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="na">customers</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="s">"a9pvykxz4g5rg0fplze0"</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">OpenpayAPI</span><span class="p">(</span><span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="p">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="p">);</span>
<span class="n">Customer</span> <span class="n">customer</span> <span class="p">=</span> <span class="n">api</span><span class="p">.</span><span class="n">CustomerService</span><span class="p">.</span><span class="nf">Update</span><span class="p">(</span><span class="s">"a9pvykxz4g5rg0fplze0"</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'a9pvykxz4g5rg0fplze0'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">customer</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// ... 
</span><span class="p">});</span>
</pre><pre class="highlight ruby"><span class="vi">@openpay</span><span class="o">=</span><span class="no">OpenpayApi</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"mzdtln0bmtms6o3kck8f"</span><span class="p">,</span><span class="s2">"sk_e568c42a6c384b7ab02cd47d2e407cab"</span><span class="p">)</span>
<span class="vi">@customers</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:customers</span><span class="p">)</span>

<span class="n">response_hash</span><span class="o">=</span><span class="vi">@customers</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="s2">"asynwirguzkgq2bizogo"</span><span class="p">)</span>
</pre>
<blockquote>
<p>Response example</p>
</blockquote>
<pre class="highlight json"><span class="p">{</span><span class="w">
   </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"anbnldwgni1way3yp2dw"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"name"</span><span class="p">:</span><span class="s2">"customer name"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"last_name"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
   </span><span class="s2">"email"</span><span class="p">:</span><span class="s2">"customer_email@me.com"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"phone_number"</span><span class="p">:</span><span class="s2">"44209087654"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"address"</span><span class="p">:{</span><span class="w">
      </span><span class="s2">"line1"</span><span class="p">:</span><span class="s2">"Calle 10"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"line2"</span><span class="p">:</span><span class="s2">"col. san pablo"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"line3"</span><span class="p">:</span><span class="s2">"entre la calle 1 y la 2"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"state"</span><span class="p">:</span><span class="s2">"Queretaro"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"city"</span><span class="p">:</span><span class="s2">"Queretaro"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"postal_code"</span><span class="p">:</span><span class="s2">"76000"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"country_code"</span><span class="p">:</span><span class="s2">"MX"</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="s2">"store"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
       </span><span class="s2">"reference"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OPENPAY02DQ35YOY7"</span><span class="p">,</span><span class="w">
       </span><span class="s2">"barcode_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://sandbox-api.openpay.mx/barcode/OPENPAY02DQ35YOY7?width=1&amp;height=45&amp;text=false"</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="s2">"clabe"</span><span class="p">:</span><span class="w"> </span><span class="s2">"646180109400423323"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="s2">"2014-05-20T16:47:47-05:00"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"external_id"</span><span class="p">:</span><span class="err">null</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<p>Gets the current information of an existing customer. You only need to specify the id returned when creating the customer.</p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td><em><strong>string</strong></em> (required, legth = 45)<br/>Unique identifier of the customer.</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<p>If the identifier exists, it returns a <a href="#customer-object">customer object</a> with the customer information.</p>

<h2 id="delete-a-customer">Delete a customer</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell">DELETE https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/customers/<span class="o">{</span>CUSTOMER_ID<span class="o">}</span>
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">customerId</span><span class="p">);</span>
<span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">delete</span><span class="p">();</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">openpayAPI</span><span class="o">.</span><span class="na">customers</span><span class="o">().</span><span class="na">delete</span><span class="o">(</span><span class="n">String</span> <span class="n">customerId</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">openpayAPI</span><span class="p">.</span><span class="n">CustomerService</span><span class="p">.</span><span class="nf">Delete</span><span class="p">(</span><span class="kt">string</span> <span class="n">customer_id</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="k">delete</span><span class="p">(</span><span class="nx">customerId</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
</pre><pre class="highlight ruby"><span class="vi">@customers</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:customers</span><span class="p">)</span>
<span class="vi">@customers</span><span class="p">.</span><span class="nf">delete</span><span class="p">(</span><span class="n">customer_id</span><span class="p">)</span>
</pre>
<blockquote>
<p>Request example </p>
</blockquote>
<pre class="highlight shell">curl https://sandbox-api.openpay.mx/v1/mzdtln0bmtms6o3kck8f/customers/anbnldwgni1way3yp2dw <span class="se">\</span>
   -u sk_e568c42a6c384b7ab02cd47d2e407cab: <span class="se">\</span>
   -H <span class="s2">"Content-type: application/json"</span> <span class="se">\</span>
   -X DELETE
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$openpay</span> <span class="o">=</span> <span class="nx">Openpay</span><span class="o">::</span><span class="na">getInstance</span><span class="p">(</span><span class="s1">'moiep6umtcnanql3jrxp'</span><span class="p">,</span> <span class="s1">'sk_3433941e467c1055b178ce26348b0fac'</span><span class="p">);</span>

<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'a9ualumwnrcxkl42l6mh'</span><span class="p">);</span>
<span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">delete</span><span class="p">();</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OpenpayAPI</span><span class="o">(</span><span class="s">"https://sandbox-api.openpay.mx"</span><span class="o">,</span> <span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="o">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="o">);</span>
<span class="n">api</span><span class="o">.</span><span class="na">customers</span><span class="o">().</span><span class="na">delete</span><span class="o">(</span><span class="s">"a9pvykxz4g5rg0fplze0"</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">OpenpayAPI</span><span class="p">(</span><span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="p">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="p">);</span>
<span class="n">api</span><span class="p">.</span><span class="n">CustomerService</span><span class="p">.</span><span class="nf">Delete</span><span class="p">(</span><span class="s">"a9pvykxz4g5rg0fplze0"</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="k">delete</span><span class="p">(</span><span class="s1">'a9pvykxz4g5rg0fplze0'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// ... 
</span><span class="p">});</span>
</pre><pre class="highlight ruby"><span class="vi">@openpay</span><span class="o">=</span><span class="no">OpenpayApi</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"mzdtln0bmtms6o3kck8f"</span><span class="p">,</span><span class="s2">"sk_e568c42a6c384b7ab02cd47d2e407cab"</span><span class="p">)</span>
<span class="vi">@customers</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:customers</span><span class="p">)</span>

<span class="n">response_hash</span><span class="o">=</span><span class="vi">@customers</span><span class="p">.</span><span class="nf">delete</span><span class="p">(</span><span class="s2">"asynwirguzkgq2bizogo"</span><span class="p">)</span>
</pre>
<p>Deletes a customer permanently. All the related subscriptions will be canceled. Openpay keeps the operations records.</p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td><em><strong>string</strong></em> (required, length = 45)<br/> Unique identifier of the customer you want to delete.</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<p>If the customer is deleted correctly, it returns an empty response, if the customer can not be deleted it returns a <a href="#error-object">error object</a> explaining the reason.</p>

<h2 id="list-of-customers">List of customers</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell">GET https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/customers
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$customerList</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">getList</span><span class="p">(</span><span class="nx">findDataRequest</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">openpayAPI</span><span class="o">.</span><span class="na">customers</span><span class="o">().</span><span class="na">list</span><span class="o">(</span><span class="n">SearchParams</span> <span class="n">request</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">openpayAPI</span><span class="p">.</span><span class="n">CustomerService</span><span class="p">.</span><span class="nf">List</span><span class="p">(</span><span class="n">SearchParams</span> <span class="n">request</span> <span class="p">=</span> <span class="k">null</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">list</span><span class="p">(</span><span class="nx">callback</span><span class="p">);</span>
<span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">list</span><span class="p">(</span><span class="nx">searchParams</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
</pre><pre class="highlight ruby"><span class="vi">@customers</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:customers</span><span class="p">)</span>
<span class="vi">@customers</span><span class="p">.</span><span class="nf">all</span>
</pre>
<blockquote>
<p>Request example </p>
</blockquote>
<pre class="highlight shell">curl -g <span class="s2">"https://sandbox-api.openpay.mx/v1/mzdtln0bmtms6o3kck8f/customers?creation[gte]=2013-11-01&amp;limit=2"</span> <span class="se">\</span>
   -u sk_e568c42a6c384b7ab02cd47d2e407cab: <span class="se">\</span>
   -H <span class="s2">"Content-type: application/json"</span> 
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$openpay</span> <span class="o">=</span> <span class="nx">Openpay</span><span class="o">::</span><span class="na">getInstance</span><span class="p">(</span><span class="s1">'moiep6umtcnanql3jrxp'</span><span class="p">,</span> <span class="s1">'sk_3433941e467c1055b178ce26348b0fac'</span><span class="p">);</span>

<span class="nv">$findDataRequest</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'creation[gte]'</span> <span class="o">=&gt;</span> <span class="s1">'2013-01-01'</span><span class="p">,</span>
    <span class="s1">'creation[lte]'</span> <span class="o">=&gt;</span> <span class="s1">'2013-12-31'</span><span class="p">,</span>
    <span class="s1">'offset'</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">'limit'</span> <span class="o">=&gt;</span> <span class="mi">5</span><span class="p">);</span>

<span class="nv">$customerList</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">getList</span><span class="p">(</span><span class="nv">$findDataRequest</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="kd">final</span> <span class="n">Calendar</span> <span class="n">dateGte</span> <span class="o">=</span> <span class="n">Calendar</span><span class="o">.</span><span class="na">getInstance</span><span class="o">();</span>
<span class="kd">final</span> <span class="n">Calendar</span> <span class="n">dateLte</span> <span class="o">=</span> <span class="n">Calendar</span><span class="o">.</span><span class="na">getInstance</span><span class="o">();</span>
<span class="n">dateGte</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="mi">2014</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">);</span>
<span class="n">dateLte</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="mi">2014</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">15</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">);</span>

<span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OpenpayAPI</span><span class="o">(</span><span class="s">"https://sandbox-api.openpay.mx"</span><span class="o">,</span> <span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="o">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="o">);</span>
<span class="n">SearchParams</span> <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SearchParams</span><span class="o">();</span>
<span class="n">request</span><span class="o">.</span><span class="na">creationGte</span><span class="o">(</span><span class="n">dateGte</span><span class="o">.</span><span class="na">getTime</span><span class="o">());</span>
<span class="n">request</span><span class="o">.</span><span class="na">creationLte</span><span class="o">(</span><span class="n">dateLte</span><span class="o">.</span><span class="na">getTime</span><span class="o">());</span>
<span class="n">request</span><span class="o">.</span><span class="na">offset</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">limit</span><span class="o">(</span><span class="mi">100</span><span class="o">);</span>

<span class="n">List</span><span class="o">&lt;</span><span class="n">Customer</span><span class="o">&gt;</span> <span class="n">customers</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="na">customers</span><span class="o">().</span><span class="na">list</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">OpenpayAPI</span><span class="p">(</span><span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="p">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="p">);</span>
<span class="n">SearchParams</span> <span class="n">request</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SearchParams</span><span class="p">();</span>
<span class="n">request</span><span class="p">.</span><span class="n">CreationGte</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Datetime</span><span class="p">(</span><span class="m">2014</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">1</span><span class="p">);</span>
<span class="n">request</span><span class="p">.</span><span class="n">CreationLte</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">2014</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">15</span><span class="p">);</span>
<span class="n">request</span><span class="p">.</span><span class="n">Offset</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">Limit</span> <span class="p">=</span> <span class="m">100</span><span class="p">;</span>

<span class="n">List</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;</span> <span class="n">customers</span> <span class="p">=</span> <span class="n">api</span><span class="p">.</span><span class="n">CustomerService</span><span class="p">.</span><span class="nf">List</span><span class="p">(</span><span class="n">request</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="kd">var</span> <span class="nx">searchParams</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">'creation[gte]'</span> <span class="err">:</span> <span class="s1">'2013-11-01'</span><span class="p">,</span>
  <span class="s1">'limit'</span> <span class="err">:</span> <span class="mi">2</span>
<span class="p">};</span>

<span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">list</span><span class="p">(</span><span class="nx">searchParams</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">list</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// ...
</span><span class="p">});</span>
</pre><pre class="highlight ruby"><span class="vi">@openpay</span><span class="o">=</span><span class="no">OpenpayApi</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"mzdtln0bmtms6o3kck8f"</span><span class="p">,</span><span class="s2">"sk_e568c42a6c384b7ab02cd47d2e407cab"</span><span class="p">)</span>
<span class="vi">@customers</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:customers</span><span class="p">)</span>

<span class="n">response_hash</span><span class="o">=</span><span class="vi">@customers</span><span class="p">.</span><span class="nf">all</span>
</pre>
<blockquote>
<p>Response example</p>
</blockquote>
<pre class="highlight json"><span class="p">[{</span><span class="w">
   </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"cpjdhf754ythr65yu9k7q"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="s2">"2013-11-08T12:04:46-06:00"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"name"</span><span class="p">:</span><span class="s2">"Rodrigo"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"last_name"</span><span class="p">:</span><span class="s2">"Velazco Perez"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"email"</span><span class="p">:</span><span class="s2">"rodrigo.velazco@payments.com"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"phone_number"</span><span class="p">:</span><span class="s2">"4425667045"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"status"</span><span class="p">:</span><span class="s2">"active"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"balance"</span><span class="p">:</span><span class="mf">142.5</span><span class="w">
   </span><span class="s2">"store"</span><span class="err">:</span><span class="w"> </span><span class="p">{</span><span class="w">
       </span><span class="s2">"reference"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OPENPAY02DQ35YOY7"</span><span class="p">,</span><span class="w">
       </span><span class="s2">"barcode_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://sandbox-api.openpay.mx/barcode/OPENPAY02DQ35YOY7?width=1&amp;height=45&amp;text=false"</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="s2">"clabe"</span><span class="p">:</span><span class="w"> </span><span class="s2">"646180109400423323"</span><span class="w">
</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
   </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"cz4nkhrlcu9k7qd4lwqx"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="s2">"2013-11-07T14:54:46-06:00"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"name"</span><span class="p">:</span><span class="s2">"Eriberto"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"last_name"</span><span class="p">:</span><span class="s2">"Rodriguez Lopez"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"email"</span><span class="p">:</span><span class="s2">"eriberto.rodriguez@payments.com"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"phone_number"</span><span class="p">:</span><span class="s2">"442"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"status"</span><span class="p">:</span><span class="s2">"active"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"balance"</span><span class="p">:</span><span class="mi">103</span><span class="p">,</span><span class="w">
   </span><span class="s2">"store"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
       </span><span class="s2">"reference"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OPENPAY02DQ35DRE4"</span><span class="p">,</span><span class="w">
       </span><span class="s2">"barcode_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://sandbox-api.openpay.mx/barcode/OPENPAY02DQ35DRE4?width=1&amp;height=45&amp;text=false"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"clabe"</span><span class="p">:</span><span class="w"> </span><span class="s2">"646180109400423323"</span><span class="w">
</span><span class="p">}]</span><span class="w">
</span></pre>
<p>Returns a list of registered customers, if you want to delimit the result you may use filters.</p>

<h3 id="request">Request</h3>

<p>You can search using the following parameters as filters.</p>

<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>creation</td>
<td><strong><em>date</em></strong> <br/>Same as the customer creation date. Format yyyy-mm-dd</td>
</tr>
<tr>
<td>creation[gte]</td>
<td><strong><em>date</em></strong> <br/>After the customer creation date .Format yyyy-mm-dd</td>
</tr>
<tr>
<td>creation[lte]</td>
<td><strong><em>date</em></strong> <br/>Before the customer creation date.Format yyyy-mm-dd</td>
</tr>
<tr>
<td>offset</td>
<td><strong><em>numeric</em></strong> <br/>Number of records to skip at the beginning, default 0.</td>
</tr>
<tr>
<td>limit</td>
<td><strong><em>numeric</em></strong> <br/>Number of required records, default 10.</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<p>Returns an array of <a href="#customer-object">customer object</a>.</p>

<h1 id="transfers">Transfers</h1>

<p>The transfers allow to send funds between accounts of your customers. </p>

<p><aside class="notice">
<strong>Note:</strong> If you want to make a transfer to a bank see the <a href="#payouts-or-withdrawals">payouts section</a>.
</aside></p>

<h2 id="transfers-between-customers">Transfers between customers</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell">POST https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/customers/<span class="o">{</span>CUSTOMER_ID<span class="o">}</span>/transfers
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">customerId</span><span class="p">);</span>
<span class="nv">$transfer</span> <span class="o">=</span> <span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">transfers</span><span class="o">-&gt;</span><span class="na">create</span><span class="p">(</span><span class="nx">transferDataRequest</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">openpayAPI</span><span class="o">.</span><span class="na">transfers</span><span class="o">().</span><span class="na">create</span><span class="o">(</span><span class="n">String</span> <span class="n">customerId</span><span class="o">,</span> <span class="n">CreateTransferParams</span> <span class="n">request</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">openpayAPI</span><span class="p">.</span><span class="n">TransferService</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="kt">string</span> <span class="n">from_customer_id</span><span class="p">,</span> <span class="n">TransferRequest</span> <span class="n">request</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">transfers</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">customerId</span><span class="p">,</span> <span class="nx">transferRequest</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
</pre><pre class="highlight ruby"><span class="vi">@transfers</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:transfers</span><span class="p">)</span>
<span class="vi">@transfers</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="n">request_hash</span><span class="p">,</span> <span class="n">from_customer_id</span><span class="p">)</span>
</pre>
<blockquote>
<p>Request example</p>
</blockquote>
<pre class="highlight shell">curl https://sandbox-api.openpay.mx/v1/mzdtln0bmtms6o3kck8f/customers/ag4nktpdzebjiye1tlze/transfers <span class="se">\</span>
   -u sk_e568c42a6c384b7ab02cd47d2e407cab: <span class="se">\</span>
   -H <span class="s2">"Content-type: application/json"</span> <span class="se">\</span>
   -X POST -d <span class="s1">'{                                            
     "customer_id" : "dvocf97jd20es3tw5laz",
     "amount" : 12.50,          
     "description" : "Transferencia entre cuentas",
     "order_id" : "oid-1245"
}'</span> 
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$openpay</span> <span class="o">=</span> <span class="nx">Openpay</span><span class="o">::</span><span class="na">getInstance</span><span class="p">(</span><span class="s1">'moiep6umtcnanql3jrxp'</span><span class="p">,</span> <span class="s1">'sk_3433941e467c1055b178ce26348b0fac'</span><span class="p">);</span>

<span class="nv">$transferDataRequest</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'customer_id'</span> <span class="o">=&gt;</span> <span class="s1">'aqedin0owpu0kexr2eor'</span><span class="p">,</span>
    <span class="s1">'amount'</span> <span class="o">=&gt;</span> <span class="mf">12.50</span><span class="p">,</span>
    <span class="s1">'description'</span> <span class="o">=&gt;</span> <span class="s1">'Cobro de ComisiÃ³n'</span><span class="p">,</span>
    <span class="s1">'order_id'</span> <span class="o">=&gt;</span> <span class="s1">'ORDEN-00061'</span><span class="p">);</span>

<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'a9ualumwnrcxkl42l6mh'</span><span class="p">);</span>
<span class="nv">$transfer</span> <span class="o">=</span> <span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">transfers</span><span class="o">-&gt;</span><span class="na">create</span><span class="p">(</span><span class="nv">$transferDataRequest</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OpenpayAPI</span><span class="o">(</span><span class="s">"https://sandbox-api.openpay.mx"</span><span class="o">,</span> <span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="o">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="o">);</span>
<span class="n">CreateTransferParams</span> <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CreateTransferParams</span><span class="o">();</span>
<span class="n">request</span><span class="o">.</span><span class="na">toCustomerId</span><span class="o">(</span><span class="s">"ah1ki9jmb50mvlsf9gqn"</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">amount</span><span class="o">(</span><span class="k">new</span> <span class="n">BigDecimal</span><span class="o">(</span><span class="s">"100.00"</span><span class="o">));</span>
<span class="n">request</span><span class="o">.</span><span class="na">description</span><span class="o">(</span><span class="s">"Transferencia del Customer 1 al Customer 2"</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">orderId</span><span class="o">(</span><span class="s">"idOrdExt-0101"</span><span class="o">);</span>

<span class="n">Transfer</span> <span class="n">transfer</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="na">transfers</span><span class="o">().</span><span class="na">create</span><span class="o">(</span><span class="s">"a9pvykxz4g5rg0fplze0"</span><span class="o">,</span> <span class="n">request</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">OpenpayAPI</span><span class="p">(</span><span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="p">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="p">);</span>
<span class="n">TransferRequest</span> <span class="n">request</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">TransferRequest</span><span class="p">();</span>
<span class="n">request</span><span class="p">.</span><span class="n">CustomerId</span> <span class="p">=</span> <span class="s">"ah1ki9jmb50mvlsf9gqn"</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">Amount</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Decimal</span><span class="p">(</span><span class="m">100.00</span><span class="p">);</span>
<span class="n">request</span><span class="p">.</span><span class="n">Description</span> <span class="p">=</span> <span class="s">"Transferencia del Customer 1 al Customer 2"</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">OrderId</span> <span class="p">=</span> <span class="s">"idOrdExt-0101"</span><span class="p">;</span>

<span class="n">Transfer</span> <span class="n">transfer</span> <span class="p">=</span> <span class="n">api</span><span class="p">.</span><span class="n">TransferService</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="s">"a9pvykxz4g5rg0fplze0"</span><span class="p">,</span> <span class="n">request</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="kd">var</span> <span class="nx">transferRequest</span> <span class="o">=</span> <span class="p">{</span>                                          
  <span class="s1">'customer_id'</span> <span class="err">:</span> <span class="s1">'dvocf97jd20es3tw5laz'</span><span class="p">,</span>
  <span class="s1">'amount'</span> <span class="err">:</span> <span class="mf">12.50</span><span class="p">,</span>          
  <span class="s1">'description'</span> <span class="err">:</span> <span class="s1">'Transferencia entre cuentas'</span><span class="p">,</span>
  <span class="s1">'order_id'</span> <span class="err">:</span> <span class="s1">'oid-1245'</span>
<span class="p">};</span>

<span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">transfers</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="s1">'ag4nktpdzebjiye1tlze'</span><span class="p">,</span> <span class="nx">transferRequest</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">transfer</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// ...
</span><span class="p">});</span>
</pre><pre class="highlight ruby"><span class="vi">@openpay</span><span class="o">=</span><span class="no">OpenpayApi</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"mzdtln0bmtms6o3kck8f"</span><span class="p">,</span><span class="s2">"sk_e568c42a6c384b7ab02cd47d2e407cab"</span><span class="p">)</span>
<span class="vi">@transfers</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:transfers</span><span class="p">)</span>
<span class="n">request_hash</span><span class="o">=</span><span class="p">{</span>
     <span class="s2">"customer_id"</span> <span class="o">=&gt;</span> <span class="s2">"dvocf97jd20es3tw5laz"</span><span class="p">,</span>
     <span class="s2">"amount"</span> <span class="o">=&gt;</span> <span class="mi">12</span><span class="o">.</span><span class="mi">50</span><span class="p">,</span>
     <span class="s2">"description"</span> <span class="o">=&gt;</span> <span class="s2">"Transferencia entre cuentas"</span><span class="p">,</span>
     <span class="s2">"order_id"</span> <span class="o">=&gt;</span> <span class="s2">"oid-1245"</span>
   <span class="p">}</span>

<span class="n">response_hash</span><span class="o">=</span><span class="vi">@transfers</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="n">request_hash</span><span class="p">.</span><span class="nf">to_hash</span><span class="p">,</span> <span class="s2">"ag4nktpdzebjiye1tlze"</span><span class="p">)</span>
</pre>
<blockquote>
<p>Response example</p>
</blockquote>
<pre class="highlight json"><span class="p">{</span><span class="w">
   </span><span class="s2">"amount"</span><span class="p">:</span><span class="mf">12.50</span><span class="p">,</span><span class="w">
   </span><span class="s2">"authorization"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
   </span><span class="s2">"method"</span><span class="p">:</span><span class="s2">"customer"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"operation_type"</span><span class="p">:</span><span class="s2">"out"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"currency"</span><span class="p">:</span><span class="s2">"MXN"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"transaction_type"</span><span class="p">:</span><span class="s2">"transfer"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"status"</span><span class="p">:</span><span class="s2">"completed"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"twpmbike2jejex3pahzd"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="s2">"2013-11-15T10:33:19-06:00"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"description"</span><span class="p">:</span><span class="s2">"Transferencia entre cuentas"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"error_message"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
   </span><span class="s2">"order_id"</span><span class="p">:</span><span class="s2">"oid-1245"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"customer_id"</span><span class="p">:</span><span class="s2">"a9pvykxz4g5rg0fplze0"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"store"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
       </span><span class="s2">"reference"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OPENPAY02DQ35YOY7"</span><span class="p">,</span><span class="w">
       </span><span class="s2">"barcode_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://sandbox-api.openpay.mx/barcode/OPENPAY02DQ35YOY7?width=1&amp;height=45&amp;text=false"</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="s2">"clabe"</span><span class="p">:</span><span class="w"> </span><span class="s2">"646180109400423323"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<p>Makes the transfer of funds from one account of the customer to another. The funds will be charged to an origin account and added to a destination account, which will create two transactions.</p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>customer_id</td>
<td><strong><em>string</em></strong> (required, length = 45) <br/>The Openpay ID of the customer you want to send the funds.</td>
</tr>
<tr>
<td>amount</td>
<td><strong><em>numeric</em></strong> (required) <br/>Amount to transfer. It must be an amount greater than one peso with up to two decimal digits.</td>
</tr>
<tr>
<td>description</td>
<td><strong><em>string</em></strong> (required, length = 250) <br/>A description associated to the transfer.</td>
</tr>
<tr>
<td>order_id</td>
<td><strong><em>string</em></strong> (optional, length = 100) <br/>Unique identifier of the transfer. It will be assigned to the withdrawal transaction.</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<p>If the transaction is successful, the response will contain a <a href="#transaction-object">transaction object</a>. This object represents the withdrawal of the account of the current customer. On error, the error object will be returned.</p>

<h2 id="get-a-transfer">Get a transfer</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell">GET https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/customers/<span class="o">{</span>CUSTOMER_ID<span class="o">}</span>/transfers/<span class="o">{</span>TRANSACTION_ID<span class="o">}</span>
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">customerId</span><span class="p">);</span>
<span class="nv">$transfer</span> <span class="o">=</span> <span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">transfers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">transactionId</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">openpayAPI</span><span class="o">.</span><span class="na">transfers</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="n">String</span> <span class="n">customerId</span><span class="o">,</span> <span class="n">String</span> <span class="n">transactionId</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">openpayAPI</span><span class="p">.</span><span class="n">TransferService</span><span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="kt">string</span> <span class="n">customer_id</span><span class="p">,</span> <span class="kt">string</span> <span class="n">transaction_id</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">transfers</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">customerId</span><span class="p">,</span> <span class="nx">transactionId</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
</pre><pre class="highlight ruby"><span class="vi">@transfers</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:transfers</span><span class="p">)</span>
<span class="vi">@transfers</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">transaction_id</span><span class="p">,</span> <span class="n">customer_id</span><span class="p">)</span>
</pre>
<blockquote>
<p>Request example </p>
</blockquote>
<pre class="highlight shell">curl https://sandbox-api.openpay.mx/v1/mzdtln0bmtms6o3kck8f/customers/ag4nktpdzebjiye1tlze/transfers/twpmbike2jejex3pahzd <span class="se">\</span>
   -u sk_e568c42a6c384b7ab02cd47d2e407cab: <span class="se">\</span>
   -H <span class="s2">"Content-type: application/json"</span> 
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$openpay</span> <span class="o">=</span> <span class="nx">Openpay</span><span class="o">::</span><span class="na">getInstance</span><span class="p">(</span><span class="s1">'moiep6umtcnanql3jrxp'</span><span class="p">,</span> <span class="s1">'sk_3433941e467c1055b178ce26348b0fac'</span><span class="p">);</span>

<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'a9ualumwnrcxkl42l6mh'</span><span class="p">);</span>
<span class="nv">$transfer</span> <span class="o">=</span> <span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">transfers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'tyxesptjtx1bodfdjmlb'</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OpenpayAPI</span><span class="o">(</span><span class="s">"https://sandbox-api.openpay.mx"</span><span class="o">,</span> <span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="o">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="o">);</span>
<span class="n">Transfer</span> <span class="n">transfer</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="na">transfers</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="s">"a9pvykxz4g5rg0fplze0"</span><span class="o">,</span> <span class="s">"tr6cxbcefzatd10guvvw"</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">OpenpayAPI</span><span class="p">(</span><span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="p">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="p">);</span>
<span class="n">Transfer</span> <span class="n">transfer</span> <span class="p">=</span> <span class="n">api</span><span class="p">.</span><span class="n">TransferService</span><span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="s">"a9pvykxz4g5rg0fplze0"</span><span class="p">,</span> <span class="s">"tr6cxbcefzatd10guvvw"</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">transfers</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'ag4nktpdzebjiye1tlze'</span><span class="p">,</span> <span class="s1">'twpmbike2jejex3pahzd'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">transfer</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// ...
</span><span class="p">});</span>
</pre><pre class="highlight ruby"><span class="vi">@openpay</span><span class="o">=</span><span class="no">OpenpayApi</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"mzdtln0bmtms6o3kck8f"</span><span class="p">,</span><span class="s2">"sk_e568c42a6c384b7ab02cd47d2e407cab"</span><span class="p">)</span>
<span class="vi">@transfers</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:transfers</span><span class="p">)</span>

<span class="n">response_hash</span><span class="o">=</span><span class="vi">@transfers</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="s2">"twpmbike2jejex3pahzd"</span><span class="p">,</span> <span class="s2">"ag4nktpdzebjiye1tlze"</span><span class="p">)</span>
</pre>
<blockquote>
<p>Response example</p>
</blockquote>
<pre class="highlight json"><span class="p">{</span><span class="w">
   </span><span class="s2">"amount"</span><span class="p">:</span><span class="mf">12.50</span><span class="p">,</span><span class="w">
   </span><span class="s2">"authorization"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
   </span><span class="s2">"method"</span><span class="p">:</span><span class="s2">"customer"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"operation_type"</span><span class="p">:</span><span class="s2">"out"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"currency"</span><span class="p">:</span><span class="s2">"MXN"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"transaction_type"</span><span class="p">:</span><span class="s2">"transfer"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"status"</span><span class="p">:</span><span class="s2">"completed"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"twpmbike2jejex3pahzd"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="s2">"2013-11-15T10:33:19-06:00"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"description"</span><span class="p">:</span><span class="s2">"Transferencia entre cuentas"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"error_message"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
   </span><span class="s2">"order_id"</span><span class="p">:</span><span class="s2">"oid-1245"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"customer_id"</span><span class="p">:</span><span class="s2">"dvocf97jd20es3tw5laz"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<p>With the customer identifier and the transfer identifier, you can get the details of the transaction. The output transaction will be on the customer from which the transfer was made, and the entry transaction will be on the customer that received the amount.</p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>customer_id</td>
<td><strong><em>string</em></strong> (required, length = 45) <br/> Identifier of the customer.</td>
</tr>
<tr>
<td>transaction_id</td>
<td><strong><em>string</em></strong> (required, length = 45) <br/> Identifier of the transfer.</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<p>Returns a <a href="#transaction-object">transaction object</a></p>

<h2 id="list-of-transfers">List of transfers</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell">GET https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/customers/<span class="o">{</span>CUSTOMER_ID<span class="o">}</span>/transfers
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">customerId</span><span class="p">);</span>
<span class="nv">$transferList</span> <span class="o">=</span> <span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">transfers</span><span class="o">-&gt;</span><span class="na">getList</span><span class="p">(</span><span class="nx">findDataRequest</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">openpayAPI</span><span class="o">.</span><span class="na">transfers</span><span class="o">().</span><span class="na">list</span><span class="o">(</span><span class="n">String</span> <span class="n">customerId</span><span class="o">,</span> <span class="n">SearchParams</span> <span class="n">request</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">openpayAPI</span><span class="p">.</span><span class="n">TransferService</span><span class="p">.</span><span class="nf">List</span><span class="p">(</span><span class="kt">string</span> <span class="n">customer_id</span><span class="p">,</span> <span class="n">SearchParams</span> <span class="n">request</span> <span class="p">=</span> <span class="k">null</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">transfers</span><span class="p">.</span><span class="nx">list</span><span class="p">(</span><span class="nx">customerId</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
<span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">transfers</span><span class="p">.</span><span class="nx">list</span><span class="p">(</span><span class="nx">customerId</span><span class="p">,</span> <span class="nx">searchParams</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
</pre><pre class="highlight ruby"><span class="vi">@transfers</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:transfers</span><span class="p">)</span>
<span class="vi">@transfers</span><span class="p">.</span><span class="nf">all</span><span class="p">(</span><span class="n">customer_id</span><span class="p">)</span>
</pre>
<blockquote>
<p>Request example</p>
</blockquote>
<pre class="highlight shell">curl -g <span class="s2">"https://sandbox-api.openpay.mx/v1/mzdtln0bmtms6o3kck8f/customers/ag4nktpdzebjiye1tlze/transfers?limit=2"</span> <span class="se">\</span>
   -u sk_e568c42a6c384b7ab02cd47d2e407cab: 
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$openpay</span> <span class="o">=</span> <span class="nx">Openpay</span><span class="o">::</span><span class="na">getInstance</span><span class="p">(</span><span class="s1">'moiep6umtcnanql3jrxp'</span><span class="p">,</span> <span class="s1">'sk_3433941e467c1055b178ce26348b0fac'</span><span class="p">);</span>

<span class="nv">$findDataRequest</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'creation[gte]'</span> <span class="o">=&gt;</span> <span class="s1">'2013-01-01'</span><span class="p">,</span>
    <span class="s1">'creation[lte]'</span> <span class="o">=&gt;</span> <span class="s1">'2013-12-31'</span><span class="p">,</span>
    <span class="s1">'offset'</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">'limit'</span> <span class="o">=&gt;</span> <span class="mi">5</span><span class="p">);</span>

<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'a9ualumwnrcxkl42l6mh'</span><span class="p">);</span>
<span class="nv">$transferList</span> <span class="o">=</span> <span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">transfers</span><span class="o">-&gt;</span><span class="na">getList</span><span class="p">(</span><span class="nv">$findDataRequest</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="kd">final</span> <span class="n">Calendar</span> <span class="n">dateGte</span> <span class="o">=</span> <span class="n">Calendar</span><span class="o">.</span><span class="na">getInstance</span><span class="o">();</span>
<span class="kd">final</span> <span class="n">Calendar</span> <span class="n">dateLte</span> <span class="o">=</span> <span class="n">Calendar</span><span class="o">.</span><span class="na">getInstance</span><span class="o">();</span>
<span class="n">dateGte</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="mi">2014</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">);</span>
<span class="n">dateLte</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="mi">2014</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">15</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">);</span>

<span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OpenpayAPI</span><span class="o">(</span><span class="s">"https://sandbox-api.openpay.mx"</span><span class="o">,</span> <span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="o">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="o">);</span>
<span class="n">SearchParams</span> <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SearchParams</span><span class="o">();</span>
<span class="n">request</span><span class="o">.</span><span class="na">creationGte</span><span class="o">(</span><span class="n">dateGte</span><span class="o">.</span><span class="na">getTime</span><span class="o">());</span>
<span class="n">request</span><span class="o">.</span><span class="na">creationLte</span><span class="o">(</span><span class="n">dateLte</span><span class="o">.</span><span class="na">getTime</span><span class="o">());</span>
<span class="n">request</span><span class="o">.</span><span class="na">offset</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">limit</span><span class="o">(</span><span class="mi">100</span><span class="o">);</span>

<span class="n">List</span><span class="o">&lt;</span><span class="n">Transfer</span><span class="o">&gt;</span> <span class="n">transfers</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="na">transfers</span><span class="o">().</span><span class="na">list</span><span class="o">(</span><span class="s">"a9pvykxz4g5rg0fplze0"</span><span class="o">,</span> <span class="n">request</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">OpenpayAPI</span><span class="p">(</span><span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="p">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="p">);</span>
<span class="n">SearchParams</span> <span class="n">request</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SearchParams</span><span class="p">();</span>
<span class="n">request</span><span class="p">.</span><span class="n">CreationGte</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Datetime</span><span class="p">(</span><span class="m">2014</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">1</span><span class="p">);</span>
<span class="n">request</span><span class="p">.</span><span class="n">CreationLte</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">2014</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">15</span><span class="p">);</span>
<span class="n">request</span><span class="p">.</span><span class="n">Offset</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">Limit</span> <span class="p">=</span> <span class="m">100</span><span class="p">;</span>

<span class="n">List</span><span class="p">&lt;</span><span class="n">Transfer</span><span class="p">&gt;</span> <span class="n">transfers</span> <span class="p">=</span> <span class="n">api</span><span class="p">.</span><span class="n">TransferService</span><span class="p">.</span><span class="nf">List</span><span class="p">(</span><span class="s">"a9pvykxz4g5rg0fplze0"</span><span class="p">,</span> <span class="n">request</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="kd">var</span> <span class="nx">searchParams</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">'limit'</span> <span class="err">:</span> <span class="mi">2</span>
<span class="p">};</span>

<span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">transfers</span><span class="p">.</span><span class="nx">list</span><span class="p">(</span><span class="s1">'ag4nktpdzebjiye1tlze'</span><span class="p">,</span> <span class="nx">searchParams</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">list</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// ...
</span><span class="p">});</span>
</pre><pre class="highlight ruby"><span class="vi">@openpay</span><span class="o">=</span><span class="no">OpenpayApi</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"mzdtln0bmtms6o3kck8f"</span><span class="p">,</span><span class="s2">"sk_e568c42a6c384b7ab02cd47d2e407cab"</span><span class="p">)</span>
<span class="vi">@transfers</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:transfers</span><span class="p">)</span>

<span class="n">response_hash</span><span class="o">=</span><span class="vi">@transfers</span><span class="p">.</span><span class="nf">all</span><span class="p">(</span><span class="s2">"asynwirguzkgq2bizogo"</span><span class="p">)</span>
</pre>
<blockquote>
<p>Response example</p>
</blockquote>
<pre class="highlight json"><span class="p">[</span><span class="w">
   </span><span class="p">{</span><span class="w">
      </span><span class="s2">"amount"</span><span class="p">:</span><span class="mf">130.00</span><span class="p">,</span><span class="w">
      </span><span class="s2">"authorization"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"method"</span><span class="p">:</span><span class="s2">"customer"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"currency"</span><span class="p">:</span><span class="s2">"MXN"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"operation_type"</span><span class="p">:</span><span class="s2">"out"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"transaction_type"</span><span class="p">:</span><span class="s2">"transfer"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"status"</span><span class="p">:</span><span class="s2">"completed"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"a74mbe4e2j5gc6gfahzd"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="s2">"2013-09-18T00:31:19-06:00"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"description"</span><span class="p">:</span><span class="s2">"Una descripcion"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"error_message"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"order_id"</span><span class="p">:</span><span class="s2">"20131115103317"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"customer_id"</span><span class="p">:</span><span class="s2">"afk4csrazjp1udezj1po"</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="p">{</span><span class="w">
      </span><span class="s2">"amount"</span><span class="p">:</span><span class="mf">130.00</span><span class="p">,</span><span class="w">
      </span><span class="s2">"authorization"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"method"</span><span class="p">:</span><span class="s2">"customer"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"currency"</span><span class="p">:</span><span class="s2">"MXN"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"operation_type"</span><span class="p">:</span><span class="s2">"in"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"transaction_type"</span><span class="p">:</span><span class="s2">"transfer"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"status"</span><span class="p">:</span><span class="s2">"completed"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"a74mbe4e2j5gc6gfahzd"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="s2">"2013-09-18T00:31:19-06:00"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"description"</span><span class="p">:</span><span class="s2">"Una descripcion"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"error_message"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"order_id"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"customer_id"</span><span class="p">:</span><span class="s2">"agdn58ngcnogqmzruz1i"</span><span class="w">
   </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></pre>
<p>It allows to consult the entry and output transactions of a customer.</p>

<h3 id="request">Request</h3>

<p>You can search using the following parameters as filters.</p>

<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>creation</td>
<td><strong><em>date</em></strong> <br/>Same as creation date. Format yyyy-mm-dd</td>
</tr>
<tr>
<td>creation[gte]</td>
<td><strong><em>date</em></strong> <br/>After the creation date. Format yyyy-mm-dd</td>
</tr>
<tr>
<td>creation[lte]</td>
<td><strong><em>date</em></strong> <br/>Before the creation date. Format yyyy-mm-dd</td>
</tr>
<tr>
<td>offset</td>
<td><strong><em>numeric</em></strong> <br/>Number of records to skip at the beginning, default 0.</td>
</tr>
<tr>
<td>limit</td>
<td><strong><em>numeric</em></strong> <br/>Number of required records, default 10.</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<p>List of [<a href="#transaction-object">transaction objects</a> of the transfers made, each one with the identifier of the customer that made it. The transactions will be listed in descending order by creation date.</p>

<h1 id="cards">Cards</h1>

<p>Within the Openpay platform you can add cards to the customer&rsquo;s account, delete them, recover some in specific and list them.</p>

<p>You can store multiple debit and / or credit cards at Merchant or customer level for making charges later without the need to enter the information again.</p>

<h2 id="card-object">Card Object</h2>

<blockquote>
<p>Object example </p>
</blockquote>
<pre class="highlight json"><span class="p">{</span><span class="w">
   </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"debit"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"brand"</span><span class="p">:</span><span class="s2">"mastercard"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"address"</span><span class="p">:{</span><span class="w">
      </span><span class="s2">"line1"</span><span class="p">:</span><span class="s2">"Av 5 de Febrero"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"line2"</span><span class="p">:</span><span class="s2">"Roble 207"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"line3"</span><span class="p">:</span><span class="s2">"col carrillo"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"state"</span><span class="p">:</span><span class="s2">"Queretaro"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"city"</span><span class="p">:</span><span class="s2">"QuerÃ©taro"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"postal_code"</span><span class="p">:</span><span class="s2">"76900"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"country_code"</span><span class="p">:</span><span class="s2">"MX"</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"kgipbqixvjg3gbzowl7l"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"card_number"</span><span class="p">:</span><span class="s2">"1111"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"holder_name"</span><span class="p">:</span><span class="s2">"Juan Perez Ramirez"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"expiration_year"</span><span class="p">:</span><span class="s2">"20"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"expiration_month"</span><span class="p">:</span><span class="s2">"12"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"allows_charges"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
   </span><span class="s2">"allows_payouts"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
   </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="s2">"2013-12-12T17:50:00-06:00"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"bank_name"</span><span class="p">:</span><span class="s2">"DESCONOCIDO"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"bank_code"</span><span class="p">:</span><span class="s2">"000"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"customer_id"</span><span class="p">:</span><span class="s2">"a2b79p8xmzeyvmolqfja"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"points_card"</span><span class="p">:</span><span class="kc">true</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td><strong><em>string</em></strong> <br/>Unique identifier of the card.</td>
</tr>
<tr>
<td>creation_date</td>
<td><strong><em>datetime</em></strong> <br/>Date and time when the card was created in ISO 8601 format.</td>
</tr>
<tr>
<td>holder_name</td>
<td><strong><em>string</em></strong>  <br/>Name of the cardholder.</td>
</tr>
<tr>
<td>card_number</td>
<td><strong><em>numeric</em></strong>  <br/>Card Number, it can be 16 or 19 digits.</td>
</tr>
<tr>
<td>cvv2</td>
<td><strong><em>numeric</em></strong>  <br/>Security code as it appears on the back of the card. Usually 3 digits..</td>
</tr>
<tr>
<td>expiration_month</td>
<td><strong><em>numeric</em></strong>  <br/>Expiration month as it appears on the card.</td>
</tr>
<tr>
<td>expiration_year</td>
<td><strong><em>numeric</em></strong>  <br/>Expiration year as it appears on the card.</td>
</tr>
<tr>
<td><a href="#address-object">address</a></td>
<td><strong><em>object</em></strong> <br/>Billing address of cardholder.</td>
</tr>
<tr>
<td>allows_charges</td>
<td><strong><em>boolean</em></strong> <br/>It allows to know if you can make charges to the card.</td>
</tr>
<tr>
<td>allows_payouts</td>
<td><strong><em>boolean</em></strong> <br/>It allows to know if you can send payments to the card.</td>
</tr>
<tr>
<td>brand</td>
<td><strong><em>string</em></strong> <br/>Card brand: visa, mastercard, carnet or american express.</td>
</tr>
<tr>
<td>type</td>
<td><strong><em>string</em></strong> <br/>Card Type: debit, credit, cash, etc.</td>
</tr>
<tr>
<td>bank_name</td>
<td><strong><em>string</em></strong> <br/>Name of the issuing bank.</td>
</tr>
<tr>
<td>bank_code</td>
<td><strong><em>string</em></strong> <br/>Code of the issuing bank.</td>
</tr>
<tr>
<td>customer_id</td>
<td><strong><em>string</em></strong> <br/>Customer identifier to which the card belongs. If the card is at Merchant level this value is null.</td>
</tr>
<tr>
<td>points_card</td>
<td><strong><em>boolean</em></strong> <br/>Indicates whether the card allows the use of reward points.</td>
</tr>
</tbody></table>

<h2 id="create-a-card">Create a card</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell">Merchant
POST https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/cards

Customer
POST https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/customers/<span class="o">{</span>CUSTOMER_ID<span class="o">}</span>/cards
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="c1">//Customer
</span><span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">customerId</span><span class="p">);</span>
<span class="nv">$card</span> <span class="o">=</span> <span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">cards</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="nx">cardDataRequest</span><span class="p">);</span>

<span class="c1">//Merchant
</span><span class="nv">$card</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">cards</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="nx">cardDataRequest</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="c1">//Customer</span>
<span class="n">openpayAPI</span><span class="o">.</span><span class="na">cards</span><span class="o">().</span><span class="na">create</span><span class="o">(</span><span class="n">String</span> <span class="n">customerId</span><span class="o">,</span> <span class="n">Card</span> <span class="n">request</span><span class="o">);</span>

<span class="c1">//Merchant</span>
<span class="n">openpayAPI</span><span class="o">.</span><span class="na">cards</span><span class="o">().</span><span class="na">create</span><span class="o">(</span><span class="n">Card</span> <span class="n">request</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="c1">//Customer
</span><span class="n">openpayAPI</span><span class="p">.</span><span class="n">CardService</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="kt">string</span> <span class="n">customer_id</span><span class="p">,</span> <span class="n">Card</span> <span class="n">card</span><span class="p">);</span>

<span class="c1">//Merchant
</span><span class="n">openpayAPI</span><span class="p">.</span><span class="n">CardService</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="n">Card</span> <span class="n">card</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="c1">// Merchant
</span><span class="nx">openpay</span><span class="p">.</span><span class="nx">cards</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">cardRequest</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>

<span class="c1">// Customer
</span><span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">cards</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">customerId</span><span class="p">,</span> <span class="nx">cardRequest</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
</pre><pre class="highlight ruby"><span class="c1">#Customer</span>
<span class="vi">@cards</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:cards</span><span class="p">)</span>
<span class="vi">@cards</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="n">request_hash</span><span class="p">,</span> <span class="n">customer_id</span><span class="p">)</span>

<span class="c1">#Merchant</span>
<span class="vi">@cards</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:cards</span><span class="p">)</span>
<span class="vi">@cards</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="n">request_hash</span><span class="p">)</span>
</pre>
<blockquote>
<p>Customer Request example</p>
</blockquote>
<pre class="highlight shell">curl https://sandbox-api.openpay.mx/v1/mzdtln0bmtms6o3kck8f/customers/ag4nktpdzebjiye1tlze/cards <span class="se">\</span>
   -u sk_e568c42a6c384b7ab02cd47d2e407cab: <span class="se">\</span>
   -H <span class="s2">"Content-type: application/json"</span> <span class="se">\</span>
   -X POST -d <span class="s1">'{
   "card_number":"4111111111111111",
   "holder_name":"Juan Perez Ramirez",
   "expiration_year":"20",
   "expiration_month":"12",
   "cvv2":"110"
 }'</span> 
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$openpay</span> <span class="o">=</span> <span class="nx">Openpay</span><span class="o">::</span><span class="na">getInstance</span><span class="p">(</span><span class="s1">'moiep6umtcnanql3jrxp'</span><span class="p">,</span> <span class="s1">'sk_3433941e467c1055b178ce26348b0fac'</span><span class="p">);</span>

<span class="nv">$cardDataRequest</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'holder_name'</span> <span class="o">=&gt;</span> <span class="s1">'Teofilo Velazco'</span><span class="p">,</span>
    <span class="s1">'card_number'</span> <span class="o">=&gt;</span> <span class="s1">'4916394462033681'</span><span class="p">,</span>
    <span class="s1">'cvv2'</span> <span class="o">=&gt;</span> <span class="s1">'123'</span><span class="p">,</span>
    <span class="s1">'expiration_month'</span> <span class="o">=&gt;</span> <span class="s1">'12'</span><span class="p">,</span>
    <span class="s1">'expiration_year'</span> <span class="o">=&gt;</span> <span class="s1">'15'</span><span class="p">,</span>
    <span class="s1">'address'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">'line1'</span> <span class="o">=&gt;</span> <span class="s1">'Privada Rio No. 12'</span><span class="p">,</span>
            <span class="s1">'line2'</span> <span class="o">=&gt;</span> <span class="s1">'Co. El Tintero'</span><span class="p">,</span>
            <span class="s1">'line3'</span> <span class="o">=&gt;</span> <span class="s1">''</span><span class="p">,</span>
            <span class="s1">'postal_code'</span> <span class="o">=&gt;</span> <span class="s1">'76920'</span><span class="p">,</span>
            <span class="s1">'state'</span> <span class="o">=&gt;</span> <span class="s1">'QuerÃ©taro'</span><span class="p">,</span>
            <span class="s1">'city'</span> <span class="o">=&gt;</span> <span class="s1">'QuerÃ©taro.'</span><span class="p">,</span>
            <span class="s1">'country_code'</span> <span class="o">=&gt;</span> <span class="s1">'MX'</span><span class="p">));</span>

<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'a9ualumwnrcxkl42l6mh'</span><span class="p">);</span>
<span class="nv">$card</span> <span class="o">=</span> <span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">cards</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="nv">$cardDataRequest</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OpenpayAPI</span><span class="o">(</span><span class="s">"https://sandbox-api.openpay.mx"</span><span class="o">,</span> <span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="o">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="o">);</span>
<span class="n">Card</span> <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Card</span><span class="o">();</span>
<span class="n">request</span><span class="o">.</span><span class="na">holderName</span><span class="o">(</span><span class="s">"Juan Perez Ramirez"</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">cardNumber</span><span class="o">(</span><span class="s">"4111111111111111"</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">cvv2</span><span class="o">(</span><span class="s">"110"</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">expirationMonth</span><span class="o">(</span><span class="mi">12</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">expirationYear</span><span class="o">(</span><span class="mi">20</span><span class="o">);</span>
<span class="n">Address</span> <span class="n">address</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Address</span><span class="o">();</span>
<span class="n">address</span><span class="o">.</span><span class="na">city</span><span class="o">(</span><span class="s">"Queretaro"</span><span class="o">);</span>
<span class="n">address</span><span class="o">.</span><span class="na">countryCode</span><span class="o">(</span><span class="s">"10"</span><span class="o">);</span>
<span class="n">address</span><span class="o">.</span><span class="na">state</span><span class="o">(</span><span class="s">"Queretaro"</span><span class="o">);</span>
<span class="n">address</span><span class="o">.</span><span class="na">postalCode</span><span class="o">(</span><span class="s">"79125"</span><span class="o">);</span>
<span class="n">address</span><span class="o">.</span><span class="na">line1</span><span class="o">(</span><span class="s">"Av. Pie de la cuesta #12"</span><span class="o">);</span>
<span class="n">address</span><span class="o">.</span><span class="na">line2</span><span class="o">(</span><span class="s">"Desarrollo San Pablo"</span><span class="o">);</span>
<span class="n">address</span><span class="o">.</span><span class="na">line3</span><span class="o">(</span><span class="s">"Qro. Qro."</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">address</span><span class="o">(</span><span class="n">address</span><span class="o">);</span>

<span class="n">request</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="na">cards</span><span class="o">().</span><span class="na">create</span><span class="o">(</span><span class="s">"a9pvykxz4g5rg0fplze0"</span><span class="o">,</span> <span class="n">request</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">OpenpayAPI</span><span class="p">(</span><span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="p">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="p">);</span>
<span class="n">Card</span> <span class="n">request</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Card</span><span class="p">();</span>
<span class="n">request</span><span class="p">.</span><span class="n">HolderName</span> <span class="p">=</span> <span class="s">"Juan Perez Ramirez"</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">CardNumber</span> <span class="p">=</span> <span class="s">"4111111111111111"</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">Cvv2</span> <span class="p">=</span> <span class="s">"110"</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">ExpirationMonth</span> <span class="p">=</span> <span class="s">"12"</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">ExpirationYear</span> <span class="p">=</span> <span class="s">"20"</span><span class="p">;</span>
<span class="n">Address</span> <span class="n">address</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Address</span><span class="p">();</span>
<span class="n">address</span><span class="p">.</span><span class="n">City</span> <span class="p">=</span> <span class="s">"Queretaro"</span><span class="p">;</span>
<span class="n">address</span><span class="p">.</span><span class="n">CountryCode</span> <span class="p">=</span> <span class="s">"MX"</span><span class="p">;</span>
<span class="n">address</span><span class="p">.</span><span class="n">State</span> <span class="p">=</span> <span class="s">"Queretaro"</span><span class="p">;</span>
<span class="n">address</span><span class="p">.</span><span class="n">PostalCode</span> <span class="p">=</span> <span class="s">"79125"</span><span class="p">;</span>
<span class="n">address</span><span class="p">.</span><span class="n">Line1</span> <span class="p">=</span> <span class="s">"Av. Pie de la cuesta #12"</span><span class="p">;</span>
<span class="n">address</span><span class="p">.</span><span class="n">Line2</span> <span class="p">=</span> <span class="s">"Desarrollo San Pablo"</span><span class="p">;</span>
<span class="n">address</span><span class="p">.</span><span class="n">Line3</span> <span class="p">=</span> <span class="s">"Qro. Qro."</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">Address</span> <span class="p">=</span> <span class="n">address</span><span class="p">;</span>

<span class="n">request</span> <span class="p">=</span> <span class="n">api</span><span class="p">.</span><span class="n">CardService</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="s">"a9pvykxz4g5rg0fplze0"</span><span class="p">,</span> <span class="n">request</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="kd">var</span> <span class="nx">cardRequest</span> <span class="o">=</span> <span class="p">{</span>
   <span class="s1">'card_number'</span><span class="err">:</span><span class="s1">'4111111111111111'</span><span class="p">,</span>
   <span class="s1">'holder_name'</span><span class="err">:</span><span class="s1">'Juan Perez Ramirez'</span><span class="p">,</span>
   <span class="s1">'expiration_year'</span><span class="err">:</span><span class="s1">'20'</span><span class="p">,</span>
   <span class="s1">'expiration_month'</span><span class="err">:</span><span class="s1">'12'</span><span class="p">,</span>
   <span class="s1">'cvv2'</span><span class="err">:</span><span class="s1">'110'</span>
<span class="p">};</span>

<span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">cards</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="s1">'a9pvykxz4g5rg0fplze0'</span><span class="p">,</span> <span class="nx">cardRequest</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">card</span><span class="p">)</span>  <span class="p">{</span>
    <span class="c1">// ...    
</span><span class="p">});</span>
</pre><pre class="highlight ruby"><span class="vi">@openpay</span><span class="o">=</span><span class="no">OpenpayApi</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"mzdtln0bmtms6o3kck8f"</span><span class="p">,</span><span class="s2">"sk_e568c42a6c384b7ab02cd47d2e407cab"</span><span class="p">)</span>
<span class="vi">@cards</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:cards</span><span class="p">)</span>
<span class="n">address_hash</span><span class="o">=</span><span class="p">{</span>
      <span class="s2">"line1"</span> <span class="o">=&gt;</span> <span class="s2">"Calle 10"</span><span class="p">,</span>
      <span class="s2">"line2"</span> <span class="o">=&gt;</span> <span class="s2">"col. san pablo"</span><span class="p">,</span>
      <span class="s2">"line3"</span> <span class="o">=&gt;</span> <span class="s2">"entre la calle 1 y la 2"</span><span class="p">,</span>
      <span class="s2">"state"</span> <span class="o">=&gt;</span> <span class="s2">"Queretaro"</span><span class="p">,</span>
      <span class="s2">"city"</span> <span class="o">=&gt;</span> <span class="s2">"Queretaro"</span><span class="p">,</span>
      <span class="s2">"postal_code"</span> <span class="o">=&gt;</span> <span class="s2">"76000"</span><span class="p">,</span>
      <span class="s2">"country_code"</span> <span class="o">=&gt;</span> <span class="s2">"MX"</span>
   <span class="p">}</span>
<span class="n">request_hash</span><span class="o">=</span><span class="p">{</span>
     <span class="s2">"holder_name"</span> <span class="o">=&gt;</span> <span class="s2">"Juan Perez Ramirez"</span><span class="p">,</span>
     <span class="s2">"card_number"</span> <span class="o">=&gt;</span> <span class="s2">"411111XXXXXX1111"</span><span class="p">,</span>
     <span class="s2">"cvv2"</span> <span class="o">=&gt;</span> <span class="s2">"110"</span><span class="p">,</span>
     <span class="s2">"expiration_month"</span> <span class="o">=&gt;</span> <span class="s2">"12"</span><span class="p">,</span>
     <span class="s2">"expiration_year"</span> <span class="o">=&gt;</span> <span class="s2">"20"</span><span class="p">,</span>
     <span class="s2">"address"</span> <span class="o">=&gt;</span> <span class="n">address_hash</span>
   <span class="p">}</span>

<span class="n">response_hash</span><span class="o">=</span><span class="vi">@cards</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="n">request_hash</span><span class="p">.</span><span class="nf">to_hash</span><span class="p">,</span> <span class="s2">"asynwirguzkgq2bizogo"</span><span class="p">)</span>
</pre>
<blockquote>
<p>Response example</p>
</blockquote>
<pre class="highlight json"><span class="p">{</span><span class="w">
   </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"ktrpvymgatocelsciak7"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"debit"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"brand"</span><span class="p">:</span><span class="s2">"visa"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"card_number"</span><span class="p">:</span><span class="s2">"411111XXXXXX1111"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"holder_name"</span><span class="p">:</span><span class="s2">"Juan Perez Ramirez"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"expiration_year"</span><span class="p">:</span><span class="s2">"20"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"expiration_month"</span><span class="p">:</span><span class="s2">"12"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"allows_charges"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
   </span><span class="s2">"allows_payouts"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
   </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="s2">"2014-05-21T17:31:01-05:00"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"bank_name"</span><span class="p">:</span><span class="s2">"Banamex"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"customer_id"</span><span class="p">:</span><span class="s2">"ag4nktpdzebjiye1tlze"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"bank_code"</span><span class="p">:</span><span class="s2">"002"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<p>When a card is created the customer must be specified, if the customer is not specified the card will be registered for the Merchant account. Once the card is saved, it can not obtain the number and security code.</p>

<p><aside class = "notice">
<strong>Note:</strong> When stored in Openpay, all cards  are validated by making an authorization for $ 10.00 which is returned at the time.
</aside></p>

<p>When saving a card, an ID will be created which can be used to make card charges, payouts to a card or just for getting the not sensitive card information.</p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>holder_name</td>
<td><strong><em>string</em></strong> (required, length  = 80) <br/>Name of the cardholder.</td>
</tr>
<tr>
<td>card_number</td>
<td><strong><em>numeric</em></strong> (required) <br/>Card Number, it can be 16 or 19 digits.</td>
</tr>
<tr>
<td>cvv2</td>
<td><strong><em>numeric</em></strong> (required) <br/>Security code as it appears on the back of the card. Usually 3 digits.</td>
</tr>
<tr>
<td>expiration_month</td>
<td><strong><em>numeric</em></strong> (required) <br/>Expiration month as it appears on the card.</td>
</tr>
<tr>
<td>expiration_year</td>
<td><strong><em>numeric</em></strong> (required) <br/>Expiration year as it appears on the card.</td>
</tr>
<tr>
<td><a href="#address-object">address</a></td>
<td><strong><em>object</em></strong> <br/>Billing address of cardholder.</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<p>Returns a <a href="#card-object">card object</a> when it is created correctly or returns an <a href="#error-object">error response</a> if a problem happened during the creation.</p>

<h2 id="create-a-card-with-token">Create a card with token</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell">Merchant
POST https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/cards

Customer
POST https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/customers/<span class="o">{</span>CUSTOMER_ID<span class="o">}</span>/cards
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="c1">//Customer
</span><span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">customerId</span><span class="p">);</span>
<span class="nv">$card</span> <span class="o">=</span> <span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">cards</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="nx">cardDataRequest</span><span class="p">);</span>

<span class="c1">//Merchant
</span><span class="nv">$card</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">cards</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="nx">cardDataRequest</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="c1">//Customer</span>
<span class="n">openpayAPI</span><span class="o">.</span><span class="na">cards</span><span class="o">().</span><span class="na">create</span><span class="o">(</span><span class="n">String</span> <span class="n">customerId</span><span class="o">,</span> <span class="n">Card</span> <span class="n">card</span><span class="o">);</span>

<span class="c1">//Merchant</span>
<span class="n">openpayAPI</span><span class="o">.</span><span class="na">cards</span><span class="o">().</span><span class="na">create</span><span class="o">(</span><span class="n">Card</span> <span class="n">card</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="c1">//Customer
</span><span class="n">openpayAPI</span><span class="p">.</span><span class="n">CardService</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="kt">string</span> <span class="n">customer_id</span><span class="p">,</span> <span class="n">Card</span> <span class="n">request</span><span class="p">);</span>

<span class="c1">//Merchant
</span><span class="n">openpayAPI</span><span class="p">.</span><span class="n">CardService</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="n">Card</span> <span class="n">request</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="c1">// Merchant
</span><span class="nx">openpay</span><span class="p">.</span><span class="nx">cards</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">cardRequest</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>

<span class="c1">// Customer
</span><span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">cards</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">customerId</span><span class="p">,</span> <span class="nx">cardRequest</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
</pre><pre class="highlight ruby"><span class="c1">#Customer</span>
<span class="vi">@cards</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:cards</span><span class="p">)</span>
<span class="vi">@cards</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="n">request_hash</span><span class="p">,</span> <span class="n">customer_id</span><span class="p">)</span>

<span class="c1">#Merchant</span>
<span class="vi">@cards</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:cards</span><span class="p">)</span>
<span class="vi">@cards</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="n">request_hash</span><span class="p">)</span>
</pre>
<blockquote>
<p>Request example</p>
</blockquote>
<pre class="highlight shell">curl https://sandbox-api.openpay.mx/v1/mzdtln0bmtms6o3kck8f/customers/ag4nktpdzebjiye1tlze/cards <span class="se">\</span>
   -u sk_e568c42a6c384b7ab02cd47d2e407cab: <span class="se">\</span>
   -H <span class="s2">"Content-type: application/json"</span> <span class="se">\</span>
   -X POST -d <span class="s1">'{
      "token_id":"tokgslwpdcrkhlgxqi9a",
      "device_session_id":"8VIoXj0hN5dswYHQ9X1mVCiB72M7FY9o"
   }'</span> 
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$openpay</span> <span class="o">=</span> <span class="nx">Openpay</span><span class="o">::</span><span class="na">getInstance</span><span class="p">(</span><span class="s1">'moiep6umtcnanql3jrxp'</span><span class="p">,</span> <span class="s1">'sk_3433941e467c1055b178ce26348b0fac'</span><span class="p">);</span>

<span class="nv">$cardDataRequest</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'token_id'</span> <span class="o">=&gt;</span> <span class="s1">'tokgslwpdcrkhlgxqi9a'</span><span class="p">,</span>
    <span class="s1">'device_session_id'</span> <span class="o">=&gt;</span> <span class="s1">'8VIoXj0hN5dswYHQ9X1mVCiB72M7FY9o'</span>
    <span class="p">);</span>

<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'a9ualumwnrcxkl42l6mh'</span><span class="p">);</span>
<span class="nv">$card</span> <span class="o">=</span> <span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">cards</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="nv">$cardDataRequest</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OpenpayAPI</span><span class="o">(</span><span class="s">"https://sandbox-api.openpay.mx"</span><span class="o">,</span> <span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="o">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="o">);</span>
<span class="n">Card</span> <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Card</span><span class="o">();</span>
<span class="n">request</span><span class="o">.</span><span class="na">tokenId</span><span class="o">(</span><span class="s">"tokgslwpdcrkhlgxqi9a"</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">deviceSessionId</span><span class="o">(</span><span class="s">"8VIoXj0hN5dswYHQ9X1mVCiB72M7FY9o"</span><span class="o">);</span>

<span class="n">request</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="na">cards</span><span class="o">().</span><span class="na">create</span><span class="o">(</span><span class="s">"a9pvykxz4g5rg0fplze0"</span><span class="o">,</span> <span class="n">request</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">OpenpayAPI</span><span class="p">(</span><span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="p">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="p">);</span>
<span class="n">Card</span> <span class="n">request</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Card</span><span class="p">();</span>
<span class="n">request</span><span class="p">.</span><span class="n">TokenId</span> <span class="p">=</span> <span class="s">"tokgslwpdcrkhlgxqi9a"</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">DeviceSessionId</span> <span class="p">=</span> <span class="s">"8VIoXj0hN5dswYHQ9X1mVCiB72M7FY9o"</span><span class="p">;</span>

<span class="n">request</span> <span class="p">=</span> <span class="n">api</span><span class="p">.</span><span class="n">CardService</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="s">"a9pvykxz4g5rg0fplze0"</span><span class="p">,</span> <span class="n">request</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="kd">var</span> <span class="nx">cardRequest</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">'token_id'</span> <span class="err">:</span> <span class="s1">'tokgslwpdcrkhlgxqi9a'</span><span class="p">,</span>
  <span class="s1">'device_session_id'</span> <span class="err">:</span> <span class="s1">'8VIoXj0hN5dswYHQ9X1mVCiB72M7FY9o'</span>
<span class="p">}</span>

<span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">cards</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="s1">'a9pvykxz4g5rg0fplze0'</span><span class="p">,</span> <span class="nx">cardRequest</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">card</span><span class="p">)</span>  <span class="p">{</span>
  <span class="c1">// ...
</span><span class="p">});</span>
</pre><pre class="highlight ruby"><span class="vi">@openpay</span><span class="o">=</span><span class="no">OpenpayApi</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"mzdtln0bmtms6o3kck8f"</span><span class="p">,</span><span class="s2">"sk_e568c42a6c384b7ab02cd47d2e407cab"</span><span class="p">)</span>
<span class="vi">@cards</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:cards</span><span class="p">)</span>
<span class="n">request_hash</span><span class="o">=</span><span class="p">{</span>
     <span class="s2">"token_id"</span> <span class="o">=&gt;</span> <span class="s2">"tokgslwpdcrkhlgxqi9a"</span><span class="p">,</span>
     <span class="s2">"device_session_id"</span> <span class="o">=&gt;</span> <span class="s2">"8VIoXj0hN5dswYHQ9X1mVCiB72M7FY9o"</span>
   <span class="p">}</span>

<span class="n">response_hash</span><span class="o">=</span><span class="vi">@cards</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="n">request_hash</span><span class="p">.</span><span class="nf">to_hash</span><span class="p">,</span> <span class="s2">"asynwirguzkgq2bizogo"</span><span class="p">)</span>
</pre>
<blockquote>
<p>Response example</p>
</blockquote>
<pre class="highlight json"><span class="p">{</span><span class="w">
   </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"credit"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"brand"</span><span class="p">:</span><span class="s2">"visa"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"kso4st83wxaibffyt6su"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"card_number"</span><span class="p">:</span><span class="s2">"4242"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"holder_name"</span><span class="p">:</span><span class="s2">"Juan Perez Ramirez"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"expiration_year"</span><span class="p">:</span><span class="s2">"15"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"expiration_month"</span><span class="p">:</span><span class="s2">"12"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"allows_charges"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
   </span><span class="s2">"allows_payouts"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
   </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="s2">"2014-02-12T10:57:09-06:00"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"bank_name"</span><span class="p">:</span><span class="s2">"BANCOMER"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"bank_code"</span><span class="p">:</span><span class="s2">"012"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"customer_id"</span><span class="p">:</span><span class="s2">"a2b79p8xmzeyvmolqfja"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<p>Creates a card from a token obtained from the browser or from the customerâ€™s device. This way prevents the sensitive card information passes through your servers.</p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>token_id</td>
<td><strong><em>string</em></strong> (required, length = 45) <br/> Token identifier generated in the the browser or in the customerâ€™s device.</td>
</tr>
<tr>
<td>device_session_id</td>
<td><strong><em>string</em></strong> (required, length = 255) <br/> Identifier of the device generated by the antifraud tool.</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<p>Returns a <a href="#card-object">card object</a></p>

<h2 id="get-a-card">Get a card</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell">Merchant
GET https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/cards/<span class="o">{</span>CARD_ID<span class="o">}</span>

Customer
GET https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/customers/<span class="o">{</span>CUSTOMER_ID<span class="o">}</span>/cards/<span class="o">{</span>CARD_ID<span class="o">}</span>
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="c1">//Customer
</span><span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">customerId</span><span class="p">);</span>
<span class="nv">$card</span> <span class="o">=</span> <span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">cards</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">cardId</span><span class="p">);</span>

<span class="c1">//Merchant
</span><span class="nv">$card</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">cards</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">cardId</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="c1">//Customer</span>
<span class="n">openpayAPI</span><span class="o">.</span><span class="na">cards</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="n">String</span> <span class="n">customerId</span><span class="o">,</span> <span class="n">String</span> <span class="n">cardId</span><span class="o">);</span>

<span class="c1">//Merchant</span>
<span class="n">openpayAPI</span><span class="o">.</span><span class="na">cards</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="n">String</span> <span class="n">cardId</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="c1">//Customer
</span><span class="n">openpayAPI</span><span class="p">.</span><span class="n">CardService</span><span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="kt">string</span> <span class="n">customer_id</span><span class="p">,</span> <span class="kt">string</span> <span class="n">card_id</span><span class="p">);</span>

<span class="c1">//Merchant
</span><span class="n">openpayAPI</span><span class="p">.</span><span class="n">CardService</span><span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="kt">string</span> <span class="n">card_id</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="c1">// Merchant
</span><span class="nx">openpay</span><span class="p">.</span><span class="nx">cards</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">cardId</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>

<span class="c1">// Customer
</span><span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">cards</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">customerId</span><span class="p">,</span> <span class="nx">cardId</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
</pre><pre class="highlight ruby"><span class="c1">#Customer</span>
<span class="vi">@cards</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:cards</span><span class="p">)</span>
<span class="vi">@cards</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">card_id</span><span class="p">,</span> <span class="n">customer_id</span><span class="p">)</span>

<span class="c1">#Merchant</span>
<span class="vi">@cards</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:cards</span><span class="p">)</span>
<span class="vi">@cards</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">card_id</span><span class="p">)</span>
</pre>
<blockquote>
<p>Request example</p>
</blockquote>
<pre class="highlight shell">curl https://sandbox-api.openpay.mx/v1/mzdtln0bmtms6o3kck8f/customers/ag4nktpdzebjiye1tlze/cards/ktrpvymgatocelsciak7 <span class="se">\</span>
   -u sk_e568c42a6c384b7ab02cd47d2e407cab: <span class="se">\</span>
   -H <span class="s2">"Content-type: application/json"</span> 
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$openpay</span> <span class="o">=</span> <span class="nx">Openpay</span><span class="o">::</span><span class="na">getInstance</span><span class="p">(</span><span class="s1">'moiep6umtcnanql3jrxp'</span><span class="p">,</span> <span class="s1">'sk_3433941e467c1055b178ce26348b0fac'</span><span class="p">);</span>

<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'a9ualumwnrcxkl42l6mh'</span><span class="p">);</span>
<span class="nv">$card</span> <span class="o">=</span> <span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">cards</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'k9pn8qtsvr7k7gxoq1r5'</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OpenpayAPI</span><span class="o">(</span><span class="s">"https://sandbox-api.openpay.mx"</span><span class="o">,</span> <span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="o">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="o">);</span>
<span class="n">Card</span> <span class="n">card</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="na">cards</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="s">"a9pvykxz4g5rg0fplze0"</span><span class="o">,</span> <span class="s">"ktrpvymgatocelsciak7"</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">OpenpayAPI</span><span class="p">(</span><span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="p">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="p">);</span>
<span class="n">Card</span> <span class="n">card</span> <span class="p">=</span> <span class="n">api</span><span class="p">.</span><span class="n">CardService</span><span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="s">"a9pvykxz4g5rg0fplze0"</span><span class="p">,</span> <span class="s">"ktrpvymgatocelsciak7"</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">cards</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'a9pvykxz4g5rg0fplze0'</span><span class="p">,</span> <span class="s1">'ktrpvymgatocelsciak7'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">card</span><span class="p">){</span>
  <span class="c1">// ...
</span><span class="p">});</span>
</pre><pre class="highlight ruby"><span class="vi">@openpay</span><span class="o">=</span><span class="no">OpenpayApi</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"mzdtln0bmtms6o3kck8f"</span><span class="p">,</span><span class="s2">"sk_e568c42a6c384b7ab02cd47d2e407cab"</span><span class="p">)</span>
<span class="vi">@cards</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:cards</span><span class="p">)</span>

<span class="n">response_hash</span><span class="o">=</span><span class="vi">@cards</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="s2">"ktrpvymgatocelsciak7"</span><span class="p">,</span> <span class="s2">"asynwirguzkgq2bizogo"</span><span class="p">)</span>
</pre>
<blockquote>
<p>Response example</p>
</blockquote>
<pre class="highlight json"><span class="p">{</span><span class="w">
   </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"ktrpvymgatocelsciak7"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"debit"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"brand"</span><span class="p">:</span><span class="s2">"visa"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"card_number"</span><span class="p">:</span><span class="s2">"411111XXXXXX1111"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"holder_name"</span><span class="p">:</span><span class="s2">"Juan Perez Ramirez"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"expiration_year"</span><span class="p">:</span><span class="s2">"20"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"expiration_month"</span><span class="p">:</span><span class="s2">"12"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"allows_charges"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
   </span><span class="s2">"allows_payouts"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
   </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="s2">"2014-05-21T17:31:01-05:00"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"bank_name"</span><span class="p">:</span><span class="s2">"Banamex"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"customer_id"</span><span class="p">:</span><span class="s2">"ag4nktpdzebjiye1tlze"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"bank_code"</span><span class="p">:</span><span class="s2">"002"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<p>It obtains the details of the card by using its id.</p>

<p><aside class="notice">
<strong>Note:</strong> It will never return sensitive data as the code and card number, only the first 6 and last 4 digits will be displayed.
</aside></p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td><strong><em>string</em></strong> (required, length = 45) <br/> Card unique identifier.</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<p>Returns a <a href="#card-object">card object</a></p>

<h2 id="delete-a-card">Delete a card</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell">Merchant
DELETE https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/cards/<span class="o">{</span>CARD_ID<span class="o">}</span>

Customer
DELETE https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/customers/<span class="o">{</span>CUSTOMER_ID<span class="o">}</span>/cards/<span class="o">{</span>CARD_ID<span class="o">}</span>
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="c1">//Customer
</span><span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">customerId</span><span class="p">);</span>
<span class="nv">$card</span> <span class="o">=</span> <span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">cards</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">cardId</span><span class="p">);</span>
<span class="nv">$card</span><span class="o">-&gt;</span><span class="na">delete</span><span class="p">();</span>

<span class="c1">//Merchant
</span><span class="nv">$card</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">cards</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">cardId</span><span class="p">);</span>
<span class="nv">$card</span><span class="o">-&gt;</span><span class="na">delete</span><span class="p">();</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="c1">//Customer</span>
<span class="n">openpayAPI</span><span class="o">.</span><span class="na">cards</span><span class="o">().</span><span class="na">delete</span><span class="o">(</span><span class="n">String</span> <span class="n">customerId</span><span class="o">,</span> <span class="n">String</span> <span class="n">cardId</span><span class="o">);</span>

<span class="c1">//Merchant</span>
<span class="n">openpayAPI</span><span class="o">.</span><span class="na">cards</span><span class="o">().</span><span class="na">delete</span><span class="o">(</span><span class="n">String</span> <span class="n">cardId</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="c1">//Customer
</span><span class="n">openpayAPI</span><span class="p">.</span><span class="n">CardService</span><span class="p">.</span><span class="nf">Delete</span><span class="p">(</span><span class="kt">string</span> <span class="n">customer_id</span><span class="p">,</span> <span class="kt">string</span> <span class="n">card_id</span><span class="p">);</span>

<span class="c1">//Merchant
</span><span class="n">openpayAPI</span><span class="p">.</span><span class="n">CardService</span><span class="p">.</span><span class="nf">Delete</span><span class="p">(</span><span class="kt">string</span> <span class="n">card_id</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="c1">// Merchant
</span><span class="nx">openpay</span><span class="p">.</span><span class="nx">cards</span><span class="p">.</span><span class="k">delete</span><span class="p">(</span><span class="nx">cardId</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>

<span class="c1">// Customer
</span><span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">cards</span><span class="p">.</span><span class="k">delete</span><span class="p">(</span><span class="nx">customerId</span><span class="p">,</span> <span class="nx">cardId</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
</pre><pre class="highlight ruby"><span class="c1">#Customer</span>
<span class="vi">@cards</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:cards</span><span class="p">)</span>
<span class="vi">@cards</span><span class="p">.</span><span class="nf">delete</span><span class="p">(</span><span class="n">card_id</span><span class="p">,</span> <span class="n">customer_id</span><span class="p">)</span>

<span class="c1">#Merchant</span>
<span class="vi">@cards</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:cards</span><span class="p">)</span>
<span class="vi">@cards</span><span class="p">.</span><span class="nf">delete</span><span class="p">(</span><span class="n">card_id</span><span class="p">)</span>
</pre>
<blockquote>
<p>Request example</p>
</blockquote>
<pre class="highlight shell">curl https://sandbox-api.openpay.mx/v1/mzdtln0bmtms6o3kck8f/customers/ag4nktpdzebjiye1tlze/cards/ktrpvymgatocelsciak7 <span class="se">\</span>
   -u sk_e568c42a6c384b7ab02cd47d2e407cab: <span class="se">\</span>
   -X DELETE
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$openpay</span> <span class="o">=</span> <span class="nx">Openpay</span><span class="o">::</span><span class="na">getInstance</span><span class="p">(</span><span class="s1">'moiep6umtcnanql3jrxp'</span><span class="p">,</span> <span class="s1">'sk_3433941e467c1055b178ce26348b0fac'</span><span class="p">);</span>

<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'a9ualumwnrcxkl42l6mh'</span><span class="p">);</span>
<span class="nv">$card</span> <span class="o">=</span> <span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">cards</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'k9pn8qtsvr7k7gxoq1r5'</span><span class="p">);</span>
<span class="nv">$card</span><span class="o">-&gt;</span><span class="na">delete</span><span class="p">();</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OpenpayAPI</span><span class="o">(</span><span class="s">"https://sandbox-api.openpay.mx"</span><span class="o">,</span> <span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="o">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="o">);</span>
<span class="n">api</span><span class="o">.</span><span class="na">cards</span><span class="o">().</span><span class="na">delete</span><span class="o">(</span><span class="s">"a9pvykxz4g5rg0fplze0"</span><span class="o">,</span> <span class="s">"ktrpvymgatocelsciak7"</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">OpenpayAPI</span><span class="p">(</span><span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="p">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="p">);</span>
<span class="n">api</span><span class="p">.</span><span class="n">CardService</span><span class="p">.</span><span class="nf">Delete</span><span class="p">(</span><span class="s">"a9pvykxz4g5rg0fplze0"</span><span class="p">,</span> <span class="s">"ktrpvymgatocelsciak7"</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">cards</span><span class="p">.</span><span class="k">delete</span><span class="p">(</span><span class="s1">'a9pvykxz4g5rg0fplze0'</span><span class="p">,</span> <span class="s1">'ktrpvymgatocelsciak7'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// ...
</span><span class="p">});</span>
</pre><pre class="highlight ruby"><span class="vi">@openpay</span><span class="o">=</span><span class="no">OpenpayApi</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"mzdtln0bmtms6o3kck8f"</span><span class="p">,</span><span class="s2">"sk_e568c42a6c384b7ab02cd47d2e407cab"</span><span class="p">)</span>
<span class="vi">@cards</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:cards</span><span class="p">)</span>

<span class="n">response_hash</span><span class="o">=</span><span class="vi">@cards</span><span class="p">.</span><span class="nf">delete</span><span class="p">(</span><span class="s2">"ktrpvymgatocelsciak7"</span><span class="p">,</span> <span class="s2">"asynwirguzkgq2bizogo"</span><span class="p">)</span>
</pre>
<p>Deletes a card of the customer or Merchant. After deleting it wonâ€™t be possible to make movements with that card, however, all records of the transactions you have made will be kept and will be available on the dashboard.</p>

<p>To remove it is only necessary to provide the card identifier.</p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td><strong><em>string</em></strong> (required, length = 45) <br/> Card unique identifier.</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<p>If the card is removed correctly the answer is empty, if it can not be deleted a <a href="#error-object">error object</a> indicating the reason is returned. </p>

<h2 id="list-of-cards">List of cards</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell">Merchant
GET https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/customers

Customer
GET https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/customers/<span class="o">{</span>CUSTOMER_ID<span class="o">}</span>/cards
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="c1">//Customer
</span><span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">customerId</span><span class="p">);</span>
<span class="nv">$cardList</span> <span class="o">=</span> <span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">cards</span><span class="o">-&gt;</span><span class="na">getList</span><span class="p">(</span><span class="nx">findDataRequest</span><span class="p">);</span>

<span class="c1">//Merchant
</span><span class="nv">$cardList</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">cards</span><span class="o">-&gt;</span><span class="na">getList</span><span class="p">(</span><span class="nx">findDataRequest</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="c1">//Customer</span>
<span class="n">openpayAPI</span><span class="o">.</span><span class="na">cards</span><span class="o">().</span><span class="na">list</span><span class="o">(</span><span class="n">String</span> <span class="n">customerId</span><span class="o">,</span> <span class="n">SearchParams</span> <span class="n">request</span><span class="o">);</span>

<span class="c1">//Merchant</span>
<span class="n">openpayAPI</span><span class="o">.</span><span class="na">cards</span><span class="o">().</span><span class="na">list</span><span class="o">(</span><span class="n">SearchParams</span> <span class="n">request</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="c1">//Customer
</span><span class="n">openpayAPI</span><span class="p">.</span><span class="n">CardService</span><span class="p">.</span><span class="nf">List</span><span class="p">(</span><span class="kt">string</span> <span class="n">customer_id</span><span class="p">,</span> <span class="n">SearchParams</span> <span class="n">request</span> <span class="p">=</span> <span class="k">null</span><span class="p">);</span>

<span class="c1">//Merchant
</span><span class="n">openpayAPI</span><span class="p">.</span><span class="n">CardService</span><span class="p">.</span><span class="nf">List</span><span class="p">(</span><span class="n">SearchParams</span> <span class="n">request</span> <span class="p">=</span> <span class="k">null</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="c1">// Merchant
</span><span class="nx">openpay</span><span class="p">.</span><span class="nx">cards</span><span class="p">.</span><span class="nx">list</span><span class="p">(</span><span class="nx">callback</span><span class="p">);</span>
<span class="nx">openpay</span><span class="p">.</span><span class="nx">cards</span><span class="p">.</span><span class="nx">list</span><span class="p">(</span><span class="nx">searchParams</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>

<span class="c1">// Customer
</span><span class="nx">openpay</span><span class="p">.</span><span class="nx">cards</span><span class="p">.</span><span class="nx">list</span><span class="p">(</span><span class="nx">customerId</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
<span class="nx">openpay</span><span class="p">.</span><span class="nx">cards</span><span class="p">.</span><span class="nx">list</span><span class="p">(</span><span class="nx">customerId</span><span class="p">,</span> <span class="nx">searchParams</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
</pre><pre class="highlight ruby"><span class="c1">#Customer</span>
<span class="vi">@cards</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:cards</span><span class="p">)</span>
<span class="vi">@cards</span><span class="p">.</span><span class="nf">all</span><span class="p">(</span><span class="n">customer_id</span><span class="p">)</span>

<span class="c1">#Merchant</span>
<span class="vi">@cards</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:cards</span><span class="p">)</span>
<span class="vi">@cards</span><span class="p">.</span><span class="nf">all</span>
</pre>
<blockquote>
<p>Request example</p>
</blockquote>
<pre class="highlight shell">curl -g <span class="s2">"https://sandbox-api.openpay.mx/v1/mzdtln0bmtms6o3kck8f/customers/ag4nktpdzebjiye1tlze/cards?limit=2"</span> <span class="se">\</span>
   -u sk_e568c42a6c384b7ab02cd47d2e407cab: 
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$openpay</span> <span class="o">=</span> <span class="nx">Openpay</span><span class="o">::</span><span class="na">getInstance</span><span class="p">(</span><span class="s1">'moiep6umtcnanql3jrxp'</span><span class="p">,</span> <span class="s1">'sk_3433941e467c1055b178ce26348b0fac'</span><span class="p">);</span>

<span class="nv">$findDataRequest</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'creation[gte]'</span> <span class="o">=&gt;</span> <span class="s1">'2013-01-01'</span><span class="p">,</span>
    <span class="s1">'creation[lte]'</span> <span class="o">=&gt;</span> <span class="s1">'2013-12-31'</span><span class="p">,</span>
    <span class="s1">'offset'</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">'limit'</span> <span class="o">=&gt;</span> <span class="mi">5</span><span class="p">);</span>

<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'a9ualumwnrcxkl42l6mh'</span><span class="p">);</span>
<span class="nv">$cardList</span> <span class="o">=</span> <span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">cards</span><span class="o">-&gt;</span><span class="na">getList</span><span class="p">(</span><span class="nv">$findDataRequest</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="kd">final</span> <span class="n">Calendar</span> <span class="n">dateGte</span> <span class="o">=</span> <span class="n">Calendar</span><span class="o">.</span><span class="na">getInstance</span><span class="o">();</span>
<span class="kd">final</span> <span class="n">Calendar</span> <span class="n">dateLte</span> <span class="o">=</span> <span class="n">Calendar</span><span class="o">.</span><span class="na">getInstance</span><span class="o">();</span>
<span class="n">dateGte</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="mi">2014</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">);</span>
<span class="n">dateLte</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="mi">2014</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">15</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">);</span>

<span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OpenpayAPI</span><span class="o">(</span><span class="s">"https://sandbox-api.openpay.mx"</span><span class="o">,</span> <span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="o">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="o">);</span>
<span class="n">SearchParams</span> <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SearchParams</span><span class="o">();</span>
<span class="n">request</span><span class="o">.</span><span class="na">creationGte</span><span class="o">(</span><span class="n">dateGte</span><span class="o">.</span><span class="na">getTime</span><span class="o">());</span>
<span class="n">request</span><span class="o">.</span><span class="na">creationLte</span><span class="o">(</span><span class="n">dateLte</span><span class="o">.</span><span class="na">getTime</span><span class="o">());</span>
<span class="n">request</span><span class="o">.</span><span class="na">offset</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">limit</span><span class="o">(</span><span class="mi">100</span><span class="o">);</span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">Card</span><span class="o">&gt;</span> <span class="n">cards</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="na">cards</span><span class="o">().</span><span class="na">list</span><span class="o">(</span><span class="s">"a9pvykxz4g5rg0fplze0"</span><span class="o">,</span> <span class="n">request</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">OpenpayAPI</span><span class="p">(</span><span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="p">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="p">);</span>
<span class="n">SearchParams</span> <span class="n">request</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SearchParams</span><span class="p">();</span>
<span class="n">request</span><span class="p">.</span><span class="n">CreationGte</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Datetime</span><span class="p">(</span><span class="m">2014</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">1</span><span class="p">);</span>
<span class="n">request</span><span class="p">.</span><span class="n">CreationLte</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">2014</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">15</span><span class="p">);</span>
<span class="n">request</span><span class="p">.</span><span class="n">Offset</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">Limit</span> <span class="p">=</span> <span class="m">100</span><span class="p">;</span>

<span class="n">List</span><span class="p">&lt;</span><span class="n">Card</span><span class="p">&gt;</span> <span class="n">cards</span> <span class="p">=</span> <span class="n">api</span><span class="p">.</span><span class="n">CardService</span><span class="p">.</span><span class="nf">List</span><span class="p">(</span><span class="s">"a9pvykxz4g5rg0fplze0"</span><span class="p">,</span> <span class="n">request</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="kd">var</span> <span class="nx">searchParams</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">'limit'</span> <span class="err">:</span> <span class="mi">2</span>
<span class="p">};</span>

<span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">cards</span><span class="p">.</span><span class="nx">list</span><span class="p">(</span><span class="s1">'ag4nktpdzebjiye1tlze'</span><span class="p">,</span> <span class="nx">searchParams</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">list</span><span class="p">){</span>
  <span class="c1">// ...
</span><span class="p">});</span>
</pre><pre class="highlight ruby"><span class="vi">@openpay</span><span class="o">=</span><span class="no">OpenpayApi</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"mzdtln0bmtms6o3kck8f"</span><span class="p">,</span><span class="s2">"sk_e568c42a6c384b7ab02cd47d2e407cab"</span><span class="p">)</span>
<span class="vi">@cards</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:cards</span><span class="p">)</span>

<span class="n">response_hash</span><span class="o">=</span><span class="vi">@cards</span><span class="p">.</span><span class="nf">all</span><span class="p">(</span><span class="s2">"asynwirguzkgq2bizogo"</span><span class="p">)</span>
</pre>
<blockquote>
<p>Response example</p>
</blockquote>
<pre class="highlight json"><span class="p">[</span><span class="w">
   </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"kxq1rpdymlcpxekvjsxm"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"card_number"</span><span class="p">:</span><span class="s2">"1118"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"holder_name"</span><span class="p">:</span><span class="s2">"Pedro Paramo"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"expiration_year"</span><span class="p">:</span><span class="s2">"15"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"expiration_month"</span><span class="p">:</span><span class="s2">"12"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"allows_charges"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="s2">"allows_payouts"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="s2">"2013-11-20T09:22:25-06:00"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"bank_name"</span><span class="p">:</span><span class="s2">"BBVA BANCOMER"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"bank_code"</span><span class="p">:</span><span class="s2">"012"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"debit"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"brand"</span><span class="p">:</span><span class="s2">"mastercard"</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"kgjy0jiami01kkpdoywr"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"card_number"</span><span class="p">:</span><span class="s2">"1111"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"holder_name"</span><span class="p">:</span><span class="s2">"Pedro Paramo"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"expiration_year"</span><span class="p">:</span><span class="s2">"15"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"expiration_month"</span><span class="p">:</span><span class="s2">"12"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"allows_charges"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="s2">"allows_payouts"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="s2">"2013-11-19T13:26:12-06:00"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"bank_name"</span><span class="p">:</span><span class="s2">"BBVA BANCOMER"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"bank_code"</span><span class="p">:</span><span class="s2">"012"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"debit"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"brand"</span><span class="p">:</span><span class="s2">"mastercard"</span><span class="w">
   </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></pre>
<p>Returns a list of registered Merchant or customer cards, if you want to narrow the result you can use filters.</p>

<h3 id="request">Request</h3>

<p>You can search using the following parameters as filters.</p>

<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>creation</td>
<td><strong><em>date</em></strong> <br/>Same as creation date. Format yyyy-mm-dd</td>
</tr>
<tr>
<td>creation[gte]</td>
<td><strong><em>date</em></strong> <br/>After the creation date. Format yyyy-mm-dd</td>
</tr>
<tr>
<td>creation[lte]</td>
<td><strong><em>date</em></strong> <br/>Before the creation date. Format yyyy-mm-dd</td>
</tr>
<tr>
<td>offset</td>
<td><strong><em>numeric</em></strong> <br/>Number of records to skip at the beginning, default 0.</td>
</tr>
<tr>
<td>limit</td>
<td><strong><em>numeric</em></strong> <br/>Number of required records, default 10.</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<p>List of <a href="#card-object">card objects</a> registered according to the parameters provided, sorted by creation date in descending order.</p>

<h1 id="bank-accounts">Bank Accounts</h1>

<p>You can store multiple bank accounts by Merchant or customer for withdraw funds later.</p>

<h2 id="bank-account-object">Bank account object</h2>

<blockquote>
<p>Object example </p>
</blockquote>
<pre class="highlight json"><span class="p">{</span><span class="w">
   </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"brppwl9nwmruogk2do0j"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"clabe"</span><span class="p">:</span><span class="s2">"032180000118359719"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"bank_code"</span><span class="p">:</span><span class="s2">"032"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"bank_name"</span><span class="p">:</span><span class="s2">"IXE"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"alias"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
   </span><span class="s2">"holder_name"</span><span class="p">:</span><span class="s2">"Juan HernÃ¡ndez SÃ¡nchez"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="s2">"2013-11-14T12:29:18-06shell00"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td><strong><em>string</em></strong> <br/>ID of the bank account.</td>
</tr>
<tr>
<td>holder_name</td>
<td><strong><em>string</em></strong> <br/>Holder&rsquo;s full name.</td>
</tr>
<tr>
<td>alias</td>
<td><strong><em>string</em></strong> <br/>Name by which the bank account is identified.</td>
</tr>
<tr>
<td>clabe</td>
<td><strong><em>string</em></strong> <br/>CLABE number assigned to the account.</td>
</tr>
<tr>
<td>bank_name</td>
<td><strong><em>string</em></strong> <br/>Abbreviated name of the bank where the account resides, based on the following catalog of <a href="http://es.wikipedia.org/wiki/CLABE#C.C3.B3digo_de_Banco">Bank codes</a>.</td>
</tr>
<tr>
<td>bank_code</td>
<td><strong><em>string</em></strong> <br/> Bank code where the account resides, based on the following catalog <a href="http://es.wikipedia.org/wiki/CLABE#C.C3.B3digo_de_Banco">Bank Codes</a>.</td>
</tr>
<tr>
<td>creation_dateÂ </td>
<td><strong><em>datetime</em></strong> <br/>Date and time when the bank account was created in ISO 8601 format.</td>
</tr>
</tbody></table>

<h2 id="create-a-bank-account">Create a bank account</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell">POST https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/customers/<span class="o">{</span>CUSTOMER_ID<span class="o">}</span>/bankaccounts
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">customerId</span><span class="p">);</span>
<span class="nv">$bankaccount</span> <span class="o">=</span> <span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">bankaccounts</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="nx">bankDataRequest</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="c1">//Customer</span>
<span class="n">openpayAPI</span><span class="o">.</span><span class="na">bankAccounts</span><span class="o">().</span><span class="na">create</span><span class="o">(</span><span class="n">String</span> <span class="n">customerId</span><span class="o">,</span> <span class="n">BankAccount</span> <span class="n">request</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="c1">//Customer
</span><span class="n">openpayAPI</span><span class="p">.</span><span class="n">BankAccountService</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="kt">string</span> <span class="n">customer_id</span><span class="p">,</span> <span class="n">BankAccount</span> <span class="n">request</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">bankaccounts</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">customerId</span><span class="p">,</span> <span class="nx">bankaccountRequest</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
</pre><pre class="highlight ruby"><span class="c1">#Customer</span>
<span class="vi">@bank_accounts</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:bankaccounts</span><span class="p">)</span>
<span class="vi">@bank_accounts</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="n">request_hash</span><span class="p">,</span> <span class="n">customer_id</span><span class="p">)</span>
</pre>
<blockquote>
<p>Request example</p>
</blockquote>
<pre class="highlight shell">curl https://sandbox-api.openpay.mx/v1/mzdtln0bmtms6o3kck8f/customers/ag4nktpdzebjiye1tlze/bankaccounts <span class="se">\</span>
   -u sk_e568c42a6c384b7ab02cd47d2e407cab: <span class="se">\</span>
   -H <span class="s2">"Content-type: application/json"</span> <span class="se">\</span>
   -X POST -d <span class="s1">'{
   "clabe":"032180000118359719",
   "alias":"Cuenta principal",
   "holder_name":"Juan HernÃ¡ndez SÃ¡nchez"
}'</span>
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$openpay</span> <span class="o">=</span> <span class="nx">Openpay</span><span class="o">::</span><span class="na">getInstance</span><span class="p">(</span><span class="s1">'moiep6umtcnanql3jrxp'</span><span class="p">,</span> <span class="s1">'sk_3433941e467c1055b178ce26348b0fac'</span><span class="p">);</span>

<span class="nv">$bankDataRequest</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'clabe'</span> <span class="o">=&gt;</span> <span class="s1">'072910007380090615'</span><span class="p">,</span>
    <span class="s1">'alias'</span> <span class="o">=&gt;</span> <span class="s1">'Cuenta principal'</span><span class="p">,</span>
    <span class="s1">'holder_name'</span> <span class="o">=&gt;</span> <span class="s1">'Teofilo Velazco'</span><span class="p">);</span>

<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'a9ualumwnrcxkl42l6mh'</span><span class="p">);</span>
<span class="nv">$bankaccount</span> <span class="o">=</span> <span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">bankaccounts</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="nv">$bankDataRequest</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OpenpayAPI</span><span class="o">(</span><span class="s">"https://sandbox-api.openpay.mx"</span><span class="o">,</span> <span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="o">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="o">);</span>
<span class="n">BankAccount</span> <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BankAccount</span><span class="o">();</span>
<span class="n">request</span><span class="o">.</span><span class="na">holderName</span><span class="o">(</span><span class="s">"Juan HernÃ¡ndez SÃ¡nchez"</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">alias</span><span class="o">(</span><span class="s">"Cuenta principal"</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">clabe</span><span class="o">(</span><span class="s">"032XXXXXXXXXX59719"</span><span class="o">);</span>

<span class="n">request</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="na">bankAccounts</span><span class="o">().</span><span class="na">create</span><span class="o">(</span><span class="s">"a9pvykxz4g5rg0fplze0"</span><span class="o">,</span> <span class="n">request</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">OpenpayAPI</span><span class="p">(</span><span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="p">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="p">);</span>
<span class="n">BankAccount</span> <span class="n">request</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">BankAccount</span><span class="p">();</span>
<span class="n">request</span><span class="p">.</span><span class="n">HolderName</span> <span class="p">=</span> <span class="s">"Juan HernÃ¡ndez SÃ¡nchez"</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">Alias</span> <span class="p">=</span> <span class="s">"Cuenta principal"</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">CLABE</span> <span class="p">=</span> <span class="s">"032XXXXXXXXXX59719"</span><span class="p">;</span>

<span class="n">request</span> <span class="p">=</span> <span class="n">api</span><span class="p">.</span><span class="n">BankAccountService</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="s">"a9pvykxz4g5rg0fplze0"</span><span class="p">,</span> <span class="n">request</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="kd">var</span> <span class="nx">bankaccountRequest</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">'clabe'</span> <span class="err">:</span> <span class="s1">'032180000118359719'</span><span class="p">,</span>
  <span class="s1">'alias'</span> <span class="err">:</span> <span class="s1">'Cuenta principal'</span><span class="p">,</span>
  <span class="s1">'holder_name'</span> <span class="err">:</span> <span class="s1">'Juan HernÃ¡ndez SÃ¡nchez'</span>
<span class="p">};</span>

<span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">bankaccounts</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="s1">'a9pvykxz4g5rg0fplze0'</span><span class="p">,</span> <span class="nx">bankaccountRequest</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">bankaccount</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// ...
</span><span class="p">});</span>
</pre><pre class="highlight ruby"><span class="vi">@openpay</span><span class="o">=</span><span class="no">OpenpayApi</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"mzdtln0bmtms6o3kck8f"</span><span class="p">,</span><span class="s2">"sk_e568c42a6c384b7ab02cd47d2e407cab"</span><span class="p">)</span>
<span class="vi">@bank_accounts</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:bankaccounts</span><span class="p">)</span>
<span class="n">request_hash</span><span class="o">=</span><span class="p">{</span>
     <span class="s2">"holder_name"</span> <span class="o">=&gt;</span> <span class="s2">"Juan HernÃ¡ndez SÃ¡nchez"</span><span class="p">,</span>
     <span class="s2">"alias"</span> <span class="o">=&gt;</span> <span class="s2">"Cuenta principal"</span><span class="p">,</span>
     <span class="s2">"clabe"</span> <span class="o">=&gt;</span> <span class="s2">"032XXXXXXXXXX59719"</span>
   <span class="p">}</span>

<span class="n">response_hash</span><span class="o">=</span><span class="vi">@bank_accounts</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="n">request_hash</span><span class="p">.</span><span class="nf">to_hash</span><span class="p">,</span> <span class="s2">"asynwirguzkgq2bizogo"</span><span class="p">)</span>
</pre>
<blockquote>
<p>Response example</p>
</blockquote>
<pre class="highlight json"><span class="p">{</span><span class="w">
   </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"buyj4apkwilpp2jfxr9r"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"clabe"</span><span class="p">:</span><span class="s2">"032XXXXXXXXXX59719"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"bank_code"</span><span class="p">:</span><span class="s2">"032"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"bank_name"</span><span class="p">:</span><span class="s2">"IXE"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"alias"</span><span class="p">:</span><span class="s2">"Cuenta principal"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"holder_name"</span><span class="p">:</span><span class="s2">"Juan HernÃ¡ndez SÃ¡nchez"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="s2">"2014-05-22T11:02:10-05:00"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<p>Creates and assigns a bank account to a specific customer.</p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>holder_name</td>
<td><strong><em>string</em></strong> (required, length  = 80) <br/>Holder&rsquo;s full name.</td>
</tr>
<tr>
<td>alias</td>
<td><strong><em>string</em></strong> (optional, length = 45)<br/>Name by which the bank account is identified.</td>
</tr>
<tr>
<td>clabe</td>
<td><strong><em>string</em></strong> (required, length  = 45) <br/>CLABE number assigned to the account.</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<p>Returns a <a href="#bank-account-object">bank account object</a> or an error when a there is a problem.</p>

<h2 id="get-a-bank-account">Get a bank account</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell">GET https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/customers/<span class="o">{</span>CUSTOMER_ID<span class="o">}</span>/bankaccounts/<span class="o">{</span>BANK_ACCOUNT_ID<span class="o">}</span>
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">customerId</span><span class="p">);</span>
<span class="nv">$bankaccount</span> <span class="o">=</span> <span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">bankaccounts</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">bankAccountId</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="c1">//Customer</span>
<span class="n">openpayAPI</span><span class="o">.</span><span class="na">bankAccounts</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="n">String</span> <span class="n">customerId</span><span class="o">,</span> <span class="n">String</span> <span class="n">bankAccountId</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="c1">//Customer
</span><span class="n">openpayAPI</span><span class="p">.</span><span class="n">BankAccountService</span><span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="kt">string</span> <span class="n">customer_id</span><span class="p">,</span> <span class="kt">string</span> <span class="n">bank_account_id</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">bankaccounts</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">customerId</span><span class="p">,</span> <span class="nx">bankaccountId</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
</pre><pre class="highlight ruby"><span class="c1">#Customer </span>
<span class="vi">@bank_accounts</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:bankaccounts</span><span class="p">)</span>
<span class="vi">@bank_accounts</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">customer_id</span><span class="p">,</span> <span class="n">bankaccount_id</span><span class="p">)</span>
</pre>
<blockquote>
<p>Request example</p>
</blockquote>
<pre class="highlight shell">curl https://sandbox-api.openpay.mx/v1/mzdtln0bmtms6o3kck8f/customers/ag4nktpdzebjiye1tlze/bankaccounts/buyj4apkwilpp2jfxr9r <span class="se">\</span>
   -u sk_e568c42a6c384b7ab02cd47d2e407cab:
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$openpay</span> <span class="o">=</span> <span class="nx">Openpay</span><span class="o">::</span><span class="na">getInstance</span><span class="p">(</span><span class="s1">'moiep6umtcnanql3jrxp'</span><span class="p">,</span> <span class="s1">'sk_3433941e467c1055b178ce26348b0fac'</span><span class="p">);</span>

<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'a9ualumwnrcxkl42l6mh'</span><span class="p">);</span>
<span class="nv">$bankaccount</span> <span class="o">=</span> <span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">bankaccounts</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'b4vcouaavwuvkpufh0so'</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OpenpayAPI</span><span class="o">(</span><span class="s">"https://sandbox-api.openpay.mx"</span><span class="o">,</span> <span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="o">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="o">);</span>
<span class="n">BankAccount</span> <span class="n">bankAccount</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="na">bankAccounts</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="s">"a9pvykxz4g5rg0fplze0"</span><span class="o">,</span> <span class="s">"buyj4apkwilpp2jfxr9r"</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">OpenpayAPI</span><span class="p">(</span><span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="p">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="p">);</span>
<span class="n">BankAccount</span> <span class="n">bankAccount</span> <span class="p">=</span> <span class="n">api</span><span class="p">.</span><span class="n">BankAccountService</span><span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="s">"a9pvykxz4g5rg0fplze0"</span><span class="p">,</span> <span class="s">"buyj4apkwilpp2jfxr9r"</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">bankaccounts</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'a9pvykxz4g5rg0fplze0'</span><span class="p">,</span> <span class="s1">'buyj4apkwilpp2jfxr9r'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">bankaccount</span><span class="p">){</span>
  <span class="c1">// ...
</span><span class="p">});</span>
</pre><pre class="highlight ruby"><span class="vi">@openpay</span><span class="o">=</span><span class="no">OpenpayApi</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"mzdtln0bmtms6o3kck8f"</span><span class="p">,</span><span class="s2">"sk_e568c42a6c384b7ab02cd47d2e407cab"</span><span class="p">)</span>
<span class="vi">@bank_accounts</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:bankaccounts</span><span class="p">)</span>

<span class="n">response_hash</span><span class="o">=</span><span class="vi">@bank_accounts</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="s2">"asynwirguzkgq2bizogo"</span><span class="p">,</span> <span class="s2">"buyj4apkwilpp2jfxr9r"</span><span class="p">)</span>
</pre>
<blockquote>
<p>Response example</p>
</blockquote>
<pre class="highlight json"><span class="p">{</span><span class="w">
   </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"buyj4apkwilpp2jfxr9r"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"clabe"</span><span class="p">:</span><span class="s2">"032XXXXXXXXXX59719"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"bank_code"</span><span class="p">:</span><span class="s2">"032"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"bank_name"</span><span class="p">:</span><span class="s2">"IXE"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"alias"</span><span class="p">:</span><span class="s2">"Cuenta principal"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"holder_name"</span><span class="p">:</span><span class="s2">"Juan HernÃ¡ndez SÃ¡nchez"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="s2">"2014-05-22T11:02:10-05:00"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<p>It obtains the details of the bank account assigned to a customer.</p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td><strong><em>string</em></strong> (required, length = 45) <br/> Unique identifier of the bank account.</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<p>Returns a <a href="#bank-account-object">bank account object</a></p>

<h2 id="delete-a-bank-account">Delete a bank account</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell">DELETE https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/customers/<span class="o">{</span>CUSTOMER_ID<span class="o">}</span>/bankaccounts/<span class="o">{</span>BANK_ACCOUNT_ID<span class="o">}</span>
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">customerId</span><span class="p">);</span>
<span class="nv">$bankaccount</span> <span class="o">=</span> <span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">bankaccounts</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">bankAccountId</span><span class="p">);</span>
<span class="nv">$bankaccount</span><span class="o">-&gt;</span><span class="na">delete</span><span class="p">();</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="c1">//Customer</span>
<span class="n">openpayAPI</span><span class="o">.</span><span class="na">bankAccounts</span><span class="o">().</span><span class="na">delete</span><span class="o">(</span><span class="n">String</span> <span class="n">customerId</span><span class="o">,</span> <span class="n">String</span> <span class="n">bankAccountId</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="c1">//Customer
</span><span class="n">openpayAPI</span><span class="p">.</span><span class="n">BankAccountService</span><span class="p">.</span><span class="nf">Delete</span><span class="p">(</span><span class="kt">string</span> <span class="n">customer_id</span><span class="p">,</span> <span class="kt">string</span> <span class="n">bank_account_id</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">bankaccounts</span><span class="p">.</span><span class="k">delete</span><span class="p">(</span><span class="nx">customerId</span><span class="p">,</span><span class="nx">bankaccountId</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
</pre><pre class="highlight ruby"><span class="c1">#Customer</span>
<span class="vi">@bank_accounts</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:bankaccounts</span><span class="p">)</span>
<span class="vi">@bank_accounts</span><span class="p">.</span><span class="nf">delete</span><span class="p">(</span><span class="n">customer_id</span><span class="p">,</span> <span class="n">bankaccount_id</span><span class="p">)</span>
</pre>
<blockquote>
<p>Request example</p>
</blockquote>
<pre class="highlight shell">curl https://sandbox-api.openpay.mx/v1/mzdtln0bmtms6o3kck8f/customers/ag4nktpdzebjiye1tlze/bankaccounts/buyj4apkwilpp2jfxr9r <span class="se">\</span>
   -u sk_e568c42a6c384b7ab02cd47d2e407cab: <span class="se">\</span>
   -X DELETE
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$openpay</span> <span class="o">=</span> <span class="nx">Openpay</span><span class="o">::</span><span class="na">getInstance</span><span class="p">(</span><span class="s1">'moiep6umtcnanql3jrxp'</span><span class="p">,</span> <span class="s1">'sk_3433941e467c1055b178ce26348b0fac'</span><span class="p">);</span>

<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'a9ualumwnrcxkl42l6mh'</span><span class="p">);</span>
<span class="nv">$bankaccount</span> <span class="o">=</span> <span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">bankaccounts</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'b4vcouaavwuvkpufh0so'</span><span class="p">);</span>
<span class="nv">$bankaccount</span><span class="o">-&gt;</span><span class="na">delete</span><span class="p">();</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OpenpayAPI</span><span class="o">(</span><span class="s">"https://sandbox-api.openpay.mx"</span><span class="o">,</span> <span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="o">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="o">);</span>
<span class="n">api</span><span class="o">.</span><span class="na">bankAccounts</span><span class="o">().</span><span class="na">delete</span><span class="o">(</span><span class="s">"a9pvykxz4g5rg0fplze0"</span><span class="o">,</span> <span class="s">"buyj4apkwilpp2jfxr9r"</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">OpenpayAPI</span><span class="p">(</span><span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="p">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="p">);</span>
<span class="n">api</span><span class="p">.</span><span class="n">BankAccountService</span><span class="p">.</span><span class="nf">Delete</span><span class="p">(</span><span class="s">"a9pvykxz4g5rg0fplze0"</span><span class="p">,</span> <span class="s">"buyj4apkwilpp2jfxr9r"</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">bankaccounts</span><span class="p">.</span><span class="k">delete</span><span class="p">(</span><span class="s1">'a9pvykxz4g5rg0fplze0'</span><span class="p">,</span><span class="s1">'buyj4apkwilpp2jfxr9r'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">){</span>
  <span class="c1">// ...
</span><span class="p">});</span>
</pre><pre class="highlight ruby"><span class="vi">@openpay</span><span class="o">=</span><span class="no">OpenpayApi</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"mzdtln0bmtms6o3kck8f"</span><span class="p">,</span><span class="s2">"sk_e568c42a6c384b7ab02cd47d2e407cab"</span><span class="p">)</span>
<span class="vi">@bank_accounts</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:bankaccounts</span><span class="p">)</span>

<span class="n">response_hash</span><span class="o">=</span><span class="vi">@bank_accounts</span><span class="p">.</span><span class="nf">delete</span><span class="p">(</span><span class="s2">"asynwirguzkgq2bizogo"</span><span class="p">,</span> <span class="s2">"buyj4apkwilpp2jfxr9r"</span><span class="p">)</span>
</pre>
<p>Deletes the bank account associated with the customer. The transactions that are associated with this account are unchanged and will continue for you to consult them.</p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td><strong><em>string</em></strong> (required, length  = 45) <br/> Unique identifier of the bank account.</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<p>If the bank account is removed correctly the answer is empty, if it can not be deleted a <a href="#error-object">error object</a> indicating the reason is returned.</p>

<h2 id="list-of-bank-accounts">List of bank accounts</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell">GET https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/customers/<span class="o">{</span>CUSTOMER_ID<span class="o">}</span>/bankaccounts
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">customerId</span><span class="p">);</span>
<span class="nv">$bankaccountList</span> <span class="o">=</span> <span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">bankaccounts</span><span class="o">-&gt;</span><span class="na">getList</span><span class="p">(</span><span class="nx">findDataRequest</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="c1">//Customer</span>
<span class="n">openpayAPI</span><span class="o">.</span><span class="na">bankAccounts</span><span class="o">().</span><span class="na">list</span><span class="o">(</span><span class="n">String</span> <span class="n">customerId</span><span class="o">,</span> <span class="n">SearchParams</span> <span class="n">request</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="c1">//Customer
</span><span class="n">openpayAPI</span><span class="p">.</span><span class="n">BankAccountService</span><span class="p">.</span><span class="nf">List</span><span class="p">(</span><span class="kt">string</span> <span class="n">customer_id</span><span class="p">,</span> <span class="n">SearchParams</span> <span class="n">request</span> <span class="p">=</span> <span class="k">null</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">bankaccounts</span><span class="p">.</span><span class="nx">list</span><span class="p">(</span><span class="nx">customerId</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
<span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">bankaccounts</span><span class="p">.</span><span class="nx">list</span><span class="p">(</span><span class="nx">customerId</span><span class="p">,</span> <span class="nx">searchParams</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
</pre><pre class="highlight ruby"><span class="c1">#Customer</span>
<span class="vi">@bank_accounts</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:bankaccounts</span><span class="p">)</span>
<span class="vi">@bank_accounts</span><span class="p">.</span><span class="nf">all</span><span class="p">(</span><span class="n">customer_id</span><span class="p">)</span>
</pre>
<blockquote>
<p>Request example</p>
</blockquote>
<pre class="highlight shell">curl -g <span class="s2">"https://sandbox-api.openpay.mx/v1/mzdtln0bmtms6o3kck8f/customers/ag4nktpdzebjiye1tlze/bankaccounts?limit=2"</span> <span class="se">\</span>
   -u sk_e568c42a6c384b7ab02cd47d2e407cab: 
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$openpay</span> <span class="o">=</span> <span class="nx">Openpay</span><span class="o">::</span><span class="na">getInstance</span><span class="p">(</span><span class="s1">'moiep6umtcnanql3jrxp'</span><span class="p">,</span> <span class="s1">'sk_3433941e467c1055b178ce26348b0fac'</span><span class="p">);</span>

<span class="nv">$findDataRequest</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'creation[gte]'</span> <span class="o">=&gt;</span> <span class="s1">'2013-01-01'</span><span class="p">,</span>
    <span class="s1">'creation[lte]'</span> <span class="o">=&gt;</span> <span class="s1">'2013-12-31'</span><span class="p">,</span>
    <span class="s1">'offset'</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">'limit'</span> <span class="o">=&gt;</span> <span class="mi">5</span><span class="p">);</span>

<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'a9ualumwnrcxkl42l6mh'</span><span class="p">);</span>
<span class="nv">$bankaccountList</span> <span class="o">=</span> <span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">bankaccounts</span><span class="o">-&gt;</span><span class="na">getList</span><span class="p">(</span><span class="nv">$findDataRequest</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="kd">final</span> <span class="n">Calendar</span> <span class="n">dateGte</span> <span class="o">=</span> <span class="n">Calendar</span><span class="o">.</span><span class="na">getInstance</span><span class="o">();</span>
<span class="kd">final</span> <span class="n">Calendar</span> <span class="n">dateLte</span> <span class="o">=</span> <span class="n">Calendar</span><span class="o">.</span><span class="na">getInstance</span><span class="o">();</span>
<span class="n">dateGte</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="mi">2014</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">);</span>
<span class="n">dateLte</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="mi">2014</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">15</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">);</span>

<span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OpenpayAPI</span><span class="o">(</span><span class="s">"https://sandbox-api.openpay.mx"</span><span class="o">,</span> <span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="o">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="o">);</span>
<span class="n">SearchParams</span> <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SearchParams</span><span class="o">();</span>
<span class="n">request</span><span class="o">.</span><span class="na">creationGte</span><span class="o">(</span><span class="n">dateGte</span><span class="o">.</span><span class="na">getTime</span><span class="o">());</span>
<span class="n">request</span><span class="o">.</span><span class="na">creationLte</span><span class="o">(</span><span class="n">dateLte</span><span class="o">.</span><span class="na">getTime</span><span class="o">());</span>
<span class="n">request</span><span class="o">.</span><span class="na">offset</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">limit</span><span class="o">(</span><span class="mi">100</span><span class="o">);</span>

<span class="n">List</span><span class="o">&lt;</span><span class="n">BankAccount</span><span class="o">&gt;</span> <span class="n">bankAccounts</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="na">bankAccounts</span><span class="o">().</span><span class="na">list</span><span class="o">(</span><span class="s">"a9pvykxz4g5rg0fplze0"</span><span class="o">,</span> <span class="n">request</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">OpenpayAPI</span><span class="p">(</span><span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="p">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="p">);</span>
<span class="n">SearchParams</span> <span class="n">request</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SearchParams</span><span class="p">();</span>
<span class="n">request</span><span class="p">.</span><span class="n">CreationGte</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Datetime</span><span class="p">(</span><span class="m">2014</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">1</span><span class="p">);</span>
<span class="n">request</span><span class="p">.</span><span class="n">CreationLte</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">2014</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">15</span><span class="p">);</span>
<span class="n">request</span><span class="p">.</span><span class="n">Offset</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">Limit</span> <span class="p">=</span> <span class="m">100</span><span class="p">;</span>

<span class="n">List</span><span class="p">&lt;</span><span class="n">BankAccount</span><span class="p">&gt;</span> <span class="n">banckAccounts</span> <span class="p">=</span> <span class="n">api</span><span class="p">.</span><span class="n">BankAccountService</span><span class="p">.</span><span class="nf">List</span><span class="p">(</span><span class="s">"a9pvykxz4g5rg0fplze0"</span><span class="p">,</span> <span class="n">request</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="kd">var</span> <span class="nx">searchParams</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">'limit'</span> <span class="err">:</span> <span class="mi">2</span>
<span class="p">};</span>

<span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">bankaccounts</span><span class="p">.</span><span class="nx">list</span><span class="p">(</span><span class="s1">'ag4nktpdzebjiye1tlze'</span><span class="p">,</span> <span class="nx">searchParams</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">list</span><span class="p">){</span>
  <span class="c1">// ...
</span><span class="p">});</span>
</pre><pre class="highlight ruby"><span class="vi">@openpay</span><span class="o">=</span><span class="no">OpenpayApi</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"mzdtln0bmtms6o3kck8f"</span><span class="p">,</span><span class="s2">"sk_e568c42a6c384b7ab02cd47d2e407cab"</span><span class="p">)</span>
<span class="vi">@bank_accounts</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:bankaccounts</span><span class="p">)</span>

<span class="n">response_hash</span><span class="o">=</span><span class="vi">@bank_accounts</span><span class="p">.</span><span class="nf">all</span><span class="p">(</span><span class="s2">"asynwirguzkgq2bizogo"</span><span class="p">)</span>
</pre>
<blockquote>
<p>Response Example</p>
</blockquote>
<pre class="highlight json"><span class="p">[{</span><span class="w">
   </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"brppwl9nwmruogk2do0j"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"clabe"</span><span class="p">:</span><span class="s2">"032180000118359719"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"bank_code"</span><span class="p">:</span><span class="s2">"032"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"bank_name"</span><span class="p">:</span><span class="s2">"IXE"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"alias"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
   </span><span class="s2">"holder_name"</span><span class="p">:</span><span class="s2">"Juan HernÃ¡ndez SÃ¡nchez"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="s2">"2013-11-14T12:29:18-06:00"</span><span class="w">
</span><span class="p">},</span><span class="w">
</span><span class="p">{</span><span class="w">
   </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"bb0zt72rxoyiwz9jzzai"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"clabe"</span><span class="p">:</span><span class="s2">"012680012426485980"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"bank_code"</span><span class="p">:</span><span class="s2">"012"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"bank_name"</span><span class="p">:</span><span class="s2">"BANCOMER"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"alias"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
   </span><span class="s2">"holder_name"</span><span class="p">:</span><span class="s2">"Juan HernÃ¡ndez SÃ¡nchez"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="s2">"2013-11-14T18:07:45-06:00"</span><span class="w">
</span><span class="p">}]</span><span class="w">
</span></pre>
<p>Returns the details of all the bank accounts of the customer specified on the request.</p>

<h3 id="request">Request</h3>

<p>You can search using the following parameters as filters.</p>

<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>creation</td>
<td><strong><em>date</em></strong> <br/>Same as creation date. Format yyyy-mm-dd</td>
</tr>
<tr>
<td>creation[gte]</td>
<td><strong><em>date</em></strong> <br/>After the creation date. Format yyyy-mm-dd</td>
</tr>
<tr>
<td>creation[lte]</td>
<td><strong><em>date</em></strong> <br/>Before the creation date. Format yyyy-mm-dd</td>
</tr>
<tr>
<td>offset</td>
<td><strong><em>numeric</em></strong> <br/>Number of records to skip at the beginning, default 0.</td>
</tr>
<tr>
<td>limit</td>
<td><strong><em>numeric</em></strong> <br/>Number of required records, default 10.</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<p>List of <a href="#bank-account-object">bank account objects</a> registered according to the given parameters, sorted by creation date in descending order. </p>

<h1 id="plans">Plans</h1>

<p>Plans are an Openpay resource that allows create templates for subscriptions.  Using plans you can define the amount and frequency of recurrent charges.</p>

<h2 id="plan-object">Plan Object</h2>

<blockquote>
<p>Object example</p>
</blockquote>
<pre class="highlight json"><span class="p">{</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Curso de ingles"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"active"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">150</span><span class="p">,</span><span class="w">
    </span><span class="s2">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MXN"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"patpflacwilazguj6bem"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2013-12-13T09:43:52-06:00"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"repeat_every"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="s2">"repeat_unit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"month"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"retry_times"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="s2">"status_after_retry"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cancelled"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"trial_days"</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td><strong><em>string</em></strong> <br/> Unique plan identifier.</td>
</tr>
<tr>
<td>creation_date</td>
<td><strong><em>datetime</em></strong> <br/> Date and time in which the plan was created in ISO 8601 format.</td>
</tr>
<tr>
<td>name</td>
<td><strong><em>string</em></strong> <br/> Plan name.</td>
</tr>
<tr>
<td>amount</td>
<td><strong><em>numeric</em></strong> <br/> Amount that will be applied once the subscription is charged.  It has to be more than zero and it can have up to two decimal places.</td>
</tr>
<tr>
<td>currency</td>
<td><strong><em>string</em></strong> <br/> Currency used in the operation, by default is MXN (Mexican pesos).</td>
</tr>
<tr>
<td>repeat_every</td>
<td><strong><em>numeric</em></strong> <br/>  Time units in which the subscription will be charged.  For example, repeat_unit=month and repeat_every=2 indicates that it will be charged every 2 months.</td>
</tr>
<tr>
<td>repeat_unit</td>
<td><strong><em>string</em></strong> <br/> Describes the charge unit frequency.  It can be weekly(week), monthly(month) or yearly (year).</td>
</tr>
<tr>
<td>retry_times</td>
<td><strong><em>numeric</em></strong> <br/> Number of attempts to try to charge the subscription.  When the attempts have been exhausted, the status field is determined by the field <em>status_after_retry</em>.</td>
</tr>
<tr>
<td>status</td>
<td><strong><em>string</em></strong> <br/> Plan status can be <em>active</em> or <em>deleted</em>.  If the plan is in <em>deleted</em> state it doesn&rsquo;t allow to register new subscriptions under this plan but existing subscriptions will be charged.</td>
</tr>
<tr>
<td>status_after_retry</td>
<td><strong><em>string</em></strong> <br/> This field indicates the status in which the subscription will be set once all the charge attempts have been exhausted.  It can be <em>unpaid</em> or <em>cancelled</em>.</td>
</tr>
<tr>
<td>trial_days</td>
<td><strong><em>numeric</em></strong> <br/> Number of trial days this subscription will have by default.</td>
</tr>
</tbody></table>

<h2 id="create-a-new-plan">Create a new Plan</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell">POST https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/plans
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$plan</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">plans</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="nx">planDataRequest</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">openpayAPI</span><span class="o">.</span><span class="na">plans</span><span class="o">().</span><span class="na">create</span><span class="o">(</span><span class="n">Plan</span> <span class="n">request</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">openpayAPI</span><span class="p">.</span><span class="n">PlanService</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="n">Plan</span> <span class="n">plan</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="nx">openpay</span><span class="p">.</span><span class="nx">plans</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">planRequest</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
</pre><pre class="highlight ruby"><span class="c1">#Customere</span>
<span class="vi">@plans</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:plans</span><span class="p">)</span>
<span class="vi">@plans</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="n">request_hash</span><span class="p">)</span>
</pre>
<blockquote>
<p>Request example</p>
</blockquote>
<pre class="highlight shell">curl https://sandbox-api.openpay.mx/v1/mzdtln0bmtms6o3kck8f/plans <span class="se">\</span>
   -u sk_e568c42a6c384b7ab02cd47d2e407cab: <span class="se">\</span>
   -H <span class="s2">"Content-type: application/json"</span> <span class="se">\</span>
   -X POST -d <span class="s1">'{
  "amount": 150.00,
  "status_after_retry": "cancelled",
  "retry_times": 2,
  "name": "Curso de ingles",
  "repeat_unit": "month",
  "trial_days": "30",
  "repeat_every": "1"
}'</span> 
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$openpay</span> <span class="o">=</span> <span class="nx">Openpay</span><span class="o">::</span><span class="na">getInstance</span><span class="p">(</span><span class="s1">'moiep6umtcnanql3jrxp'</span><span class="p">,</span> <span class="s1">'sk_3433941e467c1055b178ce26348b0fac'</span><span class="p">);</span>

<span class="nv">$planDataRequest</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'amount'</span> <span class="o">=&gt;</span> <span class="mf">150.00</span><span class="p">,</span>
    <span class="s1">'status_after_retry'</span> <span class="o">=&gt;</span> <span class="s1">'cancelled'</span><span class="p">,</span>
    <span class="s1">'retry_times'</span> <span class="o">=&gt;</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'Plan Curso Verano'</span><span class="p">,</span>
    <span class="s1">'repeat_unit'</span> <span class="o">=&gt;</span> <span class="s1">'month'</span><span class="p">,</span>
    <span class="s1">'trial_days'</span> <span class="o">=&gt;</span> <span class="s1">'30'</span><span class="p">,</span>
    <span class="s1">'repeat_every'</span> <span class="o">=&gt;</span> <span class="s1">'1'</span><span class="p">,</span>
    <span class="s1">'currency'</span> <span class="o">=&gt;</span> <span class="s1">'MXN'</span><span class="p">);</span>

<span class="nv">$plan</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">plans</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="nv">$planDataRequest</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OpenpayAPI</span><span class="o">(</span><span class="s">"https://sandbox-api.openpay.mx"</span><span class="o">,</span> <span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="o">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="o">);</span>
<span class="n">Plan</span> <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Plan</span><span class="o">();</span>
<span class="n">request</span><span class="o">.</span><span class="na">name</span><span class="o">(</span><span class="s">"Curso de ingles"</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">amount</span><span class="o">(</span><span class="k">new</span> <span class="n">BigDecimal</span><span class="o">(</span><span class="s">"100.00"</span><span class="o">));</span>
<span class="n">request</span><span class="o">.</span><span class="na">repeatEvery</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">PlanRepeatUnit</span><span class="o">.</span><span class="na">WEEK</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">retryTimes</span><span class="o">(</span><span class="mi">3</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">statusAfterRetry</span><span class="o">(</span><span class="n">PlanStatusAfterRetry</span><span class="o">.</span><span class="na">UNPAID</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">trialDays</span><span class="o">(</span><span class="mi">30</span><span class="o">);</span>

<span class="n">request</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="na">plans</span><span class="o">().</span><span class="na">create</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">OpenpayAPI</span><span class="p">(</span><span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="p">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="p">);</span>
<span class="n">Plan</span> <span class="n">request</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Plan</span><span class="p">();</span>
<span class="n">request</span><span class="p">.</span><span class="n">Name</span> <span class="p">=</span> <span class="s">"Curso de ingles"</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">Amount</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Decimal</span><span class="p">(</span><span class="m">100.00</span><span class="p">);</span>
<span class="n">request</span><span class="p">.</span><span class="n">RepeatEvery</span> <span class="p">=</span> <span class="m">1</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">RepeatUnit</span> <span class="p">=</span> <span class="s">"week"</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">RetryTimes</span> <span class="p">=</span> <span class="m">2</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">StatusAfterRetry</span> <span class="p">=</span> <span class="s">"unpaid"</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">TrialDays</span> <span class="p">=</span> <span class="m">30</span><span class="p">;</span>

<span class="n">request</span> <span class="p">=</span> <span class="n">api</span><span class="p">.</span><span class="n">PlanService</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="n">request</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="kd">var</span> <span class="nx">planRequest</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">'amount'</span><span class="err">:</span> <span class="mf">150.00</span><span class="p">,</span>
  <span class="s1">'status_after_retry'</span><span class="err">:</span> <span class="s1">'cancelled'</span><span class="p">,</span>
  <span class="s1">'retry_times'</span><span class="err">:</span> <span class="mi">2</span><span class="p">,</span>
  <span class="s1">'name'</span><span class="err">:</span> <span class="s1">'Curso de ingles'</span><span class="p">,</span>
  <span class="s1">'repeat_unit'</span><span class="err">:</span> <span class="s1">'month'</span><span class="p">,</span>
  <span class="s1">'trial_days'</span><span class="err">:</span> <span class="s1">'30'</span><span class="p">,</span>
  <span class="s1">'repeat_every'</span><span class="err">:</span> <span class="s1">'1'</span>
<span class="p">};</span>

<span class="nx">openpay</span><span class="p">.</span><span class="nx">plans</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">planRequest</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">plan</span><span class="p">){</span>
  <span class="c1">// ...
</span><span class="p">});</span>
</pre><pre class="highlight ruby"><span class="vi">@openpay</span><span class="o">=</span><span class="no">OpenpayApi</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"mzdtln0bmtms6o3kck8f"</span><span class="p">,</span><span class="s2">"sk_e568c42a6c384b7ab02cd47d2e407cab"</span><span class="p">)</span>
<span class="vi">@plans</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:plans</span><span class="p">)</span>
<span class="n">request_hash</span><span class="o">=</span><span class="p">{</span>
     <span class="s2">"name"</span> <span class="o">=&gt;</span> <span class="s2">"Curso de ingles"</span><span class="p">,</span>
     <span class="s2">"amount"</span> <span class="o">=&gt;</span> <span class="mi">150</span><span class="o">.</span><span class="mo">00</span><span class="p">,</span>
     <span class="s2">"repeat_every"</span> <span class="o">=&gt;</span> <span class="s2">"1"</span><span class="p">,</span>
     <span class="s2">"repeat_unit"</span> <span class="o">=&gt;</span> <span class="s2">"month"</span><span class="p">,</span>
     <span class="s2">"retry_times"</span> <span class="o">=&gt;</span> <span class="mi">2</span><span class="p">,</span>
     <span class="s2">"status_after_retry"</span> <span class="o">=&gt;</span> <span class="s2">"cancelled"</span><span class="p">,</span>
     <span class="s2">"trial_days"</span> <span class="o">=&gt;</span> <span class="s2">"30"</span>
   <span class="p">}</span>

<span class="n">response_hash</span><span class="o">=</span><span class="vi">@plans</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="n">request_hash</span><span class="p">.</span><span class="nf">to_hash</span><span class="p">)</span>
</pre>
<blockquote>
<p>Response example</p>
</blockquote>
<pre class="highlight json"><span class="p">{</span><span class="w">
   </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"p8e6x3hafqqsbmnoevrt"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"name"</span><span class="p">:</span><span class="s2">"Curso de ingles"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"status"</span><span class="p">:</span><span class="s2">"active"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"amount"</span><span class="p">:</span><span class="mf">150.00</span><span class="p">,</span><span class="w">
   </span><span class="s2">"currency"</span><span class="p">:</span><span class="s2">"MXN"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="s2">"2014-05-22T12:29:31-05:00"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"repeat_every"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
   </span><span class="s2">"repeat_unit"</span><span class="p">:</span><span class="s2">"month"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"retry_times"</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="w">
   </span><span class="s2">"status_after_retry"</span><span class="p">:</span><span class="s2">"cancelled"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"trial_days"</span><span class="p">:</span><span class="mi">30</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<p>Creates a new plan for allowing customers to subscribe.</p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td><strong><em>string</em></strong> (required, length = 255) <br/>Plan&rsquo;s name.</td>
</tr>
<tr>
<td>amount</td>
<td><strong><em>numeric</em></strong> (required) <br/> Amount that will be charged at subscription.  It needs to be more than zero and can have up to two decimal places.</td>
</tr>
<tr>
<td>repeat_every</td>
<td><strong><em>numeric</em></strong> (required) <br/>Time units in which the subscription will be charged.  For example, repeat_unit=month and repeat_every=2 indicates that it will be charged every 2 months.</td>
</tr>
<tr>
<td>repeat_unit</td>
<td><strong><em>numeric</em></strong> (required) <br/>Describes the charge unit frequency.  It can be weekly(week), monthly(month) or yearly (year).</td>
</tr>
<tr>
<td>retry_times</td>
<td><strong><em>numeric</em></strong> (optional) <br/> Number of attempts to try to charge the subscription.  When the attempts have been exhausted, the status field is determined by the field <em>status_after_retry</em>.</td>
</tr>
<tr>
<td>status_after_retry</td>
<td><strong><em>string</em></strong> (required, values = &ldquo;UNPAID/CANCELLED&rdquo;) <br/>This field indicates the status in which the subscription will be set once all the charge attempts have been exhausted.  It can be <em>unpaid</em> or <em>cancelled</em>.</td>
</tr>
<tr>
<td>trial_days</td>
<td><strong><em>numeric</em></strong> (required) <br/> Number of trial days this subscription will have by default.</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<p>Returns the created <a href="#plan-object">plan object</a> or an error in case an issue occurred.</p>

<h2 id="update-existing-plans.">Update existing plans.</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell">PUT https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/plans/<span class="o">{</span>PLAN_ID<span class="o">}</span>
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$plan</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">plans</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">planId</span><span class="p">);</span>
<span class="nv">$plan</span><span class="o">-&gt;</span><span class="na">save</span><span class="p">();</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">openpayAPI</span><span class="o">.</span><span class="na">plans</span><span class="o">().</span><span class="na">update</span><span class="o">(</span><span class="n">Plan</span> <span class="n">request</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">openpayAPI</span><span class="p">.</span><span class="n">PlanService</span><span class="p">.</span><span class="nf">Update</span><span class="p">(</span><span class="n">Plan</span> <span class="n">plan</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="nx">openpay</span><span class="p">.</span><span class="nx">plans</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">planId</span><span class="p">,</span> <span class="nx">planRequest</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
</pre><pre class="highlight ruby"><span class="c1">#Customer</span>
<span class="vi">@plans</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:plans</span><span class="p">)</span>
<span class="vi">@plans</span><span class="p">.</span><span class="nf">update</span><span class="p">(</span><span class="n">request_hash</span><span class="p">,</span> <span class="n">plan_id</span><span class="p">)</span>
</pre>
<blockquote>
<p>Request example</p>
</blockquote>
<pre class="highlight shell">curl https://sandbox-api.openpay.mx/v1/mzdtln0bmtms6o3kck8f/plans/p8e6x3hafqqsbmnoevrt <span class="se">\</span>
   -u sk_e568c42a6c384b7ab02cd47d2e407cab: <span class="se">\</span>
   -H <span class="s2">"Content-type: application/json"</span> <span class="se">\</span>
   -X PUT -d <span class="s1">'{
      "name": "Curso de aleman",
      "trial_days": "60"
   }'</span> 
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$openpay</span> <span class="o">=</span> <span class="nx">Openpay</span><span class="o">::</span><span class="na">getInstance</span><span class="p">(</span><span class="s1">'moiep6umtcnanql3jrxp'</span><span class="p">,</span> <span class="s1">'sk_3433941e467c1055b178ce26348b0fac'</span><span class="p">);</span>

<span class="nv">$plan</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">plans</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'pduar9iitv4enjftuwyl'</span><span class="p">);</span>
<span class="nv">$plan</span><span class="o">-&gt;</span><span class="na">name</span> <span class="o">=</span> <span class="s1">'Plan Curso de Verano 2014'</span><span class="p">;</span>
<span class="nv">$plan</span><span class="o">-&gt;</span><span class="na">save</span><span class="p">();</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OpenpayAPI</span><span class="o">(</span><span class="s">"https://sandbox-api.openpay.mx"</span><span class="o">,</span> <span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="o">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="o">);</span>
<span class="n">Plan</span> <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Plan</span><span class="o">();</span>
<span class="n">request</span><span class="o">.</span><span class="na">setId</span><span class="o">(</span><span class="s">"p8e6x3hafqqsbmnoevrt"</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">name</span><span class="o">(</span><span class="s">"Curso de ingles"</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">trialDays</span><span class="o">(</span><span class="mi">30</span><span class="o">);</span>

<span class="n">request</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="na">plans</span><span class="o">().</span><span class="na">update</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">OpenpayAPI</span><span class="p">(</span><span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="p">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="p">);</span>
<span class="n">Plan</span> <span class="n">request</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Plan</span><span class="p">();</span>
<span class="n">request</span><span class="p">.</span><span class="n">Id</span> <span class="p">=</span> <span class="s">"p8e6x3hafqqsbmnoevrt"</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">Name</span> <span class="p">=</span> <span class="s">"Curso de ingles"</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">TrialDays</span> <span class="p">=</span> <span class="m">30</span><span class="p">;</span>

<span class="n">request</span> <span class="p">=</span> <span class="n">api</span><span class="p">.</span><span class="n">PlanService</span><span class="p">.</span><span class="nf">Update</span><span class="p">(</span><span class="n">request</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="kd">var</span> <span class="nx">planRequest</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">'name'</span><span class="err">:</span> <span class="s1">'Curso de aleman'</span><span class="p">,</span>
  <span class="s1">'trial_days'</span><span class="err">:</span> <span class="mi">60</span>
<span class="p">};</span>

<span class="nx">openpay</span><span class="p">.</span><span class="nx">plans</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">planId</span><span class="p">,</span> <span class="nx">planRequest</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">plan</span><span class="p">){</span>
  <span class="c1">// ...
</span><span class="p">});</span>
</pre><pre class="highlight ruby"><span class="vi">@openpay</span><span class="o">=</span><span class="no">OpenpayApi</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"mzdtln0bmtms6o3kck8f"</span><span class="p">,</span><span class="s2">"sk_e568c42a6c384b7ab02cd47d2e407cab"</span><span class="p">)</span>
<span class="vi">@plans</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:plans</span><span class="p">)</span>
<span class="n">request_hash</span><span class="o">=</span><span class="p">{</span>
     <span class="s2">"name"</span> <span class="o">=&gt;</span> <span class="s2">"Curso de ingles"</span><span class="p">,</span>
     <span class="s2">"trial_days"</span> <span class="o">=&gt;</span> <span class="s2">"30"</span>
   <span class="p">}</span>

<span class="n">response_hash</span><span class="o">=</span><span class="vi">@plans</span><span class="p">.</span><span class="nf">update</span><span class="p">(</span><span class="n">request_hash</span><span class="p">.</span><span class="nf">to_hash</span><span class="p">,</span> <span class="s2">"p8e6x3hafqqsbmnoevrt"</span><span class="p">)</span>
</pre>
<blockquote>
<p>Response example</p>
</blockquote>
<pre class="highlight json"><span class="p">{</span><span class="w">
   </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"p8e6x3hafqqsbmnoevrt"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"name"</span><span class="p">:</span><span class="s2">"Curso de aleman"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"status"</span><span class="p">:</span><span class="s2">"active"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"amount"</span><span class="p">:</span><span class="mf">150.00</span><span class="p">,</span><span class="w">
   </span><span class="s2">"currency"</span><span class="p">:</span><span class="s2">"MXN"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="s2">"2014-05-22T12:29:31-05:00"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"repeat_every"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
   </span><span class="s2">"repeat_unit"</span><span class="p">:</span><span class="s2">"month"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"retry_times"</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="w">
   </span><span class="s2">"status_after_retry"</span><span class="p">:</span><span class="s2">"cancelled"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"trial_days"</span><span class="p">:</span><span class="mi">60</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<p>Updates the plan information.  It requires a plan id and only certain fields can be updated.</p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td><strong><em>string</em></strong> (optional, length = 80) <br/>Plan&rsquo;s name.</td>
</tr>
<tr>
<td>trial_days</td>
<td><strong><em>numeric</em></strong> (optional) <br/> Number of trial days this subscription will have by default.</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<p>Returns a <a href="#plan-object">plan object</a> with the updated information or an <a href="#error-object">error response</a> if a problem occurred with the update.</p>

<h2 id="get-a-plan">Get a plan</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell">GET https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/plans/<span class="o">{</span>PLAN_ID<span class="o">}</span>
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$plan</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">plans</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">planId</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">openpayAPI</span><span class="o">.</span><span class="na">plans</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="n">String</span> <span class="n">planId</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">openpayAPI</span><span class="p">.</span><span class="n">PlanService</span><span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="kt">string</span> <span class="n">plan_id</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="nx">openpay</span><span class="p">.</span><span class="nx">plans</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">planId</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
</pre><pre class="highlight ruby"><span class="c1">#Customer</span>
<span class="vi">@plans</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:plans</span><span class="p">)</span>
<span class="vi">@plans</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">plan_id</span><span class="p">)</span>
</pre>
<blockquote>
<p>Request example</p>
</blockquote>
<pre class="highlight shell">curl https://sandbox-api.openpay.mx/v1/mzdtln0bmtms6o3kck8f/plans/p8e6x3hafqqsbmnoevrt <span class="se">\</span>
   -u sk_e568c42a6c384b7ab02cd47d2e407cab:
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$openpay</span> <span class="o">=</span> <span class="nx">Openpay</span><span class="o">::</span><span class="na">getInstance</span><span class="p">(</span><span class="s1">'moiep6umtcnanql3jrxp'</span><span class="p">,</span> <span class="s1">'sk_3433941e467c1055b178ce26348b0fac'</span><span class="p">);</span>

<span class="nv">$plan</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">plans</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'pduar9iitv4enjftuwyl'</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OpenpayAPI</span><span class="o">(</span><span class="s">"https://sandbox-api.openpay.mx"</span><span class="o">,</span> <span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="o">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="o">);</span>
<span class="n">Plan</span> <span class="n">plan</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="na">plans</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="s">"p8e6x3hafqqsbmnoevrt"</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">OpenpayAPI</span><span class="p">(</span><span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="p">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="p">);</span>
<span class="n">Plan</span> <span class="n">plan</span> <span class="p">=</span> <span class="n">api</span><span class="p">.</span><span class="n">PlanService</span><span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="s">"p8e6x3hafqqsbmnoevrt"</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="nx">openpay</span><span class="p">.</span><span class="nx">plans</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'p8e6x3hafqqsbmnoevrt'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">plan</span><span class="p">){</span>
  <span class="c1">// ...
</span><span class="p">});</span>
</pre><pre class="highlight ruby"><span class="vi">@openpay</span><span class="o">=</span><span class="no">OpenpayApi</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"mzdtln0bmtms6o3kck8f"</span><span class="p">,</span><span class="s2">"sk_e568c42a6c384b7ab02cd47d2e407cab"</span><span class="p">)</span>
<span class="vi">@plans</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:plans</span><span class="p">)</span>

<span class="n">response_hash</span><span class="o">=</span><span class="vi">@plans</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="s2">"p8e6x3hafqqsbmnoevrt"</span><span class="p">)</span>
</pre>
<blockquote>
<p>Response example</p>
</blockquote>
<pre class="highlight json"><span class="p">{</span><span class="w">
   </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"p8e6x3hafqqsbmnoevrt"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"name"</span><span class="p">:</span><span class="s2">"Curso de aleman"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"status"</span><span class="p">:</span><span class="s2">"active"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"amount"</span><span class="p">:</span><span class="mf">150.00</span><span class="p">,</span><span class="w">
   </span><span class="s2">"currency"</span><span class="p">:</span><span class="s2">"MXN"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="s2">"2014-05-22T12:29:31-05:00"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"repeat_every"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
   </span><span class="s2">"repeat_unit"</span><span class="p">:</span><span class="s2">"month"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"retry_times"</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="w">
   </span><span class="s2">"status_after_retry"</span><span class="p">:</span><span class="s2">"cancelled"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"trial_days"</span><span class="p">:</span><span class="mi">60</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<p>It gets the plan details.</p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td><strong><em>string</em></strong> (required, length = 45) <br/> Plan identifier.</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<p>Returns a <a href="#plan-object">plan object</a></p>

<h2 id="delete-a-plan">Delete a plan</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell">DELETE https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/plans/<span class="o">{</span>PLAN_ID<span class="o">}</span>
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">customerId</span><span class="p">);</span>
<span class="nv">$plan</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">plans</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">planId</span><span class="p">);</span>
<span class="nv">$plan</span><span class="o">-&gt;</span><span class="na">delete</span><span class="p">();</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">openpayAPI</span><span class="o">.</span><span class="na">plans</span><span class="o">().</span><span class="na">delete</span><span class="o">(</span><span class="n">String</span> <span class="n">planId</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">openpayAPI</span><span class="p">.</span><span class="n">PlanService</span><span class="p">.</span><span class="nf">Delete</span><span class="p">(</span><span class="kt">string</span> <span class="n">plan_id</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="nx">openpay</span><span class="p">.</span><span class="nx">plans</span><span class="p">.</span><span class="k">delete</span><span class="p">(</span><span class="nx">planId</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
</pre><pre class="highlight ruby"><span class="c1">#Customer</span>
<span class="vi">@plans</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:plans</span><span class="p">)</span>
<span class="vi">@plans</span><span class="p">.</span><span class="nf">delete</span><span class="p">(</span><span class="n">plan_id</span><span class="p">)</span>
</pre>
<blockquote>
<p>Request example</p>
</blockquote>
<pre class="highlight shell">curl https://sandbox-api.openpay.mx/v1/mzdtln0bmtms6o3kck8f/plans/p8e6x3hafqqsbmnoevrt <span class="se">\</span>
   -u sk_e568c42a6c384b7ab02cd47d2e407cab: <span class="se">\</span>
   -X DELETE
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$openpay</span> <span class="o">=</span> <span class="nx">Openpay</span><span class="o">::</span><span class="na">getInstance</span><span class="p">(</span><span class="s1">'moiep6umtcnanql3jrxp'</span><span class="p">,</span> <span class="s1">'sk_3433941e467c1055b178ce26348b0fac'</span><span class="p">);</span>

<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'a9ualumwnrcxkl42l6mh'</span><span class="p">);</span>
<span class="nv">$plan</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">plans</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'pduar9iitv4enjftuwyl'</span><span class="p">);</span>
<span class="nv">$plan</span><span class="o">-&gt;</span><span class="na">delete</span><span class="p">();</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OpenpayAPI</span><span class="o">(</span><span class="s">"https://sandbox-api.openpay.mx"</span><span class="o">,</span> <span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="o">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="o">);</span>
<span class="n">api</span><span class="o">.</span><span class="na">plans</span><span class="o">().</span><span class="na">delete</span><span class="o">(</span><span class="s">"p8e6x3hafqqsbmnoevrt"</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">OpenpayAPI</span><span class="p">(</span><span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="p">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="p">);</span>
<span class="n">api</span><span class="p">.</span><span class="n">PlanService</span><span class="p">.</span><span class="nf">Delete</span><span class="p">(</span><span class="s">"p8e6x3hafqqsbmnoevrt"</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="nx">openpay</span><span class="p">.</span><span class="nx">plans</span><span class="p">.</span><span class="k">delete</span><span class="p">(</span><span class="s1">'p8e6x3hafqqsbmnoevrt'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">){</span>
  <span class="c1">// ...
</span><span class="p">});</span>
</pre><pre class="highlight ruby"><span class="vi">@openpay</span><span class="o">=</span><span class="no">OpenpayApi</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"mzdtln0bmtms6o3kck8f"</span><span class="p">,</span><span class="s2">"sk_e568c42a6c384b7ab02cd47d2e407cab"</span><span class="p">)</span>
<span class="vi">@plans</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:plans</span><span class="p">)</span>

<span class="n">response_hash</span><span class="o">=</span><span class="vi">@plans</span><span class="p">.</span><span class="nf">delete</span><span class="p">(</span><span class="s2">"p8e6x3hafqqsbmnoevrt"</span><span class="p">)</span>
</pre>
<p>When a plan is deleted it won&rsquo;t allow to create more subscriptions associated with it, however the subscriptions already associated will continue to be charged.</p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td><strong><em>string</em></strong> (required, length = 45) <br/> Identifier of the plan that will be deleted.</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<p>If the plan is deleted correctly the response will be empty, if it cannot be deleted an <a href="#error-object">error object</a> will be returned indicating the reason.</p>

<h2 id="plan-list">Plan list</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell">GET https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/plans
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$planList</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">plans</span><span class="o">-&gt;</span><span class="na">getList</span><span class="p">(</span><span class="nx">findDataRequest</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">openpayAPI</span><span class="o">.</span><span class="na">plans</span><span class="o">().</span><span class="na">list</span><span class="o">(</span><span class="n">SearchParams</span> <span class="n">request</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">openpayAPI</span><span class="p">.</span><span class="n">PlanService</span><span class="p">.</span><span class="nf">List</span><span class="p">(</span><span class="n">SearchParams</span> <span class="n">request</span> <span class="p">=</span> <span class="k">null</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="nx">openpay</span><span class="p">.</span><span class="nx">plans</span><span class="p">.</span><span class="nx">list</span><span class="p">(</span><span class="nx">callback</span><span class="p">);</span>
<span class="nx">openpay</span><span class="p">.</span><span class="nx">plans</span><span class="p">.</span><span class="nx">list</span><span class="p">(</span><span class="nx">searchParams</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
</pre><pre class="highlight ruby"><span class="c1">#Customer</span>
<span class="vi">@plans</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:plans</span><span class="p">)</span>
<span class="vi">@plans</span><span class="p">.</span><span class="nf">all</span>
</pre>
<blockquote>
<p>Request example</p>
</blockquote>
<pre class="highlight shell">curl -g <span class="s2">"https://sandbox-api.openpay.mx/v1/mzdtln0bmtms6o3kck8f/plans?limit=10"</span> <span class="se">\</span>
   -u sk_e568c42a6c384b7ab02cd47d2e407cab: 
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$openpay</span> <span class="o">=</span> <span class="nx">Openpay</span><span class="o">::</span><span class="na">getInstance</span><span class="p">(</span><span class="s1">'moiep6umtcnanql3jrxp'</span><span class="p">,</span> <span class="s1">'sk_3433941e467c1055b178ce26348b0fac'</span><span class="p">);</span>

<span class="nv">$findDataRequest</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'creation[gte]'</span> <span class="o">=&gt;</span> <span class="s1">'2013-01-01'</span><span class="p">,</span>
    <span class="s1">'creation[lte]'</span> <span class="o">=&gt;</span> <span class="s1">'2013-12-31'</span><span class="p">,</span>
    <span class="s1">'offset'</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">'limit'</span> <span class="o">=&gt;</span> <span class="mi">5</span><span class="p">);</span>

<span class="nv">$planList</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">plans</span><span class="o">-&gt;</span><span class="na">getList</span><span class="p">(</span><span class="nv">$findDataRequest</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="kd">final</span> <span class="n">Calendar</span> <span class="n">dateGte</span> <span class="o">=</span> <span class="n">Calendar</span><span class="o">.</span><span class="na">getInstance</span><span class="o">();</span>
<span class="kd">final</span> <span class="n">Calendar</span> <span class="n">dateLte</span> <span class="o">=</span> <span class="n">Calendar</span><span class="o">.</span><span class="na">getInstance</span><span class="o">();</span>
<span class="n">dateGte</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="mi">2014</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">);</span>
<span class="n">dateLte</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="mi">2014</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">15</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">);</span>

<span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OpenpayAPI</span><span class="o">(</span><span class="s">"https://sandbox-api.openpay.mx"</span><span class="o">,</span> <span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="o">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="o">);</span>
<span class="n">SearchParams</span> <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SearchParams</span><span class="o">();</span>
<span class="n">request</span><span class="o">.</span><span class="na">creationGte</span><span class="o">(</span><span class="n">dateGte</span><span class="o">.</span><span class="na">getTime</span><span class="o">());</span>
<span class="n">request</span><span class="o">.</span><span class="na">creationLte</span><span class="o">(</span><span class="n">dateLte</span><span class="o">.</span><span class="na">getTime</span><span class="o">());</span>
<span class="n">request</span><span class="o">.</span><span class="na">offset</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">limit</span><span class="o">(</span><span class="mi">100</span><span class="o">);</span>

<span class="n">List</span><span class="o">&lt;</span><span class="n">Plan</span><span class="o">&gt;</span> <span class="n">plans</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="na">plans</span><span class="o">().</span><span class="na">list</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">OpenpayAPI</span><span class="p">(</span><span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="p">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="p">);</span>
<span class="n">SearchParams</span> <span class="n">request</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SearchParams</span><span class="p">();</span>
<span class="n">request</span><span class="p">.</span><span class="n">CreationGte</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Datetime</span><span class="p">(</span><span class="m">2014</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">1</span><span class="p">);</span>
<span class="n">request</span><span class="p">.</span><span class="n">CreationLte</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">2014</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">15</span><span class="p">);</span>
<span class="n">request</span><span class="p">.</span><span class="n">Offset</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">Limit</span> <span class="p">=</span> <span class="m">100</span><span class="p">;</span>

<span class="n">List</span><span class="p">&lt;</span><span class="n">Plan</span><span class="p">&gt;</span> <span class="n">plans</span> <span class="p">=</span> <span class="n">api</span><span class="p">.</span><span class="n">PlanService</span><span class="p">.</span><span class="nf">List</span><span class="p">(</span><span class="n">request</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="kd">var</span> <span class="nx">searchParams</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">'limit'</span> <span class="err">:</span> <span class="mi">10</span>
<span class="p">};</span>

<span class="nx">openpay</span><span class="p">.</span><span class="nx">plans</span><span class="p">.</span><span class="nx">list</span><span class="p">(</span><span class="nx">searchParams</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">list</span><span class="p">){</span>
  <span class="c1">// ...
</span><span class="p">});</span>
</pre><pre class="highlight ruby"><span class="vi">@openpay</span><span class="o">=</span><span class="no">OpenpayApi</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"mzdtln0bmtms6o3kck8f"</span><span class="p">,</span><span class="s2">"sk_e568c42a6c384b7ab02cd47d2e407cab"</span><span class="p">)</span>
<span class="vi">@plans</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:plans</span><span class="p">)</span>

<span class="n">response_hash</span><span class="o">=</span><span class="vi">@plans</span><span class="p">.</span><span class="nf">all</span>
</pre>
<blockquote>
<p>Response example</p>
</blockquote>
<pre class="highlight json"><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Curso de aleman"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"active"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">150</span><span class="p">,</span><span class="w">
        </span><span class="s2">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MXN"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"patpflacwilazguj6bem"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2013-12-13T09:43:52-06:00"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"repeat_every"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="s2">"repeat_unit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"month"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"retry_times"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
        </span><span class="s2">"status_after_retry"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cancelled"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"trial_days"</span><span class="p">:</span><span class="w"> </span><span class="mi">60</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Curso de ingles"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"active"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">150</span><span class="p">,</span><span class="w">
        </span><span class="s2">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MXN"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pjl7wfryrrd1tznr0fnl"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2013-12-13T11:36:40-06:00"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"repeat_every"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="s2">"repeat_unit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"month"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"retry_times"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
        </span><span class="s2">"status_after_retry"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cancelled"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"trial_days"</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></pre>
<p>Returns the details of all active plans.</p>

<h3 id="request">Request</h3>

<p>You can search using the following parameters:</p>

<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>creation</td>
<td><strong><em>date</em></strong> <br/> Same as creation date.  Format yyyy-mm-dd.</td>
</tr>
<tr>
<td>creation[gte]</td>
<td><strong><em>date</em></strong> <br/>After creation date. Format: yyyy-mm-dd.</td>
</tr>
<tr>
<td>creation[lte]</td>
<td><strong><em>date</em></strong> <br/>Before the creation date. Format: yyyy-mm-dd.</td>
</tr>
<tr>
<td>offset</td>
<td><strong><em>numeric</em></strong> <br/>Number of records to skip from the beggining, by default is 0.</td>
</tr>
<tr>
<td>limit</td>
<td><strong><em>numeric</em></strong> <br/>Number of records to return, by default is 10.</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<p>A list of <a href="#plan-object">plan objects</a> registered according to the given parameters, sort by creation date in descending order.</p>

<h1 id="subscriptions">Subscriptions</h1>

<p>Subscriptions allow to associate customers and cards in order to make recurrent payments.</p>

<p>In order to subscribe a customer first is required to <a href="#create-a-new-plan">create a plan</a>.</p>

<h2 id="subscription-object">Subscription object</h2>

<blockquote>
<p>Object example</p>
</blockquote>
<pre class="highlight json"><span class="p">{</span><span class="w">
    </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"trial"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"card"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"debit"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"brand"</span><span class="p">:</span><span class="w"> </span><span class="s2">"mastercard"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"card_number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1111"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"holder_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Juan Perez Ramirez"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"expiration_year"</span><span class="p">:</span><span class="w"> </span><span class="s2">"20"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"expiration_month"</span><span class="p">:</span><span class="w"> </span><span class="s2">"12"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"allows_charges"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="s2">"allows_payouts"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
        </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2013-12-13T12:39:46-06:00"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"bank_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"DESCONOCIDO"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"customer_id"</span><span class="p">:</span><span class="w"> </span><span class="err">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"bank_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"000"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"svxdm1suclzipbi4pavm"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"cancel_at_period_end"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="s2">"charge_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-01-12"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2013-12-13T12:39:46-06:00"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"current_period_number"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="s2">"period_end_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-01-11"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"trial_end_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-01-11"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"plan_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pjl7wfryrrd1tznr0fnl"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"customer_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"a2b79p8xmzeyvmolqfja"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td><strong><em>string</em></strong> <br/> Unique subscription identifier.</td>
</tr>
<tr>
<td>creation_date</td>
<td><strong><em>datetime</em></strong> <br/> Date and time in which the subscription was created using ISO 8601 format.</td>
</tr>
<tr>
<td>cancel_at_period_end</td>
<td><strong><em>string</em></strong> <br/> Indicates if the subscription has been canceled at the end of the period.</td>
</tr>
<tr>
<td>charge_date</td>
<td><strong><em>numeric</em></strong> <br/> Date in which the subscription will be charged.</td>
</tr>
<tr>
<td>current_period_number</td>
<td><strong><em>string</em></strong> <br/> Indicates the current period to be charged.</td>
</tr>
<tr>
<td>period_end_date</td>
<td><strong><em>numeric</em></strong> <br/> Date in which the current period ends, it&rsquo;s one day before the next charge.</td>
</tr>
<tr>
<td>trial_end_date</td>
<td><strong><em>string</em></strong> <br/> Date in which the trial period ends.  One day after this date the first charge is applied.</td>
</tr>
<tr>
<td>plan_id</td>
<td><strong><em>numeric</em></strong> <br/>  Plan identifier in which this subscription will be created.</td>
</tr>
<tr>
<td>status</td>
<td><strong><em>string</em></strong> <br/> Subscription status, it can be <em>active</em>, <em>trial</em>, <em>past_due</em>, <em>unpaid</em> or <em>cancelled</em>.  If the subscription has a trial period, the trial period is applied, if it doesn&rsquo;t have or when the trial period ends and the first payment is executed it changes to <em>active</em>.  When the charge was unable to be completed it changes to <em>past_due</em>.  When all the charge tries has been completed according to the plan configuration it can change to <em>unpaid</em> or <em>cancelled</em>.  When it&rsquo;s marked as <em>unpaid</em> and the subscription wants to be reactivated it&rsquo;s required to update the subscription payment method(card).  In any other case, the status is set to <em>cancelled</em>.</td>
</tr>
<tr>
<td>customer_id</td>
<td><strong><em>string</em></strong> <br/> Customer identifier for the subscription owner.</td>
</tr>
<tr>
<td>card</td>
<td><strong><em>object</em></strong> <br/> Payment method for the subscription.  See <a href="#card-object">card object</a>.</td>
</tr>
</tbody></table>

<h2 id="create-a-new-subscription">Create a new Subscription</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell">POST https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/customers/<span class="o">{</span>CUSTOMER_ID<span class="o">}</span>/subscriptions
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">customerId</span><span class="p">);</span>
<span class="nv">$subscription</span> <span class="o">=</span> <span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">subscriptions</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="nx">subscriptionDataRequest</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">openpayAPI</span><span class="o">.</span><span class="na">subscriptions</span><span class="o">().</span><span class="na">create</span><span class="o">(</span><span class="n">String</span> <span class="n">customerId</span><span class="o">,</span> <span class="n">Subscription</span> <span class="n">request</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">openpayAPI</span><span class="p">.</span><span class="n">SubscriptionService</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="kt">string</span> <span class="n">customer_id</span><span class="p">,</span> <span class="n">Subscription</span> <span class="n">request</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">subscriptions</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">customerId</span><span class="p">,</span> <span class="nx">subscriptionRequest</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
</pre><pre class="highlight ruby"><span class="c1">#Customer</span>
<span class="vi">@subscriptions</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:subscriptions</span><span class="p">)</span>
<span class="vi">@subscriptions</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="n">request_hash</span><span class="p">,</span> <span class="n">customer_id</span><span class="p">)</span>
</pre>
<blockquote>
<p>Request example</p>
</blockquote>
<pre class="highlight shell">curl https://sandbox-api.openpay.mx/v1/mzdtln0bmtms6o3kck8f/customers/ag4nktpdzebjiye1tlze/subscriptions <span class="se">\</span>
   -u sk_e568c42a6c384b7ab02cd47d2e407cab: <span class="se">\</span>
   -H <span class="s2">"Content-type: application/json"</span> <span class="se">\</span>
   -X POST -d <span class="s1">'{
   "card":{
      "card_number":"4111111111111111",
      "holder_name":"Juan Perez Ramirez",
      "expiration_year":"20",
      "expiration_month":"12",
      "cvv2":"110"
   },
   "plan_id":"pbi4kb8hpb64x0uud2eb"
}'</span> 
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$openpay</span> <span class="o">=</span> <span class="nx">Openpay</span><span class="o">::</span><span class="na">getInstance</span><span class="p">(</span><span class="s1">'moiep6umtcnanql3jrxp'</span><span class="p">,</span> <span class="s1">'sk_3433941e467c1055b178ce26348b0fac'</span><span class="p">);</span>

<span class="nv">$subscriptionDataRequest</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s2">"trial_end_date"</span> <span class="o">=&gt;</span> <span class="s2">"2014-01-01"</span><span class="p">,</span> 
    <span class="s1">'plan_id'</span> <span class="o">=&gt;</span> <span class="s1">'pduar9iitv4enjftuwyl'</span><span class="p">,</span>
    <span class="s1">'card_id'</span> <span class="o">=&gt;</span> <span class="s1">'konvkvcd5ih8ta65umie'</span><span class="p">);</span>

<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'a9ualumwnrcxkl42l6mh'</span><span class="p">);</span>
<span class="nv">$subscription</span> <span class="o">=</span> <span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">subscriptions</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="nv">$subscriptionDataRequest</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="kd">final</span> <span class="n">Calendar</span> <span class="n">trialEndDate</span> <span class="o">=</span> <span class="n">Calendar</span><span class="o">.</span><span class="na">getInstance</span><span class="o">();</span>
<span class="n">trialEndDate</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="mi">2014</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">);</span>

<span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OpenpayAPI</span><span class="o">(</span><span class="s">"https://sandbox-api.openpay.mx"</span><span class="o">,</span> <span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="o">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="o">);</span>
<span class="n">Subscription</span> <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Subscription</span><span class="o">();</span>
<span class="n">request</span><span class="o">.</span><span class="na">planId</span><span class="o">(</span><span class="s">"idPlan-01001"</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">trialEndDate</span><span class="o">(</span><span class="n">trialEndDate</span><span class="o">.</span><span class="na">getTime</span><span class="o">());</span>
<span class="n">request</span><span class="o">.</span><span class="na">sourceId</span><span class="o">(</span><span class="s">"ktrpvymgatocelsciak7"</span><span class="o">);</span>

<span class="n">request</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="na">subscriptions</span><span class="o">().</span><span class="na">create</span><span class="o">(</span><span class="s">"a9pvykxz4g5rg0fplze0"</span><span class="o">,</span> <span class="n">request</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">OpenpayAPI</span><span class="p">(</span><span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="p">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="p">);</span>
<span class="n">Subscription</span> <span class="n">request</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Subscription</span><span class="p">();</span>
<span class="n">request</span><span class="p">.</span><span class="n">PlanId</span> <span class="p">=</span> <span class="s">"idPlan-01001"</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">TrialEndDate</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Datetime</span><span class="p">(</span><span class="m">2014</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">1</span><span class="p">);;</span>
<span class="n">request</span><span class="p">.</span><span class="n">CardId</span> <span class="p">=</span> <span class="s">"ktrpvymgatocelsciak7"</span><span class="p">;</span>

<span class="n">request</span> <span class="p">=</span> <span class="n">api</span><span class="p">.</span><span class="n">SubscriptionService</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="s">"a9pvykxz4g5rg0fplze0"</span><span class="p">,</span> <span class="n">request</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="kd">var</span> <span class="nx">subscriptionRequest</span> <span class="o">=</span> <span class="p">{</span>
   <span class="s1">'card'</span><span class="err">:</span><span class="p">{</span>
      <span class="s1">'card_number'</span><span class="err">:</span><span class="s1">'4111111111111111'</span><span class="p">,</span>
      <span class="s1">'holder_name'</span><span class="err">:</span><span class="s1">'Juan Perez Ramirez'</span><span class="p">,</span>
      <span class="s1">'expiration_year'</span><span class="err">:</span><span class="s1">'20'</span><span class="p">,</span>
      <span class="s1">'expiration_month'</span><span class="err">:</span><span class="s1">'12'</span><span class="p">,</span>
      <span class="s1">'cvv2'</span><span class="err">:</span><span class="s1">'110'</span>
   <span class="p">},</span>
   <span class="s1">'plan_id'</span><span class="err">:</span><span class="s1">'pbi4kb8hpb64x0uud2eb'</span>
<span class="p">};</span>

<span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">subscriptions</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">customerId</span><span class="p">,</span> <span class="nx">subscriptionRequest</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">subscription</span><span class="p">){</span>
  <span class="c1">// ...
</span><span class="p">});</span>
</pre><pre class="highlight ruby"><span class="vi">@openpay</span><span class="o">=</span><span class="no">OpenpayApi</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"mzdtln0bmtms6o3kck8f"</span><span class="p">,</span><span class="s2">"sk_e568c42a6c384b7ab02cd47d2e407cab"</span><span class="p">)</span>
<span class="vi">@subscriptions</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:subscriptions</span><span class="p">)</span>
<span class="n">request_hash</span><span class="o">=</span><span class="p">{</span>
     <span class="s2">"plan_id"</span> <span class="o">=&gt;</span> <span class="s2">"pbi4kb8hpb64x0uud2eb"</span><span class="p">,</span>
     <span class="s2">"trial_end_date"</span> <span class="o">=&gt;</span> <span class="s2">"2014-06-20"</span><span class="p">,</span>
     <span class="s2">"source_id"</span> <span class="o">=&gt;</span> <span class="s2">"ktrpvymgatocelsciak7"</span>
   <span class="p">}</span>

<span class="n">response_hash</span><span class="o">=</span><span class="vi">@subscriptions</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="n">request_hash</span><span class="p">.</span><span class="nf">to_hash</span><span class="p">,</span> <span class="s2">"a9pvykxz4g5rg0fplze0"</span><span class="p">)</span>
</pre>
<blockquote>
<p>Response example</p>
</blockquote>
<pre class="highlight json"><span class="p">{</span><span class="w">
   </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"s0gmyor4yqtyv1miqwr0"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"status"</span><span class="p">:</span><span class="s2">"trial"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"card"</span><span class="p">:{</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"debit"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"brand"</span><span class="p">:</span><span class="s2">"visa"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"address"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"card_number"</span><span class="p">:</span><span class="s2">"411111XXXXXX1111"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"holder_name"</span><span class="p">:</span><span class="s2">"Juan Perez Ramirez"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"expiration_year"</span><span class="p">:</span><span class="s2">"20"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"expiration_month"</span><span class="p">:</span><span class="s2">"12"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"allows_charges"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="s2">"allows_payouts"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="s2">"bank_name"</span><span class="p">:</span><span class="s2">"Banamex"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"bank_code"</span><span class="p">:</span><span class="s2">"002"</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="s2">"cancel_at_period_end"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
   </span><span class="s2">"charge_date"</span><span class="p">:</span><span class="s2">"2014-06-21"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="s2">"2014-05-22T15:56:18-05:00"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"current_period_number"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
   </span><span class="s2">"period_end_date"</span><span class="p">:</span><span class="s2">"2014-06-20"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"trial_end_date"</span><span class="p">:</span><span class="s2">"2014-06-20"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"plan_id"</span><span class="p">:</span><span class="s2">"pbi4kb8hpb64x0uud2eb"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"customer_id"</span><span class="p">:</span><span class="s2">"ag4nktpdzebjiye1tlze"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<p>Create a new subscription for an existing customer.  You can use an existing card or you can send the info of the card where the charges will be made.</p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>plan_id</td>
<td><strong><em>string</em></strong> (required, length = 45) <br/> Plan identifier in which the subscription will be created.</td>
</tr>
<tr>
<td>trial_end_date</td>
<td><strong><em>string</em></strong> (optional, length = 10) <br/> Indicates the customer trial end date. If it&rsquo;s not indicated the plan will be used to calculate it.  If the date is in the past it will be interpreted as a subscription with no trial.  Format: yyyy-mm-dd.</td>
</tr>
<tr>
<td>source_id</td>
<td><strong><em>string</em></strong> (required if the card is not sent, length = 45) <br/> Card token identifier, or the customer registered card which will be used to charge the subscription.</td>
</tr>
<tr>
<td>card</td>
<td><strong><em>object</em></strong> (required if the source_id is not present) <br/> Payment method which will be used to charge the subscription. See <a href="#card-object">card object</a>.</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<p>Returns the created <a href="#subscription-object">subscription object</a> or an <a href="#error-object">error response</a> if an error occurred during the creation.</p>

<h2 id="updating-a-subscription">Updating a Subscription</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell">PUT https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/customers/<span class="o">{</span>CUSTOMER_ID<span class="o">}</span>/subscriptions
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">customerId</span><span class="p">);</span>
<span class="nv">$subscription</span> <span class="o">=</span> <span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">subscriptions</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">subscriptionId</span><span class="p">);</span>
<span class="nv">$subscription</span><span class="o">-&gt;</span><span class="na">save</span><span class="p">();</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">openpayAPI</span><span class="o">.</span><span class="na">subscriptions</span><span class="o">().</span><span class="na">update</span><span class="o">(</span><span class="n">Subscription</span> <span class="n">request</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">openpayAPI</span><span class="p">.</span><span class="n">SubscriptionService</span><span class="p">.</span><span class="nf">Update</span><span class="p">(</span><span class="kt">string</span> <span class="n">customer_id</span><span class="p">,</span> <span class="n">Subscription</span> <span class="n">subscription</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">subscriptions</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">customerId</span><span class="p">,</span> <span class="nx">subscriptionId</span><span class="p">,</span> <span class="nx">subscriptionRequest</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
</pre><pre class="highlight ruby"><span class="c1">#Customer</span>
<span class="vi">@subscriptions</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:subscriptions</span><span class="p">)</span>
<span class="vi">@subscriptions</span><span class="p">.</span><span class="nf">update</span><span class="p">(</span><span class="n">request_hash</span><span class="p">,</span> <span class="n">customer_id</span><span class="p">)</span>
</pre>
<blockquote>
<p>Request example</p>
</blockquote>
<pre class="highlight shell">curl https://sandbox-api.openpay.mx/v1/mzdtln0bmtms6o3kck8f/customers/ag4nktpdzebjiye1tlze/subscriptions/s0gmyor4yqtyv1miqwr0 <span class="se">\</span>
   -u sk_e568c42a6c384b7ab02cd47d2e407cab: <span class="se">\</span>
   -H <span class="s2">"Content-type: application/json"</span> <span class="se">\</span>
   -X PUT -d <span class="s1">'{
  "trial_end_date": "2016-01-11",
   "card": {
        "card_number": "343434343434343",
        "holder_name": "Juan Perez Ramirez",
        "expiration_year": "20",
        "expiration_month": "12",
        "cvv2":"1234"
    }
}'</span> 
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$openpay</span> <span class="o">=</span> <span class="nx">Openpay</span><span class="o">::</span><span class="na">getInstance</span><span class="p">(</span><span class="s1">'moiep6umtcnanql3jrxp'</span><span class="p">,</span> <span class="s1">'sk_3433941e467c1055b178ce26348b0fac'</span><span class="p">);</span>

<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'a9ualumwnrcxkl42l6mh'</span><span class="p">);</span>
<span class="nv">$subscription</span> <span class="o">=</span> <span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">subscriptions</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'s7ri24srbldoqqlfo4vp'</span><span class="p">);</span>
<span class="nv">$subscription</span><span class="o">-&gt;</span><span class="na">trial_end_date</span> <span class="o">=</span> <span class="s1">'2014-12-31'</span><span class="p">;</span>
<span class="nv">$subscription</span><span class="o">-&gt;</span><span class="na">save</span><span class="p">();</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="kd">final</span> <span class="n">Calendar</span> <span class="n">trialEndDate</span> <span class="o">=</span> <span class="n">Calendar</span><span class="o">.</span><span class="na">getInstance</span><span class="o">();</span>
<span class="n">trialEndDate</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="mi">2014</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">);</span>

<span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OpenpayAPI</span><span class="o">(</span><span class="s">"https://sandbox-api.openpay.mx"</span><span class="o">,</span> <span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="o">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="o">);</span>
<span class="n">Subscription</span> <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Subscription</span><span class="o">();</span>
<span class="n">request</span><span class="o">.</span><span class="na">planId</span><span class="o">(</span><span class="s">"idPlan-01001"</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">trialEndDate</span><span class="o">(</span><span class="n">trialEndDate</span><span class="o">.</span><span class="na">getTime</span><span class="o">());</span>
<span class="n">request</span><span class="o">.</span><span class="na">sourceId</span><span class="o">(</span><span class="s">"ktrpvymgatocelsciak7"</span><span class="o">);</span>

<span class="n">request</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="na">subscriptions</span><span class="o">().</span><span class="na">update</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">OpenpayAPI</span><span class="p">(</span><span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="p">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="p">);</span>
<span class="n">Subscription</span> <span class="n">request</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Subscription</span><span class="p">();</span>
<span class="n">request</span><span class="p">.</span><span class="n">PlanId</span> <span class="p">=</span> <span class="s">"idPlan-01001"</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">TrialEndDate</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Datetime</span><span class="p">(</span><span class="m">2014</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">1</span><span class="p">);;</span>
<span class="n">request</span><span class="p">.</span><span class="n">CardId</span> <span class="p">=</span> <span class="s">"ktrpvymgatocelsciak7"</span><span class="p">;</span>

<span class="n">request</span> <span class="p">=</span> <span class="n">api</span><span class="p">.</span><span class="n">SubscriptionService</span><span class="p">.</span><span class="nf">Update</span><span class="p">(</span><span class="s">"a9pvykxz4g5rg0fplze0"</span><span class="p">,</span> <span class="n">request</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="kd">var</span> <span class="nx">subscriptionRequest</span> <span class="o">=</span> <span class="p">{</span>
<span class="s1">'trial_end_date'</span><span class="err">:</span> <span class="s1">'2016-01-11'</span><span class="p">,</span>
  <span class="s1">'card'</span><span class="err">:</span> <span class="p">{</span>
    <span class="s1">'card_number'</span><span class="err">:</span> <span class="s1">'343434343434343'</span><span class="p">,</span>
    <span class="s1">'holder_name'</span><span class="err">:</span> <span class="s1">'Juan Perez Ramirez'</span><span class="p">,</span>
    <span class="s1">'expiration_year'</span><span class="err">:</span> <span class="s1">'20'</span><span class="p">,</span>
    <span class="s1">'expiration_month'</span><span class="err">:</span> <span class="s1">'12'</span><span class="p">,</span>
    <span class="s1">'cvv2'</span><span class="err">:</span><span class="s1">'1234'</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">subscriptions</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="s1">'ag4nktpdzebjiye1tlze'</span><span class="p">,</span> <span class="s1">'s0gmyor4yqtyv1miqwr0'</span><span class="p">,</span> <span class="nx">subscriptionRequest</span><span class="p">,</span> 
    <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">subscription</span><span class="p">){</span>
  <span class="c1">// ...
</span><span class="p">});</span>
</pre><pre class="highlight ruby"><span class="vi">@openpay</span><span class="o">=</span><span class="no">OpenpayApi</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"mzdtln0bmtms6o3kck8f"</span><span class="p">,</span><span class="s2">"sk_e568c42a6c384b7ab02cd47d2e407cab"</span><span class="p">)</span>
<span class="vi">@subscriptions</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:subscriptions</span><span class="p">)</span>
<span class="n">request_hash</span><span class="o">=</span><span class="p">{</span>
     <span class="s2">"plan_id"</span> <span class="o">=&gt;</span> <span class="s2">"pbi4kb8hpb64x0uud2eb"</span><span class="p">,</span>
     <span class="s2">"cancel_at_period_end"</span> <span class="o">=&gt;</span> <span class="kp">true</span><span class="p">,</span>
     <span class="s2">"trial_end_date"</span> <span class="o">=&gt;</span> <span class="s2">"2014-06-20"</span><span class="p">,</span>
     <span class="s2">"source_id"</span> <span class="o">=&gt;</span> <span class="s2">"ktrpvymgatocelsciak7"</span>
   <span class="p">}</span>

<span class="n">response_hash</span><span class="o">=</span><span class="vi">@subscriptions</span><span class="p">.</span><span class="nf">update</span><span class="p">(</span><span class="n">request_hash</span><span class="p">.</span><span class="nf">to_hash</span><span class="p">,</span> <span class="s2">"pbi4kb8hpb64x0uud2eb"</span><span class="p">)</span>
</pre>
<blockquote>
<p>Response example</p>
</blockquote>
<pre class="highlight json"><span class="p">{</span><span class="w">
   </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"s0gmyor4yqtyv1miqwr0"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"status"</span><span class="p">:</span><span class="s2">"trial"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"card"</span><span class="p">:{</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"credit"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"brand"</span><span class="p">:</span><span class="s2">"american_express"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"address"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"card_number"</span><span class="p">:</span><span class="s2">"343434XXXXX4343"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"holder_name"</span><span class="p">:</span><span class="s2">"Juan Perez Ramirez"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"expiration_year"</span><span class="p">:</span><span class="s2">"20"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"expiration_month"</span><span class="p">:</span><span class="s2">"12"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"allows_charges"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="s2">"allows_payouts"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="s2">"bank_name"</span><span class="p">:</span><span class="s2">"AMERICAN EXPRESS"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"bank_code"</span><span class="p">:</span><span class="s2">"103"</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="s2">"cancel_at_period_end"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
   </span><span class="s2">"charge_date"</span><span class="p">:</span><span class="s2">"2016-01-12"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="s2">"2014-05-22T15:56:18-05:00"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"current_period_number"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
   </span><span class="s2">"period_end_date"</span><span class="p">:</span><span class="s2">"2016-01-11"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"trial_end_date"</span><span class="p">:</span><span class="s2">"2016-01-11"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"plan_id"</span><span class="p">:</span><span class="s2">"pbi4kb8hpb64x0uud2eb"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"customer_id"</span><span class="p">:</span><span class="s2">"ag4nktpdzebjiye1tlze"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<p>Updates the information o an active subscription.
Actualiza la informaciÃƒÂ³n de una suscripciÃƒÂ³n activa.</p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>cancel_at_period_end</td>
<td><strong><em>booelan</em></strong> (optional) <br/> Indicates if the subscriptions has to be cancelled at the end of the period.</td>
</tr>
<tr>
<td>trial_end_date</td>
<td><strong><em>string</em></strong> (optional, length = 10) <br/> Trial end date.  If the value is not indicated, the <em>trial_days</em> value from the plan will be used to calculate it.  If a date from the past is sent it will be interpreted as a subscription without trial days.  Format: yyyy-mm-dd.</td>
</tr>
<tr>
<td>source_id</td>
<td><strong><em>string</em></strong> (optional, length = 45) <br/> Card token identifier, or the customer registered card which will be used to charge the subscription.</td>
</tr>
<tr>
<td>card</td>
<td><strong><em>object</em></strong> (optional) <br/> Payment method that will be used to charge the subscription.  See <a href="#card-object">card object</a>.</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<p>Returns the updated <a href="#subscription-object">subscription object</a> or an error response if an error occurred during the update.</p>

<h2 id="get-a-subscription">Get a Subscription</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell">GET https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/customers/<span class="o">{</span>CUSTOMER_ID<span class="o">}</span>/subscriptions/<span class="o">{</span>SUBSCRIPTION_ID<span class="o">}</span>
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">customerId</span><span class="p">);</span>
<span class="nv">$subscription</span> <span class="o">=</span> <span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">subscriptions</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">subscriptionId</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">openpayAPI</span><span class="o">.</span><span class="na">subscriptions</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="n">String</span> <span class="n">customerId</span><span class="o">,</span> <span class="n">String</span> <span class="n">customerId</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">openpayAPI</span><span class="p">.</span><span class="n">SubscriptionService</span><span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="kt">string</span> <span class="n">customer_id</span><span class="p">,</span> <span class="kt">string</span> <span class="n">subscription_id</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">subscriptions</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">customerId</span><span class="p">,</span> <span class="nx">subscriptionId</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
</pre><pre class="highlight ruby"><span class="c1">#Customer</span>
<span class="vi">@subscriptions</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:subscriptions</span><span class="p">)</span>
<span class="vi">@subscriptions</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">subscription_id</span><span class="p">,</span><span class="n">customer_id</span><span class="p">)</span>
</pre>
<blockquote>
<p>Request example</p>
</blockquote>
<pre class="highlight shell">curl https://sandbox-api.openpay.mx/v1/mzdtln0bmtms6o3kck8f/customers/ag4nktpdzebjiye1tlze/subscriptions/s0gmyor4yqtyv1miqwr0 <span class="se">\</span>
   -u sk_e568c42a6c384b7ab02cd47d2e407cab:
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$openpay</span> <span class="o">=</span> <span class="nx">Openpay</span><span class="o">::</span><span class="na">getInstance</span><span class="p">(</span><span class="s1">'moiep6umtcnanql3jrxp'</span><span class="p">,</span> <span class="s1">'sk_3433941e467c1055b178ce26348b0fac'</span><span class="p">);</span>

<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'a9ualumwnrcxkl42l6mh'</span><span class="p">);</span>
<span class="nv">$subscription</span> <span class="o">=</span> <span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">subscriptions</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'s7ri24srbldoqqlfo4vp'</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OpenpayAPI</span><span class="o">(</span><span class="s">"https://sandbox-api.openpay.mx"</span><span class="o">,</span> <span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="o">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="o">);</span>
<span class="n">Subscription</span> <span class="n">subscription</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="na">subscriptions</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="s">"a9pvykxz4g5rg0fplze0"</span><span class="o">,</span> <span class="s">"s0gmyor4yqtyv1miqwr0"</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">OpenpayAPI</span><span class="p">(</span><span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="p">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="p">);</span>
<span class="n">Subscription</span> <span class="n">subscription</span> <span class="p">=</span> <span class="n">api</span><span class="p">.</span><span class="n">SubscriptionService</span><span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="s">"a9pvykxz4g5rg0fplze0"</span><span class="p">,</span> <span class="s">"s0gmyor4yqtyv1miqwr0"</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">subscriptions</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'ag4nktpdzebjiye1tlze'</span><span class="p">,</span> <span class="s1">'s0gmyor4yqtyv1miqwr0'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">subscription</span><span class="p">){</span>
  <span class="c1">// ...
</span><span class="p">});</span>
</pre><pre class="highlight ruby"><span class="vi">@openpay</span><span class="o">=</span><span class="no">OpenpayApi</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"mzdtln0bmtms6o3kck8f"</span><span class="p">,</span><span class="s2">"sk_e568c42a6c384b7ab02cd47d2e407cab"</span><span class="p">)</span>
<span class="vi">@subscriptions</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:subscriptions</span><span class="p">)</span>

<span class="n">response_hash</span><span class="o">=</span><span class="vi">@subscriptions</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="s2">"s0gmyor4yqtyv1miqwr0"</span><span class="p">,</span> <span class="s2">"pbi4kb8hpb64x0uud2eb"</span><span class="p">)</span>
</pre>
<blockquote>
<p>Response example</p>
</blockquote>
<pre class="highlight json"><span class="p">{</span><span class="w">
   </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"s0gmyor4yqtyv1miqwr0"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"status"</span><span class="p">:</span><span class="s2">"trial"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"card"</span><span class="p">:{</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"credit"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"brand"</span><span class="p">:</span><span class="s2">"american_express"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"address"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"card_number"</span><span class="p">:</span><span class="s2">"343434XXXXX4343"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"holder_name"</span><span class="p">:</span><span class="s2">"Juan Perez Ramirez"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"expiration_year"</span><span class="p">:</span><span class="s2">"20"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"expiration_month"</span><span class="p">:</span><span class="s2">"12"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"allows_charges"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="s2">"allows_payouts"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="s2">"bank_name"</span><span class="p">:</span><span class="s2">"AMERICAN EXPRESS"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"bank_code"</span><span class="p">:</span><span class="s2">"103"</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="s2">"cancel_at_period_end"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
   </span><span class="s2">"charge_date"</span><span class="p">:</span><span class="s2">"2016-01-12"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="s2">"2014-05-22T15:56:18-05:00"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"current_period_number"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
   </span><span class="s2">"period_end_date"</span><span class="p">:</span><span class="s2">"2016-01-11"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"trial_end_date"</span><span class="p">:</span><span class="s2">"2016-01-11"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"plan_id"</span><span class="p">:</span><span class="s2">"pbi4kb8hpb64x0uud2eb"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"customer_id"</span><span class="p">:</span><span class="s2">"ag4nktpdzebjiye1tlze"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<p>Gets the details of a customer subscription.</p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td><strong><em>string</em></strong> (required, length = 45) <br/> Subscription identifier.</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<p>Returns a <a href="#subscription-object">subscription object</a>.</p>

<h2 id="cancel-a-subscription">Cancel a Subscription</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell">DELETE https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/customers/<span class="o">{</span>CUSTOMER_ID<span class="o">}</span>/subscriptions/<span class="o">{</span>SUBSCRIPTION_ID<span class="o">}</span>
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">customerId</span><span class="p">);</span>
<span class="nv">$subscription</span> <span class="o">=</span> <span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">subscriptions</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">subscriptionId</span><span class="p">);</span>
<span class="nv">$subscription</span><span class="o">-&gt;</span><span class="na">delete</span><span class="p">();</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">openpayAPI</span><span class="o">.</span><span class="na">subscriptions</span><span class="o">().</span><span class="na">delete</span><span class="o">(</span><span class="n">String</span> <span class="n">customerId</span><span class="o">,</span> <span class="n">String</span> <span class="n">subscriptionId</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">openpayAPI</span><span class="p">.</span><span class="n">SubscriptionService</span><span class="p">.</span><span class="nf">Delete</span><span class="p">(</span><span class="kt">string</span> <span class="n">customer_id</span><span class="p">,</span> <span class="kt">string</span> <span class="n">subscription_id</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">subscriptions</span><span class="p">.</span><span class="k">delete</span><span class="p">(</span><span class="nx">customerId</span><span class="p">,</span> <span class="nx">subscriptionId</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
</pre><pre class="highlight ruby"><span class="c1">#Customer</span>
<span class="vi">@subscriptions</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:subscriptions</span><span class="p">)</span>
<span class="vi">@subscriptions</span><span class="p">.</span><span class="nf">delete</span><span class="p">(</span><span class="n">subscription_id</span><span class="p">,</span> <span class="n">customer_id</span><span class="p">)</span>
</pre>
<blockquote>
<p>Request example</p>
</blockquote>
<pre class="highlight shell">curl https://sandbox-api.openpay.mx/v1/mzdtln0bmtms6o3kck8f/customers/ag4nktpdzebjiye1tlze/subscriptions/s0gmyor4yqtyv1miqwr0 <span class="se">\</span>
   -u sk_e568c42a6c384b7ab02cd47d2e407cab: <span class="se">\</span>
   -X DELETE
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$openpay</span> <span class="o">=</span> <span class="nx">Openpay</span><span class="o">::</span><span class="na">getInstance</span><span class="p">(</span><span class="s1">'moiep6umtcnanql3jrxp'</span><span class="p">,</span> <span class="s1">'sk_3433941e467c1055b178ce26348b0fac'</span><span class="p">);</span>

<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'a9ualumwnrcxkl42l6mh'</span><span class="p">);</span>
<span class="nv">$subscription</span> <span class="o">=</span> <span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">subscriptions</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'s7ri24srbldoqqlfo4vp'</span><span class="p">);</span>
<span class="nv">$subscription</span><span class="o">-&gt;</span><span class="na">delete</span><span class="p">();</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OpenpayAPI</span><span class="o">(</span><span class="s">"https://sandbox-api.openpay.mx"</span><span class="o">,</span> <span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="o">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="o">);</span>
<span class="n">api</span><span class="o">.</span><span class="na">subscriptions</span><span class="o">().</span><span class="na">delete</span><span class="o">(</span><span class="s">"a9pvykxz4g5rg0fplze0"</span><span class="o">,</span> <span class="s">"s0gmyor4yqtyv1miqwr0"</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">OpenpayAPI</span><span class="p">(</span><span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="p">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="p">);</span>
<span class="n">api</span><span class="p">.</span><span class="n">SubscriptionService</span><span class="p">.</span><span class="nf">Delete</span><span class="p">(</span><span class="s">"a9pvykxz4g5rg0fplze0"</span><span class="p">,</span> <span class="s">"s0gmyor4yqtyv1miqwr0"</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">subscriptions</span><span class="p">.</span><span class="k">delete</span><span class="p">(</span><span class="s1">'ag4nktpdzebjiye1tlze'</span><span class="p">,</span> <span class="s1">'s0gmyor4yqtyv1miqwr0'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">){</span>
  <span class="c1">// ...
</span><span class="p">});</span>
</pre><pre class="highlight ruby"><span class="vi">@openpay</span><span class="o">=</span><span class="no">OpenpayApi</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"mzdtln0bmtms6o3kck8f"</span><span class="p">,</span><span class="s2">"sk_e568c42a6c384b7ab02cd47d2e407cab"</span><span class="p">)</span>
<span class="vi">@subscriptions</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:subscriptions</span><span class="p">)</span>

<span class="vi">@subscriptions</span><span class="p">.</span><span class="nf">detele</span><span class="p">(</span><span class="s2">"s0gmyor4yqtyv1miqwr0"</span><span class="p">,</span> <span class="s2">"pbi4kb8hpb64x0uud2eb"</span><span class="p">)</span>
</pre>
<p>Immediately cancels a customer subscription.  No more charges will be made to the card and all pending charges will be cancelled.</p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td><strong><em>string</em></strong> (required, length = 45) <br/> Subscription identifier to cancel.</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<p>If the response was successfully cancelled the response will be empty.  Otherwise an <a href="#error-object">error object</a> will be sent indicating the error reason.</p>

<h2 id="subscription-list">Subscription list</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell">GET https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/customers/<span class="o">{</span>CUSTOMER_ID<span class="o">}</span>/subscriptions
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">customerId</span><span class="p">);</span>
<span class="nv">$subscriptionList</span> <span class="o">=</span> <span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">subscriptions</span><span class="o">-&gt;</span><span class="na">getList</span><span class="p">(</span><span class="nx">findDataRequest</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">openpayAPI</span><span class="o">.</span><span class="na">subscriptions</span><span class="o">().</span><span class="na">list</span><span class="o">(</span><span class="n">String</span> <span class="n">customerId</span><span class="o">,</span> <span class="n">SearchParams</span> <span class="n">request</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">openpayAPI</span><span class="p">.</span><span class="n">SubscriptionService</span><span class="p">.</span><span class="nf">List</span><span class="p">(</span><span class="kt">string</span> <span class="n">customer_id</span><span class="p">,</span> <span class="n">SearchParams</span> <span class="n">request</span> <span class="p">=</span> <span class="k">null</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">subscriptions</span><span class="p">.</span><span class="nx">list</span><span class="p">(</span><span class="nx">customerId</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
<span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">subscriptions</span><span class="p">.</span><span class="nx">list</span><span class="p">(</span><span class="nx">customerId</span><span class="p">,</span> <span class="nx">searchParams</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
</pre><pre class="highlight ruby"><span class="c1">#Customer</span>
<span class="vi">@subscriptions</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:subscriptions</span><span class="p">)</span>
<span class="vi">@subscriptions</span><span class="p">.</span><span class="nf">all</span><span class="p">(</span><span class="n">customer_id</span><span class="p">)</span>
</pre>
<blockquote>
<p>Request example</p>
</blockquote>
<pre class="highlight shell">curl -g <span class="s2">"https://sandbox-api.openpay.mx/v1/mzdtln0bmtms6o3kck8f/customers/ag4nktpdzebjiye1tlze/subscriptions?limit=10"</span> <span class="se">\</span>
   -u sk_e568c42a6c384b7ab02cd47d2e407cab: 
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$openpay</span> <span class="o">=</span> <span class="nx">Openpay</span><span class="o">::</span><span class="na">getInstance</span><span class="p">(</span><span class="s1">'moiep6umtcnanql3jrxp'</span><span class="p">,</span> <span class="s1">'sk_3433941e467c1055b178ce26348b0fac'</span><span class="p">);</span>

<span class="nv">$findData</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'creation[gte]'</span> <span class="o">=&gt;</span> <span class="s1">'2013-01-01'</span><span class="p">,</span>
    <span class="s1">'creation[lte]'</span> <span class="o">=&gt;</span> <span class="s1">'2013-12-31'</span><span class="p">,</span>
    <span class="s1">'offset'</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">'limit'</span> <span class="o">=&gt;</span> <span class="mi">5</span><span class="p">);</span>

<span class="nv">$customer</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">customers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'a9ualumwnrcxkl42l6mh'</span><span class="p">);</span>
<span class="nv">$subscriptionList</span> <span class="o">=</span> <span class="nv">$customer</span><span class="o">-&gt;</span><span class="na">subscriptions</span><span class="o">-&gt;</span><span class="na">getList</span><span class="p">(</span><span class="nv">$findData</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="kd">final</span> <span class="n">Calendar</span> <span class="n">dateGte</span> <span class="o">=</span> <span class="n">Calendar</span><span class="o">.</span><span class="na">getInstance</span><span class="o">();</span>
<span class="kd">final</span> <span class="n">Calendar</span> <span class="n">dateLte</span> <span class="o">=</span> <span class="n">Calendar</span><span class="o">.</span><span class="na">getInstance</span><span class="o">();</span>
<span class="n">dateGte</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="mi">2014</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">);</span>
<span class="n">dateLte</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="mi">2014</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">15</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">);</span>

<span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OpenpayAPI</span><span class="o">(</span><span class="s">"https://sandbox-api.openpay.mx"</span><span class="o">,</span> <span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="o">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="o">);</span>
<span class="n">SearchParams</span> <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SearchParams</span><span class="o">();</span>
<span class="n">request</span><span class="o">.</span><span class="na">creationGte</span><span class="o">(</span><span class="n">dateGte</span><span class="o">.</span><span class="na">getTime</span><span class="o">());</span>
<span class="n">request</span><span class="o">.</span><span class="na">creationLte</span><span class="o">(</span><span class="n">dateLte</span><span class="o">.</span><span class="na">getTime</span><span class="o">());</span>
<span class="n">request</span><span class="o">.</span><span class="na">offset</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">limit</span><span class="o">(</span><span class="mi">100</span><span class="o">);</span>

<span class="n">List</span><span class="o">&lt;</span><span class="n">Subscription</span><span class="o">&gt;</span> <span class="n">subscriptions</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="na">subscriptions</span><span class="o">().</span><span class="na">list</span><span class="o">(</span><span class="s">"a9pvykxz4g5rg0fplze0"</span><span class="o">,</span> <span class="n">request</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">OpenpayAPI</span><span class="p">(</span><span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="p">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="p">);</span>
<span class="n">SearchParams</span> <span class="n">request</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SearchParams</span><span class="p">();</span>
<span class="n">request</span><span class="p">.</span><span class="n">CreationGte</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Datetime</span><span class="p">(</span><span class="m">2014</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">1</span><span class="p">);</span>
<span class="n">request</span><span class="p">.</span><span class="n">CreationLte</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">2014</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">15</span><span class="p">);</span>
<span class="n">request</span><span class="p">.</span><span class="n">Offset</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">Limit</span> <span class="p">=</span> <span class="m">100</span><span class="p">;</span>

<span class="n">List</span><span class="p">&lt;</span><span class="n">Subscription</span><span class="p">&gt;</span> <span class="n">subscriptions</span> <span class="p">=</span> <span class="n">api</span><span class="p">.</span><span class="n">SubscriptionService</span><span class="p">.</span><span class="nf">List</span><span class="p">(</span><span class="s">"a9pvykxz4g5rg0fplze0"</span><span class="p">,</span> <span class="n">request</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="kd">var</span> <span class="nx">searchParams</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">'limit'</span> <span class="err">:</span> <span class="mi">2</span>
<span class="p">};</span>

<span class="nx">openpay</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">subscriptions</span><span class="p">.</span><span class="nx">list</span><span class="p">(</span><span class="s1">'ag4nktpdzebjiye1tlze'</span><span class="p">,</span> <span class="nx">searchParams</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">list</span><span class="p">){</span>
  <span class="c1">// ...
</span><span class="p">});</span>
</pre><pre class="highlight ruby"><span class="vi">@openpay</span><span class="o">=</span><span class="no">OpenpayApi</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"mzdtln0bmtms6o3kck8f"</span><span class="p">,</span><span class="s2">"sk_e568c42a6c384b7ab02cd47d2e407cab"</span><span class="p">)</span>
<span class="vi">@subscriptions</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:subscriptions</span><span class="p">)</span>

<span class="vi">@subscriptions</span><span class="p">.</span><span class="nf">all</span><span class="p">(</span><span class="s2">"pbi4kb8hpb64x0uud2eb"</span><span class="p">)</span>
</pre>
<blockquote>
<p>Response example</p>
</blockquote>
<pre class="highlight json"><span class="p">[</span><span class="w">
   </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"s0gmyor4yqtyv1miqwr0"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"status"</span><span class="p">:</span><span class="s2">"trial"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"card"</span><span class="p">:{</span><span class="w">
         </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"credit"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"brand"</span><span class="p">:</span><span class="s2">"american_express"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"address"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
         </span><span class="s2">"card_number"</span><span class="p">:</span><span class="s2">"343434XXXXX4343"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"holder_name"</span><span class="p">:</span><span class="s2">"Juan Perez Ramirez"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"expiration_year"</span><span class="p">:</span><span class="s2">"20"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"expiration_month"</span><span class="p">:</span><span class="s2">"12"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"allows_charges"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
         </span><span class="s2">"allows_payouts"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
         </span><span class="s2">"bank_name"</span><span class="p">:</span><span class="s2">"AMERICAN EXPRESS"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"bank_code"</span><span class="p">:</span><span class="s2">"103"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"cancel_at_period_end"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="s2">"charge_date"</span><span class="p">:</span><span class="s2">"2016-01-12"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="s2">"2014-05-22T15:56:18-05:00"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"current_period_number"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
      </span><span class="s2">"period_end_date"</span><span class="p">:</span><span class="s2">"2016-01-11"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"trial_end_date"</span><span class="p">:</span><span class="s2">"2016-01-11"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"plan_id"</span><span class="p">:</span><span class="s2">"pbi4kb8hpb64x0uud2eb"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"customer_id"</span><span class="p">:</span><span class="s2">"ag4nktpdzebjiye1tlze"</span><span class="w">
   </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></pre>
<p>Returns all the subscriptions active for an specific customer.</p>

<h3 id="request">Request</h3>

<p>You can search using the following parameters:</p>

<table><thead>
<tr>
<th>Property</th>
<th>Descriptions</th>
</tr>
</thead><tbody>
<tr>
<td>creation</td>
<td><strong><em>date</em></strong> <br/> Same as creation date:  Format: yyyy-mm-dd.</td>
</tr>
<tr>
<td>creation[gte]</td>
<td><strong><em>date</em></strong> <br/>After the creation date. Format: yyyy-mm-dd.</td>
</tr>
<tr>
<td>creation[lte]</td>
<td><strong><em>date</em></strong> <br/>Before the creation date.  Format: yyyy-mm-dd.</td>
</tr>
<tr>
<td>offset</td>
<td><strong><em>numeric</em></strong> <br/>Number of records to skip from the beggining, by default is 0.</td>
</tr>
<tr>
<td>limit</td>
<td><strong><em>numeric</em></strong> <br/> Number of records to return, by default is 10.</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<p>A list of <a href="#subscription-object">subscription objects</a> for a customer. Sort by creation date in descending order.</p>

<h1 id="fees">Fees</h1>

<p>If the customer accounts were created to handle their own balance, a fee can be charged which will be shown in the Merchant account.</p>

<p><aside class="notice">
In order to have customer accounts where they handle their balance they should have been created with the property <strong><em>requires_account=true</em></strong>.  See <a href="#create-a-new-customer">customer creation</a>.
</aside></p>

<h2 id="charging-a-fee">Charging a Fee</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell">POST https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/fees
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$fee</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">fees</span><span class="o">-&gt;</span><span class="na">create</span><span class="p">(</span><span class="nx">feeDataRequest</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">openpayAPI</span><span class="o">.</span><span class="na">fees</span><span class="o">().</span><span class="na">create</span><span class="o">(</span><span class="n">CreateFeeParams</span> <span class="n">request</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">openpayAPI</span><span class="p">.</span><span class="n">FeeService</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="n">FeeRequest</span> <span class="n">request</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="nx">openpay</span><span class="p">.</span><span class="nx">fees</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">feeRequest</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
</pre><pre class="highlight ruby"><span class="c1">#Customer</span>
<span class="vi">@fees</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:fees</span><span class="p">)</span>
<span class="vi">@fees</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="n">request_hash</span><span class="p">)</span>
</pre>
<blockquote>
<p>Request example</p>
</blockquote>
<pre class="highlight shell">curl https://sandbox-api.openpay.mx/v1/mzdtln0bmtms6o3kck8f/fees <span class="se">\</span>
   -u sk_e568c42a6c384b7ab02cd47d2e407cab: <span class="se">\</span>
   -H <span class="s2">"Content-type: application/json"</span> <span class="se">\</span>
   -X POST -d <span class="s1">'{                                            
     "customer_id" : "dvocf97jd20es3tw5laz",
     "amount" : 12.50,          
     "description" : "Cobro de ComisiÃƒÂ³n",
     "order_id" : "oid-1245"
}'</span> 
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$openpay</span> <span class="o">=</span> <span class="nx">Openpay</span><span class="o">::</span><span class="na">getInstance</span><span class="p">(</span><span class="s1">'moiep6umtcnanql3jrxp'</span><span class="p">,</span> <span class="s1">'sk_3433941e467c1055b178ce26348b0fac'</span><span class="p">);</span>

<span class="nv">$feeDataRequest</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'customer_id'</span> <span class="o">=&gt;</span> <span class="s1">'a9ualumwnrcxkl42l6mh'</span><span class="p">,</span>
    <span class="s1">'amount'</span> <span class="o">=&gt;</span> <span class="mf">12.50</span><span class="p">,</span>
    <span class="s1">'description'</span> <span class="o">=&gt;</span> <span class="s1">'Cobro de ComisiÃƒÂ³n'</span><span class="p">,</span>
    <span class="s1">'order_id'</span> <span class="o">=&gt;</span> <span class="s1">'ORDEN-00063'</span><span class="p">);</span>

<span class="nv">$fee</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">fees</span><span class="o">-&gt;</span><span class="na">create</span><span class="p">(</span><span class="nv">$feeDataRequest</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OpenpayAPI</span><span class="o">(</span><span class="s">"https://sandbox-api.openpay.mx"</span><span class="o">,</span> <span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="o">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="o">);</span>
<span class="n">CreateFeeParams</span> <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CreateFeeParams</span><span class="o">();</span>
<span class="n">request</span><span class="o">.</span><span class="na">customerId</span><span class="o">(</span><span class="s">"a9pvykxz4g5rg0fplze0"</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">amount</span><span class="o">(</span><span class="k">new</span> <span class="n">BigDecimal</span><span class="o">(</span><span class="s">"100.00"</span><span class="o">));</span>
<span class="n">request</span><span class="o">.</span><span class="na">description</span><span class="o">(</span><span class="s">"Cobro de comisiÃƒÂ³n"</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">orderId</span><span class="o">(</span><span class="s">"oid-1245"</span><span class="o">);</span>

<span class="n">Fee</span> <span class="n">fee</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="na">fees</span><span class="o">().</span><span class="na">create</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">OpenpayAPI</span><span class="p">(</span><span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="p">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="p">);</span>
<span class="n">FeeRequest</span> <span class="n">request</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">FeeRequest</span><span class="p">();</span>
<span class="n">request</span><span class="p">.</span><span class="n">CustomerId</span> <span class="p">=</span> <span class="s">"a9pvykxz4g5rg0fplze0"</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">Amount</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Decimal</span><span class="p">(</span><span class="m">100.00</span><span class="p">);</span>
<span class="n">request</span><span class="p">.</span><span class="n">Description</span> <span class="p">=</span> <span class="s">"Cobro de comisiÃƒÂ³n"</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">OrderId</span> <span class="p">=</span> <span class="s">"oid-1245;
</span>
<span class="n">Fee</span> <span class="n">fee</span> <span class="p">=</span> <span class="n">api</span><span class="p">.</span><span class="n">FeeService</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="n">request</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="kd">var</span> <span class="nx">feeRequest</span> <span class="o">=</span> <span class="p">{</span>                                            
     <span class="s1">'customer_id'</span> <span class="err">:</span> <span class="s1">'dvocf97jd20es3tw5laz'</span><span class="p">,</span>
     <span class="s1">'amount'</span> <span class="err">:</span> <span class="mf">12.50</span><span class="p">,</span>          
     <span class="s1">'description'</span> <span class="err">:</span> <span class="s1">'Cobro de ComisiÃƒÂ³n'</span><span class="p">,</span>
     <span class="s1">'order_id'</span> <span class="err">:</span> <span class="s1">'oid-1245'</span>
<span class="p">};</span>

<span class="nx">openpay</span><span class="p">.</span><span class="nx">fees</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">feeRequest</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">fee</span><span class="p">){</span>
  <span class="c1">// ...
</span><span class="p">});</span>
</pre><pre class="highlight ruby"><span class="vi">@openpay</span><span class="o">=</span><span class="no">OpenpayApi</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"mzdtln0bmtms6o3kck8f"</span><span class="p">,</span><span class="s2">"sk_e568c42a6c384b7ab02cd47d2e407cab"</span><span class="p">)</span>
<span class="vi">@fees</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:fees</span><span class="p">)</span>
<span class="n">request_hash</span><span class="o">=</span><span class="p">{</span>
     <span class="s2">"customer_id"</span> <span class="o">=&gt;</span> <span class="s2">"dvocf97jd20es3tw5laz"</span><span class="p">,</span>
     <span class="s2">"amount"</span> <span class="o">=&gt;</span> <span class="mi">12</span><span class="o">.</span><span class="mi">50</span><span class="p">,</span>
     <span class="s2">"description"</span> <span class="o">=&gt;</span> <span class="s2">"Cobro de ComisiÃƒÂ³n"</span><span class="p">,</span>
     <span class="s2">"order_id"</span> <span class="o">=&gt;</span> <span class="s2">"oid-1245"</span>
   <span class="p">}</span>

<span class="n">response_hash</span><span class="o">=</span><span class="vi">@fees</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="n">request_hash</span><span class="p">.</span><span class="nf">to_hash</span><span class="p">)</span>
</pre>
<blockquote>
<p>Response example</p>
</blockquote>
<pre class="highlight json"><span class="p">{</span><span class="w">
   </span><span class="s2">"amount"</span><span class="p">:</span><span class="mf">12.50</span><span class="p">,</span><span class="w">
   </span><span class="s2">"authorization"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
   </span><span class="s2">"method"</span><span class="p">:</span><span class="s2">"customer"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"operation_type"</span><span class="p">:</span><span class="s2">"out"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"currency"</span><span class="p">:</span><span class="s2">"MXN"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"transaction_type"</span><span class="p">:</span><span class="s2">"fee"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"status"</span><span class="p">:</span><span class="s2">"completed"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"th8tafyrkakdbyry3kxi"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="s2">"2013-11-18T10:33:03-06:00"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"description"</span><span class="p">:</span><span class="s2">"Cobro de comisiÃƒÂ³n"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"error_message"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
   </span><span class="s2">"order_id"</span><span class="p">:</span><span class="s2">"oid-1245"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"customer_id"</span><span class="p">:</span><span class="s2">"dvocf97jd20es3tw5laz"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<p>Charge a fee to the customer account.</p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>customer_id</td>
<td><strong><em>string</em></strong> (required, length = 45) <br/>The unique identifier of the customer that you want to charge the fee.</td>
</tr>
<tr>
<td>amount</td>
<td><strong><em>numeric</em></strong> (required) <br/>Charge amount.  It needs to be more than zero, it can have up to two decimal places.</td>
</tr>
<tr>
<td>description</td>
<td><strong><em>string</em></strong> (required, length = 250) <br/> A description associated with the fee charge.</td>
</tr>
<tr>
<td>order_id</td>
<td><strong><em>string</em></strong> (optional, length = 100) <br/>Unique fee identifier.  It has to be unique among all the transactions.</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<p>The <a href="#transaction-object">transaction object</a> of the fee including the creation date and id or an <a href="#error-object">error response</a>.</p>

<h2 id="fee-list">Fee  list</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell">GET https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/fees
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$feeList</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">fees</span><span class="o">-&gt;</span><span class="na">getList</span><span class="p">(</span><span class="nx">findDataRequest</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">openpayAPI</span><span class="o">.</span><span class="na">fees</span><span class="o">().</span><span class="na">list</span><span class="o">(</span><span class="n">SearchParams</span> <span class="n">request</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">openpayAPI</span><span class="p">.</span><span class="n">FeeService</span><span class="p">.</span><span class="nf">List</span><span class="p">(</span><span class="n">SearchParams</span> <span class="n">request</span> <span class="p">=</span> <span class="k">null</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="nx">openpay</span><span class="p">.</span><span class="nx">fees</span><span class="p">.</span><span class="nx">list</span><span class="p">(</span><span class="nx">callback</span><span class="p">);</span>
<span class="nx">openpay</span><span class="p">.</span><span class="nx">fees</span><span class="p">.</span><span class="nx">list</span><span class="p">(</span><span class="nx">searchParams</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
</pre><pre class="highlight ruby"><span class="c1">#Customer</span>
<span class="vi">@fees</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:fees</span><span class="p">)</span>
<span class="vi">@fees</span><span class="p">.</span><span class="nf">all</span>
</pre>
<blockquote>
<p>Ejemplo de peticiÃƒÂ³n </p>
</blockquote>
<pre class="highlight shell">curl -g <span class="s2">"https://sandbox-api.openpay.mx/v1/mzdtln0bmtms6o3kck8f/fees?limit=10"</span> <span class="se">\</span>
   -u sk_e568c42a6c384b7ab02cd47d2e407cab: 
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$openpay</span> <span class="o">=</span> <span class="nx">Openpay</span><span class="o">::</span><span class="na">getInstance</span><span class="p">(</span><span class="s1">'moiep6umtcnanql3jrxp'</span><span class="p">,</span> <span class="s1">'sk_3433941e467c1055b178ce26348b0fac'</span><span class="p">);</span>

<span class="nv">$findData</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'creation[gte]'</span> <span class="o">=&gt;</span> <span class="s1">'2013-01-01'</span><span class="p">,</span>
    <span class="s1">'creation[lte]'</span> <span class="o">=&gt;</span> <span class="s1">'2013-12-31'</span><span class="p">,</span>
    <span class="s1">'offset'</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">'limit'</span> <span class="o">=&gt;</span> <span class="mi">5</span><span class="p">);</span>

<span class="nv">$feeList</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">fees</span><span class="o">-&gt;</span><span class="na">getList</span><span class="p">(</span><span class="nv">$findDataRequest</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="kd">final</span> <span class="n">Calendar</span> <span class="n">dateGte</span> <span class="o">=</span> <span class="n">Calendar</span><span class="o">.</span><span class="na">getInstance</span><span class="o">();</span>
<span class="kd">final</span> <span class="n">Calendar</span> <span class="n">dateLte</span> <span class="o">=</span> <span class="n">Calendar</span><span class="o">.</span><span class="na">getInstance</span><span class="o">();</span>
<span class="n">dateGte</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="mi">2014</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">);</span>
<span class="n">dateLte</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="mi">2014</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">15</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">);</span>

<span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OpenpayAPI</span><span class="o">(</span><span class="s">"https://sandbox-api.openpay.mx"</span><span class="o">,</span> <span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="o">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="o">);</span>
<span class="n">SearchParams</span> <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SearchParams</span><span class="o">();</span>
<span class="n">request</span><span class="o">.</span><span class="na">creationGte</span><span class="o">(</span><span class="n">dateGte</span><span class="o">.</span><span class="na">getTime</span><span class="o">());</span>
<span class="n">request</span><span class="o">.</span><span class="na">creationLte</span><span class="o">(</span><span class="n">dateLte</span><span class="o">.</span><span class="na">getTime</span><span class="o">());</span>
<span class="n">request</span><span class="o">.</span><span class="na">offset</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">limit</span><span class="o">(</span><span class="mi">100</span><span class="o">);</span>

<span class="n">List</span><span class="o">&lt;</span><span class="n">Fee</span><span class="o">&gt;</span> <span class="n">fees</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="na">fees</span><span class="o">().</span><span class="na">list</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">OpenpayAPI</span><span class="p">(</span><span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="p">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="p">);</span>
<span class="n">SearchParams</span> <span class="n">request</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SearchParams</span><span class="p">();</span>
<span class="n">request</span><span class="p">.</span><span class="n">CreationGte</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Datetime</span><span class="p">(</span><span class="m">2014</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">1</span><span class="p">);</span>
<span class="n">request</span><span class="p">.</span><span class="n">CreationLte</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">2014</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">15</span><span class="p">);</span>
<span class="n">request</span><span class="p">.</span><span class="n">Offset</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">Limit</span> <span class="p">=</span> <span class="m">100</span><span class="p">;</span>

<span class="n">List</span><span class="p">&lt;</span><span class="n">Fee</span><span class="p">&gt;</span> <span class="n">fees</span> <span class="p">=</span> <span class="n">api</span><span class="p">.</span><span class="n">FeeService</span><span class="p">.</span><span class="nf">List</span><span class="p">(</span><span class="n">request</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="kd">var</span> <span class="nx">searchParams</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">'limit'</span> <span class="err">:</span> <span class="mi">10</span>
<span class="p">};</span>

<span class="nx">openpay</span><span class="p">.</span><span class="nx">fees</span><span class="p">.</span><span class="nx">list</span><span class="p">(</span><span class="nx">searchParams</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">list</span><span class="p">){</span>
  <span class="c1">// ...
</span><span class="p">});</span>
</pre><pre class="highlight ruby"><span class="vi">@openpay</span><span class="o">=</span><span class="no">OpenpayApi</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"mzdtln0bmtms6o3kck8f"</span><span class="p">,</span><span class="s2">"sk_e568c42a6c384b7ab02cd47d2e407cab"</span><span class="p">)</span>
<span class="vi">@fees</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:fees</span><span class="p">)</span>

<span class="n">response_hash</span><span class="o">=</span><span class="vi">@fees</span><span class="p">.</span><span class="nf">all</span>
</pre>
<blockquote>
<p>Response example</p>
</blockquote>
<pre class="highlight json"><span class="p">[</span><span class="w">
   </span><span class="p">{</span><span class="w">
      </span><span class="s2">"amount"</span><span class="p">:</span><span class="mf">30.00</span><span class="p">,</span><span class="w">
      </span><span class="s2">"authorization"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"method"</span><span class="p">:</span><span class="s2">"customer"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"operation_type"</span><span class="p">:</span><span class="s2">"out"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"currency"</span><span class="p">:</span><span class="s2">"MXN"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"transaction_type"</span><span class="p">:</span><span class="s2">"fee"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"status"</span><span class="p">:</span><span class="s2">"completed"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"th8tafyrkakdbyry3kxi"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="s2">"2013-11-18T10:33:03-06:00"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"description"</span><span class="p">:</span><span class="s2">"Cobro de comisiÃƒÂ³n"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"error_message"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"order_id"</span><span class="p">:</span><span class="s2">"oid-1367"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"customer_id"</span><span class="p">:</span><span class="s2">"dvocf97jd20es3tw5laz"</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="p">{</span><span class="w">
      </span><span class="s2">"amount"</span><span class="p">:</span><span class="mf">12.00</span><span class="p">,</span><span class="w">
      </span><span class="s2">"authorization"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"method"</span><span class="p">:</span><span class="s2">"customer"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"operation_type"</span><span class="p">:</span><span class="s2">"out"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"currency"</span><span class="p">:</span><span class="s2">"MXN"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"transaction_type"</span><span class="p">:</span><span class="s2">"fee"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"status"</span><span class="p">:</span><span class="s2">"completed"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"tdzottaaohuhosf4cdv9"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="s2">"2013-11-17T05:35:00-06:00"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"description"</span><span class="p">:</span><span class="s2">"Cobro de comisiÃƒÂ³n"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"error_message"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"order_id"</span><span class="p">:</span><span class="s2">"oid-1366"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"customer_id"</span><span class="p">:</span><span class="s2">"afk4csrazjp1udezj1po"</span><span class="w">
   </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></pre>
<p>Returns the details of every fee charged by the Merchant.</p>

<h3 id="request">Request</h3>

<p>It can be done using the following parameters:</p>

<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>creation</td>
<td><strong><em>date</em></strong> <br/>Same as creation date. Format: yyyy-mm-dd</td>
</tr>
<tr>
<td>creation[gte]</td>
<td><strong><em>date</em></strong> <br/>After the creation date. Format: yyyy-mm-dd</td>
</tr>
<tr>
<td>creation[lte]</td>
<td><strong><em>date</em></strong> <br/>Before the creation date. Format: yyyy-mm-dd</td>
</tr>
<tr>
<td>offset</td>
<td><strong><em>numeric</em></strong> <br/>Number of records to skip from the beginning, by default is 0.</td>
</tr>
<tr>
<td>limit</td>
<td><strong><em>numeric</em></strong> <br/>Number of records to return, by default is 10.</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<p>Returns an array of <a href="#transaction-object">transaction object</a> for the charged fees  in descending order, each one with the identifier of the customer to whom it was made.</p>

<h1 id="webhooks">Webhooks</h1>

<p>Weebhooks allow to notify a Merchant party when an event has occurred in the platform, so the Merchant can take the corresponding actions.</p>

<p><aside class="notice">
Openpay requires that the webhook is verified before executing it.
</aside></p>

<h2 id="webhook-object">Webhook Object</h2>

<blockquote>
<p>Object example</p>
</blockquote>
<pre class="highlight json"><span class="w">  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"wxvanstudf4ssme8khmc"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"url"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"http://requestb.in/11vxrsf1"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"user"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"juanito"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"password"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"passjuanito"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"event_types"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"charge.refunded"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"charge.failed"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"charge.cancelled"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"charge.created"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"chargeback.accepted"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="s2">"status"</span><span class="p">:</span><span class="s2">"verified"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td><strong><em>string</em></strong> <br/>Unique webhook identifier number.</td>
</tr>
<tr>
<td>url</td>
<td><strong><em>string</em></strong> <br/>Webhook.</td>
</tr>
<tr>
<td>user</td>
<td><strong><em>string</em></strong> <br/>User name used for webhook&rsquo;s basic authentication.</td>
</tr>
<tr>
<td>password</td>
<td><strong><em>string</em></strong> <br/>Password for webhook&rsquo;s basic authentication.</td>
</tr>
<tr>
<td>event_types</td>
<td><strong><em>array[string]</em></strong> <br/>List of events where the webhook will be triggered.</td>
</tr>
<tr>
<td>status</td>
<td><strong><em>string</em></strong> <br/>Webhook status, it indicates if it&rsquo;s <em>verified</em> or not (<em>unverified</em>).</td>
</tr>
</tbody></table>

<p><aside class="success">
The supported event type are:
</aside></p>

<table><thead>
<tr>
<th>Event</th>
<th>Category</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>charge.refunded</td>
<td>Charge</td>
<td>Reports when there is a charge refund.</td>
</tr>
<tr>
<td>charge.failed</td>
<td>Charge</td>
<td>Reports when a charge failed and it wasn&rsquo;t applied.</td>
</tr>
<tr>
<td>charge.cancelled</td>
<td>Charge</td>
<td>Reports when a charge is cancelled.</td>
</tr>
<tr>
<td>charge.created</td>
<td>Charge</td>
<td>Reports when a charge is scheduled.</td>
</tr>
<tr>
<td>charge.succeeded</td>
<td>Charge</td>
<td>Reports when a charge is applied.</td>
</tr>
<tr>
<td>charge.rescored.to.decline</td>
<td>Charge</td>
<td>Reports when a charge&#39; score is recalculated and is declined.</td>
</tr>
<tr>
<td>subscription.charge.failed</td>
<td>Subscription</td>
<td>Reports when the charge to a subscription fails.</td>
</tr>
<tr>
<td>payout.created</td>
<td>Payout</td>
<td>Reports when a payout has been scheduled for the next day.</td>
</tr>
<tr>
<td>payout.succeeded</td>
<td>Payout</td>
<td>Reports when a payout has been applied.</td>
</tr>
<tr>
<td>payout.failed</td>
<td>Payout</td>
<td>Reports when a payout has failed.</td>
</tr>
<tr>
<td>transfer.succeeded</td>
<td>Transfer</td>
<td>Reports when a transfer has been performed between to Openpay accounts.</td>
</tr>
<tr>
<td>fee.succeeded</td>
<td>Fee</td>
<td>Reports when a fee is charged successfully to a customer.</td>
</tr>
<tr>
<td>fee.refund.succeeded</td>
<td>Fee</td>
<td>Reports when a fee has been successfully refunded to a customer.</td>
</tr>
<tr>
<td>spei.received</td>
<td>SPEI</td>
<td>Reports when a payout has been received by SPEI for adding funds to the account.</td>
</tr>
<tr>
<td>chargeback.created</td>
<td>Chargeback</td>
<td>Reports when a chargeback of a transaction was receive and a transaction has been initiated.</td>
</tr>
<tr>
<td>chargeback.rejected</td>
<td>Chargeback</td>
<td>Reports when a chargeback has been rejected.</td>
</tr>
<tr>
<td>chargeback.accepted</td>
<td>Chargeback</td>
<td>Reports when a chargeback has been accepted.</td>
</tr>
<tr>
<td>order.created</td>
<td>Order</td>
<td>Reports when an order is created an scheduled.</td>
</tr>
<tr>
<td>order.activated</td>
<td>Order</td>
<td>Reports when an order is activated.</td>
</tr>
<tr>
<td>order.payment.received</td>
<td>Order</td>
<td>Reports when an order is received.</td>
</tr>
<tr>
<td>order.completed</td>
<td>Order</td>
<td>Reports when an order is completed.</td>
</tr>
<tr>
<td>order.expired</td>
<td>Order</td>
<td>Reports when an order has expired.</td>
</tr>
<tr>
<td>order.cancelled</td>
<td>Order</td>
<td>Reports when an order is canceled.</td>
</tr>
<tr>
<td>order.payment.cancelled</td>
<td>Order</td>
<td>Reports when a payment order is canceled.</td>
</tr>
</tbody></table>

<h2 id="webhook-creation">Webhook Creation</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell">POST https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/webhooks
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$webhook</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">webhooks</span><span class="o">-&gt;</span><span class="na">create</span><span class="p">(</span><span class="nx">webhook</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">openpayAPI</span><span class="o">.</span><span class="na">webhooks</span><span class="o">().</span><span class="na">create</span><span class="o">(</span><span class="n">Webhook</span> <span class="n">request</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">openpayAPI</span><span class="p">.</span><span class="n">WebhooksService</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="n">Webhook</span> <span class="n">request</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="nx">openpay</span><span class="p">.</span><span class="nx">webhooks</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">webhook</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
</pre><pre class="highlight ruby"><span class="vi">@webhooks</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:webhooks</span><span class="p">)</span>
<span class="vi">@webhooks</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="n">request_hash</span><span class="p">)</span>
</pre>
<blockquote>
<p>Request example</p>
</blockquote>
<pre class="highlight shell">curl https://sandbox-api.openpay.mx/v1/mzdtln0bmtms6o3kck8f/webhooks <span class="se">\</span>
   -u sk_e568c42a6c384b7ab02cd47d2e407cab: <span class="se">\</span>
   -H <span class="s2">"Content-type: application/json"</span> <span class="se">\</span>
   -X POST -d <span class="s1">'{
    "url" : "http://requestb.in/11vxrsf1",
    "user" : "juanito",
    "password" : "passjuanito",
    "event_types" : [
      "charge.refunded",
      "charge.failed",
      "charge.cancelled",
      "charge.created",
      "chargeback.accepted"
    ]
}'</span> 
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$openpay</span> <span class="o">=</span> <span class="nx">Openpay</span><span class="o">::</span><span class="na">getInstance</span><span class="p">(</span><span class="s1">'moiep6umtcnanql3jrxp'</span><span class="p">,</span> <span class="s1">'sk_3433941e467c1055b178ce26348b0fac'</span><span class="p">);</span>

<span class="nv">$webhook</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'url'</span> <span class="o">=&gt;</span> <span class="s1">'http://requestb.in/11vxrsf1'</span><span class="p">,</span>
    <span class="s1">'user'</span> <span class="o">=&gt;</span> <span class="s1">'juanito'</span><span class="p">,</span>
    <span class="s1">'password'</span> <span class="o">=&gt;</span> <span class="s1">'passjuanito'</span><span class="p">,</span>
    <span class="s1">'event_types'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
      <span class="s1">'charge.refunded'</span><span class="p">,</span>
      <span class="s1">'charge.failed'</span><span class="p">,</span>
      <span class="s1">'charge.cancelled'</span><span class="p">,</span>
      <span class="s1">'charge.created'</span><span class="p">,</span>
      <span class="s1">'chargeback.accepted'</span>
    <span class="p">)</span>
    <span class="p">);</span>

<span class="nv">$webhook</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">webhooks</span><span class="o">-&gt;</span><span class="na">create</span><span class="p">(</span><span class="nv">$webhook</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OpenpayAPI</span><span class="o">(</span><span class="s">"https://sandbox-api.openpay.mx"</span><span class="o">,</span> <span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="o">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="o">);</span>
<span class="n">Webhook</span> <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Webhook</span><span class="o">();</span>
<span class="n">request</span><span class="o">.</span><span class="na">url</span><span class="o">(</span><span class="s">"http://requestb.in/11vxrsf1"</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">user</span><span class="o">(</span><span class="s">"juanito"</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">password</span><span class="o">(</span><span class="s">"passjuanito"</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">addEventType</span><span class="o">(</span><span class="s">"charge.refunded"</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">addEventType</span><span class="o">(</span><span class="s">"charge.failed"</span><span class="o">);</span>

<span class="n">Webhook</span> <span class="n">webhook</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="na">webhooks</span><span class="o">().</span><span class="na">create</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">OpenpayAPI</span><span class="p">(</span><span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="p">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="p">);</span>
<span class="n">Webhook</span> <span class="n">request</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Webhook</span><span class="p">();</span>
<span class="n">request</span><span class="p">.</span><span class="n">Url</span> <span class="p">=</span> <span class="s">"http://requestb.in/11vxrsf1"</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">User</span> <span class="p">=</span> <span class="s">"juanito"</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="n">Password</span> <span class="p">=</span> <span class="s">"passjuanito"</span><span class="p">;</span>
<span class="n">request</span><span class="p">.</span><span class="nf">AddEventType</span><span class="p">(</span><span class="s">"charge.refunded"</span><span class="p">);</span>
<span class="n">request</span><span class="p">.</span><span class="nf">AddEventType</span><span class="p">(</span><span class="s">"charge.failed"</span><span class="p">);</span>

<span class="n">Webhook</span> <span class="n">webhook</span> <span class="p">=</span> <span class="n">api</span><span class="p">.</span><span class="n">WebhookService</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="n">request</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="kd">var</span> <span class="nx">webhook_params</span> <span class="o">=</span> <span class="p">{</span>                                            
    <span class="s1">'url'</span> <span class="err">:</span> <span class="s1">'http://requestb.in/11vxrsf1'</span><span class="p">,</span>
    <span class="s1">'user'</span> <span class="err">:</span> <span class="s1">'juanito'</span><span class="p">,</span>
    <span class="s1">'password'</span> <span class="err">:</span> <span class="s1">'passjuanito'</span><span class="p">,</span>
    <span class="s1">'event_types'</span> <span class="err">:</span> <span class="p">[</span>
      <span class="s1">'charge.refunded'</span><span class="p">,</span>
      <span class="s1">'charge.failed'</span><span class="p">,</span>
      <span class="s1">'charge.cancelled'</span><span class="p">,</span>
      <span class="s1">'charge.created'</span><span class="p">,</span>
      <span class="s1">'chargeback.accepted'</span>
    <span class="p">]</span>
<span class="p">};</span>

<span class="nx">openpay</span><span class="p">.</span><span class="nx">webhooks</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">webhook_params</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">webhook</span><span class="p">){</span>
  <span class="c1">// ...
</span><span class="p">});</span>
</pre><pre class="highlight ruby"><span class="vi">@openpay</span><span class="o">=</span><span class="no">OpenpayApi</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"mzdtln0bmtms6o3kck8f"</span><span class="p">,</span><span class="s2">"sk_e568c42a6c384b7ab02cd47d2e407cab"</span><span class="p">)</span>
<span class="vi">@webhooks</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:webhooks</span><span class="p">)</span>
<span class="n">request_hash</span><span class="o">=</span><span class="p">{</span>
    <span class="s2">"url"</span> <span class="o">=&gt;</span> <span class="s2">"http://requestb.in/11vxrsf1"</span><span class="p">,</span>
    <span class="s2">"user"</span> <span class="o">=&gt;</span> <span class="s2">"juanito"</span><span class="p">,</span>
    <span class="s2">"password"</span> <span class="o">=&gt;</span> <span class="s2">"passjuanito"</span><span class="p">,</span>
    <span class="s2">"event_types"</span> <span class="o">=&gt;</span> <span class="o">[</span>
      <span class="s2">"charge.refunded"</span><span class="p">,</span>
      <span class="s2">"charge.failed"</span><span class="p">,</span>
      <span class="s2">"charge.cancelled"</span><span class="p">,</span>
      <span class="s2">"charge.created"</span><span class="p">,</span>
      <span class="s2">"chargeback.accepted"</span>
    <span class="o">]</span>
   <span class="p">}</span>

<span class="n">response_hash</span><span class="o">=</span><span class="vi">@webhooks</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="n">request_hash</span><span class="p">.</span><span class="nf">to_hash</span><span class="p">)</span>
</pre>
<blockquote>
<p>Response example</p>
</blockquote>
<pre class="highlight json"><span class="p">{</span><span class="w">
  </span><span class="s2">"id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"wkn0t30zfxpmhr5usgfa"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"url"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"http://requestb.in/qt3bq0qt"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"user"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"juanito"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"event_types"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"charge.succeeded"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"charge.created"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"charge.cancelled"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"charge.failed"</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="s2">"status"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"verified"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<p>When you save webhooks an ID will be generated that can be used to eliminate it or simply get not sensitive webhook information.</p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Request</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>url</td>
<td><strong><em>string</em></strong> <br/>Webhook URL</td>
</tr>
<tr>
<td>user</td>
<td><strong><em>string</em></strong> <br/>Username for basic webhook authentication.</td>
</tr>
<tr>
<td>password</td>
<td><strong><em>string</em></strong> <br/>Password for basic webhook authentication.</td>
</tr>
<tr>
<td>event_types</td>
<td><strong><em>array[string]</em></strong> <br/>List of events where the webhook will be triggered.</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<p>Returns a <a href="#webhook-object">webhook object</a> when it was successfully created or an error response if there was an error on creation.</p>

<h2 id="get-a-webhook">Get a Webhook</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell">GET https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/webhooks/<span class="o">{</span>WEBHOOK_ID<span class="o">}</span>
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$webhook</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">webhooks</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">webhookId</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">openpayAPI</span><span class="o">.</span><span class="na">webhooks</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="n">String</span> <span class="n">webhookId</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">openpayAPI</span><span class="p">.</span><span class="n">WebhooksService</span><span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="kt">string</span> <span class="n">webhookId</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="nx">openpay</span><span class="p">.</span><span class="nx">webhooks</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">webhookId</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
</pre><pre class="highlight ruby"><span class="vi">@webhooks</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:webhooks</span><span class="p">)</span>
<span class="vi">@webhooks</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">webhookId</span><span class="p">)</span>
</pre>
<blockquote>
<p>Request example</p>
</blockquote>
<pre class="highlight shell">curl https://sandbox-api.openpay.mx/v1/mzdtln0bmtms6o3kck8f/webhooks/wxvanstudf4ssme8khmc <span class="se">\</span>
   -u sk_e568c42a6c384b7ab02cd47d2e407cab: <span class="se">\</span>
   -H <span class="s2">"Content-type: application/json"</span> 
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$openpay</span> <span class="o">=</span> <span class="nx">Openpay</span><span class="o">::</span><span class="na">getInstance</span><span class="p">(</span><span class="s1">'moiep6umtcnanql3jrxp'</span><span class="p">,</span> <span class="s1">'sk_3433941e467c1055b178ce26348b0fac'</span><span class="p">);</span>

<span class="nv">$webhook</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">webhooks</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'wxvanstudf4ssme8khmc'</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OpenpayAPI</span><span class="o">(</span><span class="s">"https://sandbox-api.openpay.mx"</span><span class="o">,</span> <span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="o">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="o">);</span>
<span class="n">Webhook</span> <span class="n">webhook</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="na">webhooks</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="s">"wxvanstudf4ssme8khmc"</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">OpenpayAPI</span><span class="p">(</span><span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="p">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="p">);</span>
<span class="n">Webhook</span> <span class="n">webhook</span> <span class="p">=</span> <span class="n">api</span><span class="p">.</span><span class="n">WebhooksService</span><span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="s">"wxvanstudf4ssme8khmc"</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="nx">openpay</span><span class="p">.</span><span class="nx">webhooks</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'wxvanstudf4ssme8khmc'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">webhook</span><span class="p">){</span>
  <span class="c1">// ...
</span><span class="p">});</span>
</pre><pre class="highlight ruby"><span class="vi">@openpay</span><span class="o">=</span><span class="no">OpenpayApi</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"mzdtln0bmtms6o3kck8f"</span><span class="p">,</span><span class="s2">"sk_e568c42a6c384b7ab02cd47d2e407cab"</span><span class="p">)</span>
<span class="vi">@webhooks</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:webhooks</span><span class="p">)</span>

<span class="n">response_hash</span><span class="o">=</span><span class="vi">@webhooks</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="s2">"wxvanstudf4ssme8khmc"</span><span class="p">)</span>
</pre>
<blockquote>
<p>Response example</p>
</blockquote>
<pre class="highlight json"><span class="w">  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"wxvanstudf4ssme8khmc"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"url"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"http://requestb.in/11vxrsf1"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"user"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"juanito"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"event_types"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"verification"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"charge.refunded"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"charge.failed"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"charge.cancelled"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"charge.created"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"charge.succeeded"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"subscription.charge.failed"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"payout.created"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"payout.succeeded"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"payout.failed"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"transfer.succeeded"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"fee.succeeded"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"spei.received"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"chargeback.created"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"chargeback.rejected"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"chargeback.accepted"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="s2">"status"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"verified"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span></pre>
<p>Get a list of the webhook details by ID. </p>

<p><aside class="notice">
<strong>Note:</strong> Sensitive data like the password will never be included in the response.
</aside></p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td><strong><em>string</em></strong> (required, length = 45) <br/> Unique webhook identifier</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<p>Returns a <a href="#webhook-object">webhook object</a></p>

<h2 id="delete-a-webhook">Delete a Webhook</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell">DELETE https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/webhooks/<span class="o">{</span>WEBHOOK_ID<span class="o">}</span>
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$webhook</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">webhooks</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nx">webhookId</span><span class="p">);</span>
<span class="nv">$webhook</span><span class="o">-&gt;</span><span class="na">delete</span><span class="p">();</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">openpayAPI</span><span class="o">.</span><span class="na">webhooks</span><span class="o">().</span><span class="na">delete</span><span class="o">(</span><span class="n">String</span> <span class="n">webhookId</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">openpayAPI</span><span class="p">.</span><span class="n">WebhooksService</span><span class="p">.</span><span class="nf">Delete</span><span class="p">(</span><span class="kt">string</span> <span class="n">webhook_id</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="nx">openpay</span><span class="p">.</span><span class="nx">webhooks</span><span class="p">.</span><span class="k">delete</span><span class="p">(</span><span class="nx">webhookId</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
</pre><pre class="highlight ruby"><span class="vi">@webhooks</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:webhooks</span><span class="p">)</span>
<span class="vi">@webhooks</span><span class="p">.</span><span class="nf">delete</span><span class="p">(</span><span class="n">webhook_id</span><span class="p">)</span>
</pre>
<blockquote>
<p>Customer request example</p>
</blockquote>
<pre class="highlight shell">curl https://sandbox-api.openpay.mx/v1/mzdtln0bmtms6o3kck8f/webhooks/wxvanstudf4ssme8khmc <span class="se">\</span>
   -u sk_e568c42a6c384b7ab02cd47d2e407cab: <span class="se">\</span>
   -X DELETE
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$openpay</span> <span class="o">=</span> <span class="nx">Openpay</span><span class="o">::</span><span class="na">getInstance</span><span class="p">(</span><span class="s1">'moiep6umtcnanql3jrxp'</span><span class="p">,</span> <span class="s1">'sk_3433941e467c1055b178ce26348b0fac'</span><span class="p">);</span>

<span class="nv">$webhook</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">webhooks</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'wxvanstudf4ssme8khmc'</span><span class="p">);</span>
<span class="nv">$webhook</span><span class="o">-&gt;</span><span class="na">delete</span><span class="p">();</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OpenpayAPI</span><span class="o">(</span><span class="s">"https://sandbox-api.openpay.mx"</span><span class="o">,</span> <span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="o">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="o">);</span>
<span class="n">api</span><span class="o">.</span><span class="na">webhooks</span><span class="o">().</span><span class="na">delete</span><span class="o">(</span><span class="s">"wxvanstudf4ssme8khmc"</span><span class="o">);</span>
</pre><pre class="highlight csharp"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">OpenpayAPI</span><span class="p">(</span><span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="p">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="p">);</span>
<span class="n">api</span><span class="p">.</span><span class="n">WebhooksService</span><span class="p">.</span><span class="nf">Delete</span><span class="p">(</span><span class="s">"wxvanstudf4ssme8khmc"</span><span class="p">);</span>
</pre><pre class="highlight javascript"><span class="nx">openpay</span><span class="p">.</span><span class="nx">webhooks</span><span class="p">.</span><span class="k">delete</span><span class="p">(</span><span class="s1">'wxvanstudf4ssme8khmc'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// ...
</span><span class="p">});</span>
</pre><pre class="highlight ruby"><span class="vi">@openpay</span><span class="o">=</span><span class="no">OpenpayApi</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"mzdtln0bmtms6o3kck8f"</span><span class="p">,</span><span class="s2">"sk_e568c42a6c384b7ab02cd47d2e407cab"</span><span class="p">)</span>
<span class="vi">@webhooks</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:webhooks</span><span class="p">)</span>

<span class="n">response_hash</span><span class="o">=</span><span class="vi">@webhooks</span><span class="p">.</span><span class="nf">delete</span><span class="p">(</span><span class="s2">"wxvanstudf4ssme8khmc"</span><span class="p">)</span>
</pre>
<p>Delete a webhook from the merchant.</p>

<p>To delete a webhook you only need to provide the ID.</p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td><strong><em>string</em></strong> (required, length = 45) <br/> Webhook unique identifier.</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<p>If the webhook was deleted correctly the response will be empty, if the webhook cannot be deleted an <a href="#error-object">error object</a> will be returned including the error message.</p>

<h2 id="webhook-list">Webhook list</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell">GET https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>/webhooks
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$webhookList</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">webhooks</span><span class="o">-&gt;</span><span class="na">getList</span><span class="p">();</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">openpayAPI</span><span class="o">.</span><span class="na">webhooks</span><span class="o">().</span><span class="na">list</span><span class="o">();</span>
</pre><pre class="highlight csharp"><span class="n">openpayAPI</span><span class="p">.</span><span class="n">WebhooksService</span><span class="p">.</span><span class="nf">List</span><span class="p">();</span>
</pre><pre class="highlight javascript"><span class="nx">openpay</span><span class="p">.</span><span class="nx">webhooks</span><span class="p">.</span><span class="nx">list</span><span class="p">(</span><span class="nx">callback</span><span class="p">);</span>
</pre><pre class="highlight ruby"><span class="vi">@webhooks</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:webhooks</span><span class="p">)</span>
<span class="vi">@webhooks</span><span class="p">.</span><span class="nf">all</span>
</pre>
<blockquote>
<p>Request example</p>
</blockquote>
<pre class="highlight shell">curl https://sandbox-api.openpay.mx/v1/mzdtln0bmtms6o3kck8f/webhooks <span class="se">\</span>
   -u sk_e568c42a6c384b7ab02cd47d2e407cab: <span class="se">\</span>
   -H <span class="s2">"Content-type: application/json"</span> 
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="nv">$openpay</span> <span class="o">=</span> <span class="nx">Openpay</span><span class="o">::</span><span class="na">getInstance</span><span class="p">(</span><span class="s1">'moiep6umtcnanql3jrxp'</span><span class="p">,</span> <span class="s1">'sk_3433941e467c1055b178ce26348b0fac'</span><span class="p">);</span>

<span class="nv">$webhookList</span> <span class="o">=</span> <span class="nv">$openpay</span><span class="o">-&gt;</span><span class="na">webhooks</span><span class="o">-&gt;</span><span class="na">getList</span><span class="p">();</span>
<span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OpenpayAPI</span><span class="o">(</span><span class="s">"https://sandbox-api.openpay.mx"</span><span class="o">,</span> <span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="o">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="o">);</span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">Webhook</span><span class="o">&gt;</span> <span class="n">webhooks</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="na">webhooks</span><span class="o">().</span><span class="na">list</span><span class="o">();</span>
</pre><pre class="highlight csharp"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">OpenpayAPI</span><span class="p">(</span><span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="p">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="p">);</span>
<span class="n">List</span><span class="p">&lt;</span><span class="n">Webhook</span><span class="p">&gt;</span> <span class="n">webhooks</span> <span class="p">=</span> <span class="n">api</span><span class="p">.</span><span class="n">WebhooksService</span><span class="p">.</span><span class="nf">List</span><span class="p">();</span>
</pre><pre class="highlight javascript"><span class="nx">openpay</span><span class="p">.</span><span class="nx">webhooks</span><span class="p">.</span><span class="nx">list</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">list</span><span class="p">){</span>
  <span class="c1">// ...
</span><span class="p">});</span>
</pre><pre class="highlight ruby"><span class="vi">@openpay</span><span class="o">=</span><span class="no">OpenpayApi</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"mzdtln0bmtms6o3kck8f"</span><span class="p">,</span><span class="s2">"sk_e568c42a6c384b7ab02cd47d2e407cab"</span><span class="p">)</span>
<span class="vi">@webhooks</span><span class="o">=</span><span class="vi">@openpay</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">:webhooks</span><span class="p">)</span>

<span class="n">response_hash</span><span class="o">=</span><span class="vi">@webhooks</span><span class="p">.</span><span class="nf">all</span>
</pre>
<blockquote>
<p>Response example</p>
</blockquote>
<pre class="highlight json"><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"wDashboard185"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"event_types"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"verification"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"charge.refunded"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"charge.failed"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"charge.cancelled"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"charge.created"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"charge.succeeded"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"subscription.charge.failed"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"payout.created"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"payout.succeeded"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"payout.failed"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"transfer.succeeded"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"fee.succeeded"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"spei.received"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"chargeback.created"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"chargeback.rejected"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"chargeback.accepted"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="s2">"url"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"http://requestb.in/11vxrsf1"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"status"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"verified"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"wDashboard186"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"event_types"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"verification"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"charge.refunded"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"charge.failed"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"charge.cancelled"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"charge.created"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"charge.succeeded"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"subscription.charge.failed"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="s2">"url"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"http://requestb.in/1fhpiog1"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"status"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"verified"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></pre>
<p>Returns a list registered by the merchant.</p>

<p><aside class="notice">
<strong>Nota:</strong> Never return sensitive data like the webhook password access.
</aside></p>

<h3 id="request">Request</h3>

<h3 id="response">Response</h3>

<p>The list of <a href="#webhook-objects">webhook objects</a> registered according to the given parameters.</p>

<h1 id="tokens">Tokens</h1>

<p>The objective is to created tokens from the user browser or device to capture the card information so this doesn&rsquo;t go through your server and you can avoid or reduce the PCI certification process.</p>

<p>To use this API functionality we recommend using our JavaScript library for your Web application and our Android and iOS SDK for mobile apps.</p>

<p><strong>Features</strong></p>

<ul>
<li>Tokens are created at Merchant level.</li>
<li>Tokens are not link to any customer.</li>
<li>After a token has been created it can only be use once to make a charge.</li>
</ul>

<h2 id="token-object">Token Object</h2>

<blockquote>
<p>Object example </p>
</blockquote>
<pre class="highlight json"><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"tokfa4swch8gr4icy2ma"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"card"</span><span class="p">:{</span><span class="w">
       </span><span class="s2">"card_number"</span><span class="p">:</span><span class="s2">"1111"</span><span class="p">,</span><span class="w">
       </span><span class="s2">"holder_name"</span><span class="p">:</span><span class="s2">"Juan Perez Ramirez"</span><span class="p">,</span><span class="w">
       </span><span class="s2">"expiration_year"</span><span class="p">:</span><span class="s2">"20"</span><span class="p">,</span><span class="w">
       </span><span class="s2">"expiration_month"</span><span class="p">:</span><span class="s2">"04"</span><span class="p">,</span><span class="w">
       </span><span class="s2">"address"</span><span class="p">:{</span><span class="w">
          </span><span class="s2">"line1"</span><span class="p">:</span><span class="s2">"Av 5 de febrero"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"line2"</span><span class="p">:</span><span class="s2">"Roble 207"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"line3"</span><span class="p">:</span><span class="s2">"Queretaro"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"state"</span><span class="p">:</span><span class="s2">"Queretaro"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"city"</span><span class="p">:</span><span class="s2">"Queretaro"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"postal_code"</span><span class="p">:</span><span class="s2">"76900"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"country_code"</span><span class="p">:</span><span class="s2">"MX"</span><span class="w">
       </span><span class="p">},</span><span class="w">
       </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="s2">"2014-01-30T13:53:11-06:00"</span><span class="p">,</span><span class="w">
       </span><span class="s2">"brand"</span><span class="p">:</span><span class="s2">"visa"</span><span class="p">,</span><span class="w">
       </span><span class="s2">"points_card"</span><span class="p">:</span><span class="kc">false</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td><strong><em>string</em></strong> <br/>Token identifier.  This is the ID that you should use to perform operations.</td>
</tr>
<tr>
<td>card</td>
<td><strong><em>object</em></strong> <br/>Card associated with the token.  See <a href="#card-object">card object</a>.</td>
</tr>
</tbody></table>

<h2 id="create-a-new-token">Create a new token</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight plaintext">POST https://sandbox-api.openpay.mx/v1/{MERCHANT_ID}/tokens
</pre>
<blockquote>
<p>Request example</p>
</blockquote>
<pre class="highlight shell">curl https://sandbox-api.openpay.mx/v1/mzdtln0bmtms6o3kck8f/tokens <span class="se">\</span>
   -u sk_e568c42a6c384b7ab02cd47d2e407cab: <span class="se">\</span>
   -H <span class="s2">"Content-type: application/json"</span> <span class="se">\</span>
   -X POST -d <span class="s1">'{
   "card_number":"4111111111111111",
   "holder_name":"Juan Perez Ramirez",
   "expiration_year":"20",
   "expiration_month":"12",
   "cvv2":"110",
   "address":{
      "city":"QuerÃƒÆ’Ã‚Â©taro",
      "country_code":"MX",
      "postal_code":"76900",
      "line1":"Av 5 de Febrero",
      "line2":"Roble 207",
      "line3":"col carrillo",
      "state":"Queretaro"
   }
}'</span> 
</pre>
<blockquote>
<p>Response example</p>
</blockquote>
<pre class="highlight json"><span class="p">{</span><span class="w">
   </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"k1n0mscnjwhxqia8q7cm"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"card"</span><span class="p">:{</span><span class="w">
      </span><span class="s2">"card_number"</span><span class="p">:</span><span class="s2">"411111XXXXXX1111"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"holder_name"</span><span class="p">:</span><span class="s2">"Juan Perez Ramirez"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"expiration_year"</span><span class="p">:</span><span class="s2">"20"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"expiration_month"</span><span class="p">:</span><span class="s2">"12"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"address"</span><span class="p">:{</span><span class="w">
         </span><span class="s2">"line1"</span><span class="p">:</span><span class="s2">"Av 5 de Febrero"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"line2"</span><span class="p">:</span><span class="s2">"Roble 207"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"line3"</span><span class="p">:</span><span class="s2">"col carrillo"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"state"</span><span class="p">:</span><span class="s2">"Queretaro"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"city"</span><span class="p">:</span><span class="s2">"QuerÃƒÆ’Ã‚Â©taro"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"postal_code"</span><span class="p">:</span><span class="s2">"76900"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"country_code"</span><span class="p">:</span><span class="s2">"MX"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"brand"</span><span class="p">:</span><span class="s2">"visa"</span><span class="w">
   </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<p>To create a token using Openpay you need to send the object with the info that will be stored.  Once the token it&rsquo;s stored, you can&rsquo;t get the number and secutirty code because this information is encrypted.</p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>holder_name</td>
<td><strong><em>string</em></strong> (required) <br/>Account holder name.</td>
</tr>
<tr>
<td>card_number</td>
<td><strong><em>numeric</em></strong> (required) <br/>Card number between 16 to 19 digits.</td>
</tr>
<tr>
<td>cvv2</td>
<td><strong><em>numeric</em></strong> (required) <br/>Security code like it appears in the back of the card.  Generally 3 digits.</td>
</tr>
<tr>
<td>expiration_month</td>
<td><strong><em>numeric</em></strong> (required) <br/>Expiration month, like it appears in the card.</td>
</tr>
<tr>
<td>expiration_year</td>
<td><strong><em>numeric</em></strong> (required) <br/>Expiration year, like it appears in the card.</td>
</tr>
<tr>
<td>address</td>
<td><strong><em>object</em></strong> (optional)<br/>Invoice address of the card owner.</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<p>Returs the created <a href="#token-object">token object</a> or an <a href="#error-object">error response</a> if an error ocurred during the creation.</p>

<h2 id="get-a-token">Get a Token</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight plaintext">GET https://sandbox-api.openpay.mx/v1/{MERCHANT_ID}/tokens/{TOKEN_ID}
</pre>
<blockquote>
<p>Request example</p>
</blockquote>
<pre class="highlight shell">curl https://sandbox-api.openpay.mx/v1/mzdtln0bmtms6o3kck8f/tokens/k1n0mscnjwhxqia8q7cm <span class="se">\</span>
   -u sk_e568c42a6c384b7ab02cd47d2e407cab:
</pre>
<blockquote>
<p>Response example</p>
</blockquote>
<pre class="highlight json"><span class="p">{</span><span class="w">
   </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"k1n0mscnjwhxqia8q7cm"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"card"</span><span class="p">:{</span><span class="w">
      </span><span class="s2">"card_number"</span><span class="p">:</span><span class="s2">"411111XXXXXX1111"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"holder_name"</span><span class="p">:</span><span class="s2">"Juan Perez Ramirez"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"expiration_year"</span><span class="p">:</span><span class="s2">"20"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"expiration_month"</span><span class="p">:</span><span class="s2">"12"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"address"</span><span class="p">:{</span><span class="w">
         </span><span class="s2">"line1"</span><span class="p">:</span><span class="s2">"Av 5 de Febrero"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"line2"</span><span class="p">:</span><span class="s2">"Roble 207"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"line3"</span><span class="p">:</span><span class="s2">"col carrillo"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"state"</span><span class="p">:</span><span class="s2">"Queretaro"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"city"</span><span class="p">:</span><span class="s2">"QuerÃƒÆ’Ã‚Â©taro"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"postal_code"</span><span class="p">:</span><span class="s2">"76900"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"country_code"</span><span class="p">:</span><span class="s2">"MX"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"brand"</span><span class="p">:</span><span class="s2">"visa"</span><span class="w">
   </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<p>Gets the token details.  The ID is required.</p>

<p><aside class="notice">
<strong>Note:</strong> Sensible data like credit card number and security card will never be included in the response.
</aside></p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td><strong><em>string</em></strong> (required, length = 45) <br/> Token ID</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<p>Returns a <a href="#token-object">token object</a></p>

<h1 id="merchant">Merchant</h1>

<p>The <em>merchant</em> object allows you to query info related to your account using the API,</p>

<h2 id="merchant-object">Merchant Object</h2>

<blockquote>
<p>Object example:</p>
</blockquote>
<pre class="highlight json"><span class="p">{</span><span class="w"> 
   </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"m9lrykwsmljagrfb38rs"</span><span class="p">,</span><span class="w"> 
   </span><span class="s2">"creationDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2013-11-13T16:58:40-06:00"</span><span class="p">,</span><span class="w"> 
   </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Promociones en linea"</span><span class="p">,</span><span class="w"> 
   </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"contacto@enlinea.com.mx"</span><span class="p">,</span><span class="w"> 
   </span><span class="s2">"phone"</span><span class="p">:</span><span class="w"> </span><span class="s2">"(321) 222-2222"</span><span class="p">,</span><span class="w"> 
   </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"active"</span><span class="p">,</span><span class="w"> 
   </span><span class="s2">"balance"</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w"> 
   </span><span class="s2">"clabe"</span><span class="p">:</span><span class="w"> </span><span class="s2">"646180109400000542"</span><span class="w"> 
</span><span class="p">}</span><span class="w"> 
</span></pre>
<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td><strong><em>string</em></strong> <br/>Unique identifier assigned on creation.</td>
</tr>
<tr>
<td>creation_date</td>
<td><strong><em>datetime</em></strong> <br/>Transaction creation date in ISO 8601 format.</td>
</tr>
<tr>
<td>name</td>
<td><strong><em>string</em></strong> <br/>Registered merchant name.</td>
</tr>
<tr>
<td>email</td>
<td><strong><em>string</em></strong> <br/>Email account registered for the merchant.</td>
</tr>
<tr>
<td>phone</td>
<td><strong><em>string</em></strong> <br/>Phone number registered for the merchant.</td>
</tr>
<tr>
<td>status</td>
<td><strong><em>string</em></strong> <br/>Merchant account status, it can be <em>active</em> or <em>deleted</em>.  If the account is in <em>deletate</em> status no transactions are allowed.</td>
</tr>
<tr>
<td>balance</td>
<td><strong><em>numeric</em></strong> <br/>Balance in the account with two decimal placess.</td>
</tr>
<tr>
<td>clabe</td>
<td><strong><em>numeric</em></strong>   <br/>Linked CLABE account where funds can be received from any bank in Mexico using SPEI.</td>
</tr>
</tbody></table>

<h2 id="request-a-merchant-object">Request a Merchant Object</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell">GET https://sandbox-api.openpay.mx/v1/<span class="o">{</span>MERCHANT_ID<span class="o">}</span>
</pre><pre class="highlight php"><span class="cp">&lt;?</span>
<span class="c1">// =============================
// Not yet implemented.
// =============================
</span><span class="cp">?&gt;</span>
</pre><pre class="highlight java"><span class="n">openpayAPI</span><span class="o">.</span><span class="na">merchant</span><span class="o">().</span><span class="na">get</span><span class="o">();</span>

</pre><pre class="highlight csharp"><span class="c1">// =============================
// Not yet implemented.
// =============================
</span></pre><pre class="highlight javascript"><span class="nx">openpay</span><span class="p">.</span><span class="nx">merchant</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">callback</span><span class="p">);</span>
</pre>
<p>Ruby</p>
<pre class="highlight ruby"><span class="c1"># =============================</span>
<span class="c1"># Not yet implemented.</span>
<span class="c1"># =============================</span>
</pre>
<blockquote>
<p>Request example:</p>
</blockquote>
<pre class="highlight shell">curl https://sandbox-api.openpay.mx/v1/mzdtln0bmtms6o3kck8f <span class="se">\</span>
   -u sk_e568c42a6c384b7ab02cd47d2e407cab:
</pre><pre class="highlight java"><span class="n">OpenpayAPI</span> <span class="n">api</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OpenpayAPI</span><span class="o">(</span><span class="s">"https://sandbox-api.openpay.mx"</span><span class="o">,</span> <span class="s">"sk_b05586ec98454522ac7d4ccdcaec9128"</span><span class="o">,</span> <span class="s">"maonhzpqm8xp2ydssovf"</span><span class="o">);</span>
<span class="n">Merchant</span> <span class="n">merchant</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="na">merchant</span><span class="o">().</span><span class="na">get</span><span class="o">();</span>
</pre><pre class="highlight javascript"><span class="nx">openpay</span><span class="p">.</span><span class="nx">merchant</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">merchant</span><span class="p">){</span>
  <span class="c1">// ...
</span><span class="p">});</span>
</pre>
<blockquote>
<p>Response example:</p>
</blockquote>
<pre class="highlight json"><span class="p">{</span><span class="w">
   </span><span class="s2">"name"</span><span class="p">:</span><span class="s2">"Demo Openpay"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"email"</span><span class="p">:</span><span class="s2">"demo@openpay.mx"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"phone"</span><span class="p">:</span><span class="s2">"(442) 258-1039"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"status"</span><span class="p">:</span><span class="s2">"active"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"balance"</span><span class="p">:</span><span class="mf">218.73</span><span class="p">,</span><span class="w">
   </span><span class="s2">"clabe"</span><span class="p">:</span><span class="s2">"646180109400135624"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"mzdtln0bmtms6o3kck8f"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="s2">"2014-01-23T10:45:53-06:00"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<p>Returns the merchant account details.  Only the unique merchant identifier is required.</p>

<h3 id="request">Request</h3>

<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td><strong><em>string</em></strong> (required, longitude = 45) <br>unique merchant identifier.</td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<p>If the identifier is correct it will return a merchant object.</p>

<h1 id="common-objects">Common Objects</h1>

<p>Information for objects shared in request and response.</p>

<h2 id="transaction-object">Transaction Object</h2>

<blockquote>
<p>Object example:</p>
</blockquote>
<pre class="highlight json"><span class="p">{</span><span class="w">
   </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"trehwr2zarltvae56vxl"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"authorization"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
   </span><span class="s2">"transaction_type"</span><span class="p">:</span><span class="s2">"payout"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"operation_type"</span><span class="p">:</span><span class="s2">"out"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"currency"</span><span class="p">:</span><span class="s2">"MXN"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"method"</span><span class="p">:</span><span class="s2">"bank"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="s2">"2013-11-14T18:29:35-06:00"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"order_id"</span><span class="p">:</span><span class="s2">"000001"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"status"</span><span class="p">:</span><span class="s2">"in_progress"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"amount"</span><span class="p">:</span><span class="mi">500</span><span class="p">,</span><span class="w">
   </span><span class="s2">"description"</span><span class="p">:</span><span class="s2">"Winning payments"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"error_message"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
   </span><span class="s2">"customer_id"</span><span class="p">:</span><span class="s2">"afk4csrazjp1udezj1po"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"bank_account"</span><span class="p">:{</span><span class="w">
      </span><span class="s2">"alias"</span><span class="p">:</span><span class="err">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"bank_name"</span><span class="p">:</span><span class="s2">"BANCOMER"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"creation_date"</span><span class="p">:</span><span class="s2">"2013-11-14T18:29:34-06:00"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"clabe"</span><span class="p">:</span><span class="s2">"012298026516924616"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"holder_name"</span><span class="p">:</span><span class="s2">"Juan Tapia Trejo"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"bank_code"</span><span class="p">:</span><span class="s2">"012"</span><span class="w">
   </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td><em><strong>string</strong></em> <br/> Unique identifier assigned by Openpay at the moment of creation.</td>
</tr>
<tr>
<td>authorization</td>
<td><strong><em>string</em></strong> <br/>Authorization number created by the processor entity.</td>
</tr>
<tr>
<td>transaction_type</td>
<td><strong><em>string</em></strong> <br/>Transaction type: fee, charge, payout, transfer.</td>
</tr>
<tr>
<td>operation_type</td>
<td><strong><em>string</em></strong> <br/>Operation type in the account: in, out.</td>
</tr>
<tr>
<td>method</td>
<td><strong><em>string</em></strong> <br/>Transaction method type: card, bank o customer.</td>
</tr>
<tr>
<td>creation_date</td>
<td><strong><em>datetime</em></strong>  <br/>Transaction creation date in ISO 8601 format.</td>
</tr>
<tr>
<td>order_id</td>
<td><strong><em>string</em></strong> <br/>Unique transaction and reference number.</td>
</tr>
<tr>
<td>status</td>
<td><strong><em>string</em></strong> <br/>Current transaction status.  Possible values: completed, in_progress, failed.</td>
</tr>
<tr>
<td>amount</td>
<td><strong><em>numeric</em></strong> <br/>Transaction full amount, including two decimal places.</td>
</tr>
<tr>
<td>description</td>
<td><strong><em>string</em></strong> <br/>Transaction description.</td>
</tr>
<tr>
<td>error_message</td>
<td><strong><em>string</em></strong> <br/>If the transaction is in <em>failed</em> status, this field will include the error message.</td>
</tr>
<tr>
<td>customer_id</td>
<td><strong><em>string</em></strong> <br/>Unique identifier for the customer who this transaction belongs.  If the value is null the transaction belongs to Merchant account.</td>
</tr>
<tr>
<td>currency</td>
<td><strong><em>string</em></strong> <br/>Currency used in the operation by default is MXN (Mexican pesos).</td>
</tr>
<tr>
<td>bank_account</td>
<td><strong><em>object</em></strong> <br/>Bank account data used for the transaction.  See the <em>BankAccount</em> object.</td>
</tr>
<tr>
<td>card</td>
<td><strong><em>object</em></strong> <br/>Credit card data used in the transaction.  See the <em>Card</em> object.</td>
</tr>
<tr>
<td>card_points</td>
<td><strong><em>object</em></strong> <br/>Contains information about the reward points used for payment, if they were used. See the <a href="#cardpoints-object">CardPoints object</a></td>
</tr>
</tbody></table>

<h2 id="address-object">Address Object</h2>

<blockquote>
<p>Object example:</p>
</blockquote>
<pre class="highlight json"><span class="p">{</span><span class="w">
   </span><span class="s2">"line1"</span><span class="p">:</span><span class="s2">"Av 5 de Febrero"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"line2"</span><span class="p">:</span><span class="s2">"Roble 207"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"line3"</span><span class="p">:</span><span class="s2">"col carrillo"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"state"</span><span class="p">:</span><span class="s2">"Queretaro"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"city"</span><span class="p">:</span><span class="s2">"QuerÃƒÂ©taro"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"postal_code"</span><span class="p">:</span><span class="s2">"76900"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"country_code"</span><span class="p">:</span><span class="s2">"MX"</span><span class="w"> 
</span><span class="p">}</span><span class="w">
</span></pre>
<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>line1</td>
<td><strong><em>string</em></strong> (required) <br/>The first line is the card owner address. It&rsquo;s commonly used to indicate street address and number.</td>
</tr>
<tr>
<td>line2</td>
<td><strong><em>string</em></strong> <br/>Second addres line, commonly use to indicate interior number, suite number  or county.</td>
</tr>
<tr>
<td>line3</td>
<td><strong><em>string</em></strong> <br/>Third address line, commonly use to to indicate the neighborhood.</td>
</tr>
<tr>
<td>postal_code</td>
<td><strong><em>string</em></strong> (required) <br/>Zip code</td>
</tr>
<tr>
<td>state</td>
<td><strong><em>string</em></strong> (required) <br/>State</td>
</tr>
<tr>
<td>city</td>
<td><strong><em>string</em></strong> (required) <br/>City</td>
</tr>
<tr>
<td>country_code</td>
<td><strong><em>string</em></strong> (required) <br/>Country code, in the two character format: ISO_3166-1.</td>
</tr>
</tbody></table>

<h2 id="store-object">Store object</h2>

<blockquote>
<p>Object example:</p>
</blockquote>
<pre class="highlight json"><span class="p">{</span><span class="w">
   </span><span class="s2">"reference"</span><span class="p">:</span><span class="s2">"OPENPAY02DQ35YOY7"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"barcode_url"</span><span class="p">:</span><span class="s2">"https://sandbox-api.openpay.mx/barcode/OPENPAY02DQ35YOY7?width=1&amp;height=45&amp;text=false"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>reference</td>
<td><strong><em>string</em></strong> <br/>Payment reference to go stores and make deposits to Openpay account</td>
</tr>
<tr>
<td>barcode_url</td>
<td><strong><em>string</em></strong> <br/>It is the url that generates the bar code of reference.</td>
</tr>
</tbody></table>

<h2 id="cardpoints-object">Cardpoints Object</h2>

<blockquote>
<p>Object example:</p>
</blockquote>
<pre class="highlight json"><span class="p">{</span><span class="w">
    </span><span class="s2">"used"</span><span class="p">:</span><span class="w"> </span><span class="mi">134</span><span class="p">,</span><span class="w">
    </span><span class="s2">"remaining"</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="p">,</span><span class="w">
    </span><span class="s2">"caption"</span><span class="p">:</span><span class="w"> </span><span class="s2">"TRANSACCION APROBADA. ME OBLIGO EN LOS TERMINOS Y CONDICIONES DEL PROGRAMA RECOMPENSAS SANTANDER. PARA CUALQUIER DUDA O ACLARACION LLAME AL 01800 RECOMPE (73-266-73)."</span><span class="p">,</span><span class="w">
    </span><span class="s2">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>
<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>used</td>
<td><strong><em>numeric</em></strong> <br/> Amount of points used in the payment.</td>
</tr>
<tr>
<td>remaining</td>
<td><strong><em>numeric</em></strong> <br/> Amount of points remaining in the card after the payment.</td>
</tr>
<tr>
<td>amount</td>
<td><strong><em>numeric</em></strong> <br/>Transaction amount paid using points.</td>
</tr>
<tr>
<td>caption</td>
<td><strong><em>string</em></strong> (opcional) <br/> A message to be shown to the customer in their ticket or receipt.</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
        <div id="lang-selector">
          
            
              
                <a href="#" data-language-name="shell">cURL</a>
              
            
              
                <a href="#" data-language-name="php">PHP</a>
              
            
              
                <a href="#" data-language-name="java">JAVA</a>
              
            
              
                <a href="#" data-language-name="csharp">C#</a>
              
            
              
                <a href="#" data-language-name="javascript">Node.js</a>
              
            
              
                <a href="#" data-language-name="ruby">Ruby</a>
              
            
          
        </div>
      </div>
    </div>
    <!-- ClickDesk Live Chat Service for websites -->
  <script type='text/javascript'>
  var _glc =_glc || []; _glc.push('all_ag9zfmNsaWNrZGVza2NoYXRyDgsSBXVzZXJzGKiezXcM');
  var glcpath = (('https:' == document.location.protocol) ? 'https://my.clickdesk.com/clickdesk-ui/browser/' : 
  'http://my.clickdesk.com/clickdesk-ui/browser/');
  var glcp = (('https:' == document.location.protocol) ? 'https://' : 'http://');
  var glcspt = document.createElement('script'); glcspt.type = 'text/javascript'; 
  glcspt.async = true; glcspt.src = glcpath + 'livechat-new.js';
  var s = document.getElementsByTagName('script')[0];s.parentNode.insertBefore(glcspt, s);
  </script>
  <!-- End of ClickDesk -->
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-46051555-1', 'openpay.mx');
  ga('send', 'pageview');

</script>
  </body>
</html>